<!DOCTYPE html>
<html lang="en">

<head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

            <meta name="google-site-verification" content="XynqZtldWNBbmsynVQZremIxaaO8Wgs6AGR8UZ7KIkM">

        <title>atodorov.org - Articles by Alexander Todorov</title>

        <link href="http://feeds.feedburner.com/atodorov" type="application/atom+xml" rel="alternate" title="atodorov.org Full Atom Feed" />
        <!-- Bootstrap Core CSS -->
        <link href="http://atodorov.org/theme/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom CSS -->
        <link href="http://atodorov.org/theme/css/clean-blog.min.css" rel="stylesheet">

        <!-- Code highlight color scheme -->
            <link href="http://atodorov.org/theme/css/code_blocks/github.css" rel="stylesheet">

            <!-- CSS specified by the user -->
            <link href="http://atodorov.org/override.css" rel="stylesheet">

        <!-- Custom Fonts -->
        <link href="http://atodorov.org/theme/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

                    <meta property="fb:admins" content="1616937247" >
                <meta property="og:locale" content="en_US">
		<meta property="og:site_name" content="atodorov.org">

    <meta property="og:title" content="atodorov.org - Articles by Alexander Todorov">
    <meta property="og:type" content="profile">
    <meta property="profile:first_name" content="Alexander">
    <meta property="profile:last_name" content="Todorov">
    <meta property="profile:username" content="alexander-todorov">
            <meta name="twitter:card" content="summary_large_image">
            <meta name="twitter:site" content="@atodorov_">
            <meta name="twitter:title" content="atodorov.org">
            <meta name="twitter:description" content="you can logoff, but you can never leave">
                <meta name="twitter:image" content="http://atodorov.org//images/header_02.jpg">
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://atodorov.org/">atodorov.org</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                        <li><a href="http://mrsenko.com/pylint-workshop/">Pylint Workshop</a></li>

                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
        <header class="intro-header" style="background-image: url('/images/header_02.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Articles by Alexander Todorov</h1>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/03/19/bug-in-nokia-software-shows-wrong-caller-id/" rel="bookmark" title="Permalink to Bug in Nokia software shows wrong caller ID">
                <h2 class="post-title">
                    Bug in Nokia software shows wrong caller ID
                </h2>
            </a>
                <p>During the past month one of my cell phones,
<a target="_blank" href="http://www.amazon.com/s/?_encoding=UTF8&camp=1789&creative=390957&field-keywords=Nokia&linkCode=ur2&tag=atodorovorg-20&url=search-alias%3Daps">Nokia</a><img src="https://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=ur2&o=1" width="1" height="1" border="0"  style="border:none !important; margin:0px !important;" />
<a href="http://www.amazon.com/gp/product/B001SEAOC6/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=B001SEAOC6&linkCode=as2&tag=atodorovorg-20">5800 XpressMusic</a><img src="http://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=B001SEAOC6" width="1" height="1" border="0"  style="border:none !important; margin:0px !important;" />
, was not showing the caller name when a friend was calling.
The number in the contacts list was correct but the name wasn't showing,
nor the custom assigned ringing tone. It turned out to be a bug!</p>
<p>The story behind this is that accidentally the same number was saved again
in the contacts list, but without a name assigned to it.
The software was matching the later one, so no custom ringing tone,
no name shown. Removing the duplicate entry fixed the issue. Software version of this
phone is</p>
<div class="highlight"><pre>v 21.0.025
RM-356
02-04-09
</pre></div>


<p>I wondered what will happen with multiple duplicates and if this was fixed in a later
software version so I tested with another phone,
<a href="http://www.amazon.com/gp/product/B002RXEI6U/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=B002RXEI6U&linkCode=as2&tag=atodorovorg-20">Nokia 6303</a><img src="http://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=B002RXEI6U" width="1" height="1" border="0"  style="border:none !important; margin:0px !important;" />.
Software version is</p>
<div class="highlight"><pre>V 07.10
25-03-10
RM-638
</pre></div>


<ul>
<li>Step 0 - add the number to the contacts list, with name <code>Buddy 1</code></li>
<li>Step 1 - add the same number to the contacts, with <strong>empty name</strong>.
<strong>Result</strong>: You get a warning this number is already present for <code>Buddy 1</code>!
When receiving a call, <code>Buddy 1</code> is displayed.</li>
<li>Step 2 - edit the empty name contact and change the name to <code>Buddy 2</code>.
<strong>Result</strong>: when receiving a call <code>Buddy 2</code> is displayed.</li>
<li>Step 3 - add the same number again, with name <code>Buddy 0</code>. This is the latest entry
but it is sorted before the previous two (this is important).
<strong>Result</strong>: You get a warning that this number is already present for <code>Buddy 1</code> and <code>Buddy 2</code>.
When receiving a call <code>Buddy 0</code> is displayed.</li>
</ul>
<p><strong>Summary</strong>: so it looks like Nokia fixed the issue with empty names, by simply ignoring them
but when multiple duplicate contacts are available it displays the name of the last entered in the
contact list, independent of name sort order.</p>
<p><del>
Later today or tomorrow I will test on 
<a href="http://www.amazon.com/gp/product/B005MOW7S2/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=B005MOW7S2&linkCode=as2&tag=atodorovorg-20">Nokia 700</a><img src="http://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=B005MOW7S2" width="1" height="1" border="0"  style="border:none !important; margin:0px !important;" />
which runs Symbian OS and update this post with more results.
</del></p>
<p><strong>Updated on 2013-03-19 23:50</strong></p>
<p>Finally managed to test on
<a href="http://www.amazon.com/gp/product/B005MOW7S2/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=B005MOW7S2&linkCode=as2&tag=atodorovorg-20">Nokia 700</a><img src="http://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=B005MOW7S2" width="1" height="1" border="0"  style="border:none !important; margin:0px !important;" />.
Software version is:</p>
<div class="highlight"><pre>Release
Nokia Belle Feature pack 1
Software version
112.010.1404
Software version date
2012-03-30
Type
RM-670
</pre></div>


<p><strong>Result</strong>: If a duplicate contact entry is present it doesn't matter if the name is empty or not.
Both times no name was displayed when receiving a call. Looks like Nokia is not paying attention to
regressions at all.</p>
<h2>Android and iPhone</h2>
<p>I don't own any
<a target="_blank" href="http://www.amazon.com/s/?_encoding=UTF8&camp=1789&creative=390957&field-keywords=Android&linkCode=ur2&tag=atodorovorg-20&url=search-alias%3Delectronics">Android</a><img src="https://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=ur2&o=1" width="1" height="1" border="0"  style="border:none !important; margin:0px !important;" />
or
<a target="_blank" href="http://www.amazon.com/s/?_encoding=UTF8&camp=1789&creative=390957&field-keywords=iPhone&linkCode=ur2&rh=n%3A172282%2Ck%3AiPhone&tag=atodorovorg-20&url=search-alias%3Delectronics">iPhone</a><img src="https://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=ur2&o=1" width="1" height="1" border="0"  style="border:none !important; margin:0px !important;" />
devices so I'm not able to test on them. If you have one, please let me know if this bug is still present
and how does the software behave when multiple contacts share the same number or have empty names! Thanks!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Tue 19 March 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/03/19/bug-in-nokia-software-shows-wrong-caller-id/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/03/14/django-social-auth-tip-reminder-of-login-provider/" rel="bookmark" title="Permalink to django-social-auth tip: Reminder of Login Provider">
                <h2 class="post-title">
                    django-social-auth tip: Reminder of Login Provider
                </h2>
            </a>
                <p>Every now and then users forget their passwords. This is why I prefer using
OAuth and social network accounts like GitHub or Twitter. But what do you do
when somebody forgets which OAuth provider they used to login to your site?
Your website needs a reminder. This is how to implement one if using
django-social-auth.</p>
<h2>Back-end</h2>
<p>Create a similar view on your Django back-end</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">ajax_social_auth_provider_reminder</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remind the user which social auth provider they used to login.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s">&quot;Not a POST&quot;</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="s">&#39;text/plain&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">403</span><span class="p">)</span>

    <span class="n">email</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;email&#39;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">email</span> <span class="ow">or</span> <span class="p">(</span><span class="n">email</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;@&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s">&quot;Invalid address!&quot;</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="s">&#39;text/plain&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="n">email</span><span class="p">,</span> <span class="n">is_active</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s">&#39;pk&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s">&quot;No user with address &#39;</span><span class="si">%s</span><span class="s">&#39; found!&quot;</span> <span class="o">%</span> <span class="n">email</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="s">&#39;text/plain&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>

    <span class="n">providers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">sa</span> <span class="ow">in</span> <span class="n">UserSocialAuth</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s">&#39;provider&#39;</span><span class="p">):</span>
        <span class="n">providers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">title</span><span class="p">())</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">providers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">send_templated_mail</span><span class="p">(</span>
            <span class="n">template_name</span><span class="o">=</span><span class="s">&#39;social_provider_reminder&#39;</span><span class="p">,</span>
            <span class="n">from_email</span><span class="o">=</span><span class="s">&#39;Difio &lt;reminder@dif.io&gt;&#39;</span><span class="p">,</span>
            <span class="n">recipient_list</span><span class="o">=</span><span class="p">[</span><span class="n">email</span><span class="p">],</span>
            <span class="n">context</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;providers&#39;</span> <span class="p">:</span> <span class="n">providers</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s">&quot;Reminder sent to &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span> <span class="n">email</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="s">&#39;text/plain&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s">&quot;User found but no social providers found!&quot;</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="s">&#39;text/plain&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</pre></div>


<p>This example assumes it is called via POST request which contains the email address.
All responses are handled at the front-end via JavaScript. If a user with the specified
email address exists this address will receive a reminder listing all social auth providers
associated with the user account.</p>
<h2>Front-end</h2>
<p>On the browser side I like to use <a href="http://dojotoolkit.org">Dojo</a>.
Here is a simple script which connects to a form and POSTs the data
back to the server.</p>
<div class="highlight"><pre><span class="nx">require</span><span class="p">([</span><span class="s2">&quot;dojo&quot;</span><span class="p">]);</span>
<span class="nx">require</span><span class="p">([</span><span class="s2">&quot;dijit&quot;</span><span class="p">]);</span>

<span class="kd">function</span> <span class="nx">sendReminderForm</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">form</span> <span class="o">=</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">byId</span><span class="p">(</span><span class="s2">&quot;reminderForm&quot;</span><span class="p">);</span>

    <span class="nx">dojo</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">form</span><span class="p">,</span> <span class="s2">&quot;onsubmit&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
        <span class="nx">dojo</span><span class="p">.</span><span class="nx">stopEvent</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
        <span class="nx">dijit</span><span class="p">.</span><span class="nx">byId</span><span class="p">(</span><span class="s2">&quot;dlgForgot&quot;</span><span class="p">).</span><span class="nx">hide</span><span class="p">();</span>
        <span class="kd">var</span> <span class="nx">xhrArgs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">form</span><span class="o">:</span> <span class="nx">form</span><span class="p">,</span>
            <span class="nx">handleAs</span><span class="o">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
            <span class="nx">load</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span><span class="nx">alert</span><span class="p">(</span><span class="nx">data</span><span class="p">);},</span>
            <span class="nx">error</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">ioargs</span><span class="p">){</span><span class="nx">alert</span><span class="p">(</span><span class="nx">ioargs</span><span class="p">.</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);}</span>
        <span class="p">};</span>
        <span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">xhrPost</span><span class="p">(</span><span class="nx">xhrArgs</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">ready</span><span class="p">(</span><span class="nx">sendReminderForm</span><span class="p">);</span>
</pre></div>


<p>You can try this out at <a href="http://www.dif.io">Difio</a> and let me know how it works for you!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Thu 14 March 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/03/14/django-social-auth-tip-reminder-of-login-provider/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/03/07/python-twitter-django-social-auth-hello-new-user/" rel="bookmark" title="Permalink to Python Twitter + django-social-auth == Hello New User">
                <h2 class="post-title">
                    Python Twitter + django-social-auth == Hello New User
                </h2>
            </a>
                <p>I have been experimenting with the <a href="https://pypi.python.org/pypi/twitter">twitter</a>
module for Python and decided to combine it with 
<a href="https://github.com/omab/django-social-auth">django-social-auth</a> to welcome new
users who join <a href="http://www.dif.io">Difio</a>. In this post I will show you how to
tweet on behalf of the user when they join your site and send them a welcome email.</p>
<h2>Configuration</h2>
<p>In django-social-auth the authentication workflow is handled by an operations
pipeline where custom functions can be added or default items can be removed to
provide custom behavior. This is how our pipeline looks:</p>
<div class="highlight"><span class="filename">settings.py</span><pre><span class="n">SOCIAL_AUTH_PIPELINE</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s">&#39;social_auth.backends.pipeline.social.social_auth_user&#39;</span><span class="p">,</span>
    <span class="c">#&#39;social_auth.backends.pipeline.associate.associate_by_email&#39;,</span>
    <span class="s">&#39;social_auth.backends.pipeline.user.get_username&#39;</span><span class="p">,</span>
    <span class="s">&#39;social_auth.backends.pipeline.user.create_user&#39;</span><span class="p">,</span>
    <span class="s">&#39;social_auth.backends.pipeline.social.associate_user&#39;</span><span class="p">,</span>
    <span class="s">&#39;social_auth.backends.pipeline.social.load_extra_data&#39;</span><span class="p">,</span>
    <span class="s">&#39;social_auth.backends.pipeline.user.update_user_details&#39;</span><span class="p">,</span>
    <span class="s">&#39;myproject.tasks.welcome_new_user&#39;</span>
<span class="p">)</span>
</pre></div>


<p>This is the default plus an additional method at the end to welcome new users.</p>
<p>You also have to create and configure a Twitter application so that users
can login with Twitter OAuth to your site.
<a href="http://django-social-auth.readthedocs.org/en/latest/backends/index.html">RTFM</a>
for more information on how to do this.</p>
<h2>Custom pipeline actions</h2>
<p>This is how the custom pipeline action should look:</p>
<div class="highlight"><span class="filename">myproject/tasks.py</span><pre><span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">parse_qs</span>

<span class="k">def</span> <span class="nf">welcome_new_user</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">social_user</span><span class="p">,</span> <span class="n">is_new</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">new_association</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Part of SOCIAL_AUTH_PIPELINE. Works with django-social-auth==0.7.21 or newer</span>
<span class="sd">        @backend - social_auth.backends.twitter.TwitterBackend (or other) object</span>
<span class="sd">        @user - User (if is_new) or django.utils.functional.SimpleLazyObject (if new_association)</span>
<span class="sd">        @social_user - UserSocialAuth object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_new</span><span class="p">:</span>
        <span class="n">send_welcome_email</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">first_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">backend</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;twitter&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_new</span> <span class="ow">or</span> <span class="n">new_association</span><span class="p">:</span>
            <span class="n">access_token</span> <span class="o">=</span> <span class="n">social_user</span><span class="o">.</span><span class="n">extra_data</span><span class="p">[</span><span class="s">&#39;access_token&#39;</span><span class="p">]</span>
            <span class="n">parsed_tokens</span> <span class="o">=</span> <span class="n">parse_qs</span><span class="p">(</span><span class="n">access_token</span><span class="p">)</span>
            <span class="n">oauth_token</span> <span class="o">=</span> <span class="n">parsed_tokens</span><span class="p">[</span><span class="s">&#39;oauth_token&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">oauth_secret</span> <span class="o">=</span> <span class="n">parsed_tokens</span><span class="p">[</span><span class="s">&#39;oauth_token_secret&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">tweet_on_join</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">oauth_token</span><span class="p">,</span> <span class="n">oauth_secret</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">None</span>
</pre></div>


<p>This code works with django-social-auth==0.7.21 or newer. In older versions the
<code>new_association</code> parameter is missing as 
<a href="https://groups.google.com/forum/?fromgroups=#!topic/django-social-auth/Nxf-0iRD27Y">I discovered</a>.
If you use an older version you won't be able to distinguish between newly created
accounts and ones which have associated another OAuth backend. You are warned!</p>
<h2>Tweet &amp; email</h2>
<p>Sending the welcome email is out of the scope of this post. I am using
<a href="https://github.com/bradwhittington/django-templated-email">django-templated-email</a>
to define how emails look and sending them via Amazon SES. See 
<a href="/blog/2013/02/28/email-logging-django-redhat-openshift-amazon-ses/">Email Logging for Django on RedHat OpenShift With Amazon SES</a>
for more information on how to configure emailing with SES.</p>
<p>Here is how the Twitter code looks:</p>
<div class="highlight"><span class="filename">myproject/tasks.py</span><pre><span class="kn">import</span> <span class="nn">twitter</span>
<span class="kn">from</span> <span class="nn">celery.task</span> <span class="kn">import</span> <span class="n">task</span>
<span class="kn">from</span> <span class="nn">settings</span> <span class="kn">import</span> <span class="n">TWITTER_CONSUMER_KEY</span><span class="p">,</span> <span class="n">TWITTER_CONSUMER_SECRET</span>

<span class="nd">@task</span>
<span class="k">def</span> <span class="nf">tweet_on_join</span><span class="p">(</span><span class="n">oauth_token</span><span class="p">,</span> <span class="n">oauth_secret</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tweet when the user is logged in for the first time or</span>
<span class="sd">        when new Twitter account is associated.</span>

<span class="sd">        @oauth_token - string</span>
<span class="sd">        @oauth_secret - string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">twitter</span><span class="o">.</span><span class="n">Twitter</span><span class="p">(</span>
            <span class="n">auth</span><span class="o">=</span><span class="n">twitter</span><span class="o">.</span><span class="n">OAuth</span><span class="p">(</span>
                <span class="n">oauth_token</span><span class="p">,</span> <span class="n">oauth_secret</span><span class="p">,</span>
                <span class="n">TWITTER_CONSUMER_KEY</span><span class="p">,</span> <span class="n">TWITTER_CONSUMER_SECRET</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">statuses</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s">&#39;Started following open source changes at http://www.dif.io!&#39;</span><span class="p">)</span>
</pre></div>


<p>This will post a new tweet on behalf of the user, telling everyone they joined
your website!</p>
<p><strong>NOTE:</strong>
<code>tweet_on_join</code> and <code>send_welcome_email</code> are Celery tasks, not ordinary Python
functions. This has the advantage of being able to execute these actions async
and not slow down the user interface.</p>
<p>Are you doing something special when a user joins your website? Please share
your comments below. Thanks!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Thu 07 March 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/03/07/python-twitter-django-social-auth-hello-new-user/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/03/06/tip-delete-user-profiles-django-social-auth/" rel="bookmark" title="Permalink to Tip: Delete User Profiles with django-social-auth">
                <h2 class="post-title">
                    Tip: Delete User Profiles with django-social-auth
                </h2>
            </a>
                <p>Common functionality for websites is the 'DELETE ACCOUNT' or 'DISABLE ACCOUNT'
button. This is how to implement it if using 
<a href="https://github.com/omab/django-social-auth">django-social-auth</a>.</p>
<div class="highlight"><span class="filename">views.py</span><pre><span class="n">delete_objects_for_user</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span> <span class="c"># optional</span>
<span class="n">UserSocialAuth</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
<span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">is_active</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">&#39;django.contrib.auth.views.logout&#39;</span><span class="p">))</span>
</pre></div>


<p>This snippet does the following:</p>
<ul>
<li>Delete (or archive) all objects for the current user;</li>
<li>Delete the social auth profile(s) because there is no way to disable them.
DSA will create new objects if the user logs in again;</li>
<li>Disable the <code>User</code> object. You could also delete it but mind foreign keys;</li>
<li>Clear the email for the <code>User</code> object - if a new user is created after deletion
we don't want duplicated email addresses in the database;</li>
<li>Finally redirect the user to the logout view.</li>
</ul>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Wed 06 March 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/03/06/tip-delete-user-profiles-django-social-auth/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/02/28/email-logging-django-redhat-openshift-amazon-ses/" rel="bookmark" title="Permalink to Email Logging for Django on RedHat OpenShift with Amazon SES">
                <h2 class="post-title">
                    Email Logging for Django on RedHat OpenShift with Amazon SES
                </h2>
            </a>
                <p>Sending email in the cloud can be tricky. IPs of cloud providers are blacklisted
because of frequent abuse. For that reason I use
<a href="http://aws.amazon.com/ses/">Amazon SES</a> as my email backend. Here is how to
configure <a href="https://www.djangoproject.com/">Django</a> to send emails to site admins
when something goes wrong.</p>
<div class="highlight"><span class="filename">settings.py</span><pre><span class="c"># Valid addresses only.</span>
<span class="n">ADMINS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="s">&#39;Alexander Todorov&#39;</span><span class="p">,</span> <span class="s">&#39;atodorov@example.com&#39;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">LOGGING</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;version&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&#39;disable_existing_loggers&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
    <span class="s">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;mail_admins&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&#39;level&#39;</span><span class="p">:</span> <span class="s">&#39;ERROR&#39;</span><span class="p">,</span>
            <span class="s">&#39;class&#39;</span><span class="p">:</span> <span class="s">&#39;django.utils.log.AdminEmailHandler&#39;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s">&#39;loggers&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;django.request&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;mail_admins&#39;</span><span class="p">],</span>
            <span class="s">&#39;level&#39;</span><span class="p">:</span> <span class="s">&#39;ERROR&#39;</span><span class="p">,</span>
            <span class="s">&#39;propagate&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
<span class="p">}</span>
 
<span class="c"># Used as the From: address when reporting errors to admins</span>
<span class="c"># Needs to be verified in Amazon SES as a valid sender</span>
<span class="n">SERVER_EMAIL</span> <span class="o">=</span> <span class="s">&#39;django@example.com&#39;</span>

<span class="c"># Amazon Simple Email Service settings</span>
<span class="n">AWS_SES_ACCESS_KEY_ID</span> <span class="o">=</span> <span class="s">&#39;xxxxxxxxxxxx&#39;</span>
<span class="n">AWS_SES_SECRET_ACCESS_KEY</span> <span class="o">=</span> <span class="s">&#39;xxxxxxxx&#39;</span>
<span class="n">EMAIL_BACKEND</span> <span class="o">=</span> <span class="s">&#39;django_ses.SESBackend&#39;</span>
</pre></div>


<p>You also need the <a href="https://github.com/hmarr/django-ses">django-ses</a>
dependency.</p>
<p>See <a href="http://docs.djangoproject.com/en/dev/topics/logging">http://docs.djangoproject.com/en/dev/topics/logging</a> for
more details on how to customize your logging configuration.</p>
<p>I am using this configuration successfully at RedHat's OpenShift PaaS environment.
Other users have
<a href="https://openshift.redhat.com/community/forums/express/missing-email-on-500-ise-w-django">reported</a>
it works for them too. Should work with any other PaaS provider.</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Thu 28 February 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/02/28/email-logging-django-redhat-openshift-amazon-ses/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/02/26/performance-test-amazon-ebs-vs-instance-storage-pt1/" rel="bookmark" title="Permalink to Performance Test: Amazon EBS vs. Instance Storage, Pt.1">
                <h2 class="post-title">
                    Performance Test: Amazon EBS vs. Instance Storage, Pt.1
                </h2>
            </a>
                <p>I'm exploring the possibility to speed-up my cloud database so I've run some
basic tests against storage options available to Amazon EC2 instances.
The instance was <a href="http://aws.amazon.com/ec2/instance-types/">m1.large</a>
with High I/O performance and two additional disks with the same size:</p>
<ul>
<li>/dev/xvdb - type EBS</li>
<li>/dev/xvdc - type instance storage</li>
</ul>
<p>Both are Xen para-virtual disks. The difference is that EBS is persistent
across reboots while instance storage is ephemeral.</p>
<h2>hdparm</h2>
<p>For a quick test I used <code>hdparm</code>. The manual says:</p>
<div class="highlight"><pre>-T  Perform timings of cache reads for benchmark and comparison purposes.
    This displays the speed of reading directly from the Linux buffer cache
    without disk access. This measurement is essentially an indication of
    the throughput of the processor, cache, and memory of the system under test.

-t  Perform timings of device reads for benchmark and comparison purposes.
    This displays the speed of reading through the buffer cache to the disk
    without any prior caching of data. This measurement is an indication of how
    fast the drive can sustain sequential data reads under Linux, without any
    filesystem overhead.
</pre></div>


<p>The results of 3 runs of hdparm are shown below:</p>
<div class="highlight"><pre># hdparm -tT /dev/xvdb /dev/xvdc

/dev/xvdb:
 Timing cached reads:   11984 MB in  1.98 seconds = 6038.36 MB/sec
 Timing buffered disk reads:  158 MB in  3.01 seconds =  52.52 MB/sec

/dev/xvdc:
 Timing cached reads:   11988 MB in  1.98 seconds = 6040.01 MB/sec
 Timing buffered disk reads:  1810 MB in  3.00 seconds = 603.12 MB/sec


# hdparm -tT /dev/xvdb /dev/xvdc

/dev/xvdb:
 Timing cached reads:   11892 MB in  1.98 seconds = 5991.51 MB/sec
 Timing buffered disk reads:  172 MB in  3.00 seconds =  57.33 MB/sec

/dev/xvdc:
 Timing cached reads:   12056 MB in  1.98 seconds = 6075.29 MB/sec
 Timing buffered disk reads:  1972 MB in  3.00 seconds = 657.11 MB/sec


# hdparm -tT /dev/xvdb /dev/xvdc

/dev/xvdb:
 Timing cached reads:   11994 MB in  1.98 seconds = 6042.39 MB/sec
 Timing buffered disk reads:  254 MB in  3.02 seconds =  84.14 MB/sec

/dev/xvdc:
 Timing cached reads:   11890 MB in  1.99 seconds = 5989.70 MB/sec
 Timing buffered disk reads:  1962 MB in  3.00 seconds = 653.65 MB/sec
</pre></div>


<p><strong>Result:</strong>
Sequential reads from instance storage are 10x faster compared to EBS on average.</p>
<h2>IOzone</h2>
<p>I'm running MySQL and sequential data reads are probably over idealistic scenario.
So I found another benchmark suite, called <a href="http://iozone.org">IOzone</a>.
I used the 3-414 version built from the official SRPM.</p>
<p>IOzone performs multiple tests. I'm interested in read/re-read, random-read/write,
read-backwards and stride-read.</p>
<p>For this round of testing I've tested with ext4 filesystem with and without journal
on both types of disks. I also experimented running Iozone inside a ramfs mounted
directory. However I didn't have the time to run the test suite multiple times.</p>
<p>Then I used
<a href="http://code.google.com/p/iozone-results-comparator/">iozone-results-comparator</a> to
visualize the results. (I had to do a minor fix to the code to run inside virtualenv
and install all missing dependencies).</p>
<p>Raw IOzone output, data visualization and the modified tools are available in the
<a href="http://s3.amazonaws.com/atodorov/blog/aws_disk_benchmark_w_iozone.tar.bz2">aws_disk_benchmark_w_iozone.tar.bz2</a>
file (size 51M).</p>
<p><strong>Graphics</strong></p>
<p>EBS without journal(Baseline) vs. Instance Storage without journal(Set1)
<img alt="EBS vs. Instance Storage" src="/images/aws_iozone/ebs_woj_vs_is_woj.png" title="EBS vs. Instance Storage" /></p>
<p>Instance Storage without journal(Baseline) vs. Ramfs(Set1)
<img alt="IS vs. Ramfs" src="/images/aws_iozone/is_woj_vs_ramfs.png" title="IS vs. Ramfs" /></p>
<p><strong>Results</strong></p>
<ul>
<li>ext4 journal has no effect on reads, causes slow down when writing to disk. This
is expected;</li>
<li>Instance storage is faster compared to EBS but not much.
If I understand the results correctly, read performance is similar in some cases;</li>
<li>Ramfs is definitely the fastest but read performance compared to instance storage
is not two-fold (or more) as I expected;</li>
</ul>
<p><strong>Conclusion</strong></p>
<p>Instance storage appears to be faster (and this is expected) but I'm still not sure if
my application will gain any speed improvement or how much if migrated to read from
instance storage (or ramfs) instead of EBS. I will be performing more real-world
test next time, by comparing execution time for some of my largest SQL queries.</p>
<p>If you have other ideas how to adequately measure I/O performance in the AWS cloud,
please use the comments below.</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Tue 26 February 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/02/26/performance-test-amazon-ebs-vs-instance-storage-pt1/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/02/21/tip-generating-directory-listings-with-wget/" rel="bookmark" title="Permalink to Tip: Generating Directory Listings with wget">
                <h2 class="post-title">
                    Tip: Generating Directory Listings with wget
                </h2>
            </a>
                <p>Today I was looking to generate a list of all files under remote site directory,
including sub directories. I found no built-in options for this in
<a href="https://www.gnu.org/software/wget/">wget</a>. This is how I did it:</p>
<div class="highlight"><pre>wget http://example.com/dir/ --spider -r -np 2&gt;&amp;1 | grep http:// | tr -s &#39; &#39; | cut -f3 -d&#39; &#39;
</pre></div>


<p>I managed to retrieve 12212 entries from the URL I was exploring.</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Thu 21 February 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/02/21/tip-generating-directory-listings-with-wget/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/02/20/how-large-are-my-mysql-tables/" rel="bookmark" title="Permalink to How Large Are My MySQL Tables">
                <h2 class="post-title">
                    How Large Are My MySQL Tables
                </h2>
            </a>
                <p><img src="/images/database.jpg" alt="database" style="display:block;clear:both;"/>
Image CC-BY-SA, <a href="http://www.flickr.com/photos/theredproject/3332644561/">Michael Mandiberg</a></p>
<p>I found two good blog posts about investigating MySQL internals: 
<a href="http://www.mysqlperformanceblog.com/2008/03/17/researching-your-mysql-table-sizes/">Researching your MySQL table sizes</a> and
<a href="http://www.mysqlperformanceblog.com/2008/02/04/finding-out-largest-tables-on-mysql-server/">Finding out largest tables on MySQL Server</a>.
Using the queries against my site <a href="http://www.dif.io">Difio</a> showed:</p>
<div class="highlight"><pre><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">CONCAT</span><span class="p">(</span><span class="n">table_schema</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="k">table_name</span><span class="p">),</span>
    <span class="o">-&gt;</span>        <span class="n">CONCAT</span><span class="p">(</span><span class="n">ROUND</span><span class="p">(</span><span class="n">table_rows</span> <span class="o">/</span> <span class="mi">1000000</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>                                    <span class="k">rows</span><span class="p">,</span>
    <span class="o">-&gt;</span>        <span class="n">CONCAT</span><span class="p">(</span><span class="n">ROUND</span><span class="p">(</span><span class="n">data_length</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;G&#39;</span><span class="p">)</span>                    <span class="k">DATA</span><span class="p">,</span>
    <span class="o">-&gt;</span>        <span class="n">CONCAT</span><span class="p">(</span><span class="n">ROUND</span><span class="p">(</span><span class="n">index_length</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;G&#39;</span><span class="p">)</span>                   <span class="n">idx</span><span class="p">,</span>
    <span class="o">-&gt;</span>        <span class="n">CONCAT</span><span class="p">(</span><span class="n">ROUND</span><span class="p">((</span> <span class="n">data_length</span> <span class="o">+</span> <span class="n">index_length</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;G&#39;</span><span class="p">)</span> <span class="n">total_size</span><span class="p">,</span>
    <span class="o">-&gt;</span>        <span class="n">ROUND</span><span class="p">(</span><span class="n">index_length</span> <span class="o">/</span> <span class="n">data_length</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>                                           <span class="n">idxfrac</span>
    <span class="o">-&gt;</span> <span class="k">FROM</span>   <span class="n">information_schema</span><span class="p">.</span><span class="n">TABLES</span>
    <span class="o">-&gt;</span> <span class="k">ORDER</span>  <span class="k">BY</span> <span class="n">data_length</span> <span class="o">+</span> <span class="n">index_length</span> <span class="k">DESC</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------------------------------------+-------+-------+-------+------------+---------+</span>
<span class="o">|</span> <span class="n">CONCAT</span><span class="p">(</span><span class="n">table_schema</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="k">table_name</span><span class="p">)</span>  <span class="o">|</span> <span class="k">rows</span>  <span class="o">|</span> <span class="k">DATA</span>  <span class="o">|</span> <span class="n">idx</span>   <span class="o">|</span> <span class="n">total_size</span> <span class="o">|</span> <span class="n">idxfrac</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+-------+-------+-------+------------+---------+</span>
<span class="o">|</span> <span class="n">difio</span><span class="p">.</span><span class="n">difio_advisory</span>                   <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">04</span><span class="n">M</span> <span class="o">|</span> <span class="mi">3</span><span class="p">.</span><span class="mi">17</span><span class="k">G</span> <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span><span class="k">G</span> <span class="o">|</span> <span class="mi">3</span><span class="p">.</span><span class="mi">17</span><span class="k">G</span>      <span class="o">|</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+-------+-------+-------+------------+---------+</span>
</pre></div>


<p>The table of interest is <code>difio_advisory</code> which had 5 <code>longtext</code> fields. Those fields were
not used for filtering or indexing the rest of the information.
They were just storage fields - a `nice' side effect of using Django's ORM.</p>
<p>I have migrated the data to Amazon S3 and stored it in JSON format there. After dropping these
fields the table was considerably smaller:</p>
<div class="highlight"><pre><span class="o">+</span><span class="c1">----------------------------------------+-------+-------+-------+------------+---------+</span>
<span class="o">|</span> <span class="n">CONCAT</span><span class="p">(</span><span class="n">table_schema</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="k">table_name</span><span class="p">)</span>  <span class="o">|</span> <span class="k">rows</span>  <span class="o">|</span> <span class="k">DATA</span>  <span class="o">|</span> <span class="n">idx</span>   <span class="o">|</span> <span class="n">total_size</span> <span class="o">|</span> <span class="n">idxfrac</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+-------+-------+-------+------------+---------+</span>
<span class="o">|</span> <span class="n">difio</span><span class="p">.</span><span class="n">difio_advisory</span>                   <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="n">M</span> <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span><span class="k">G</span> <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span><span class="k">G</span> <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span><span class="k">G</span>      <span class="o">|</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">90</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------+-------+-------+-------+------------+---------+</span>
</pre></div>


<p>For those interested I'm using <a href="https://github.com/e-loue/django-storages">django-storages</a>
on the back-end to save the data in S3 when generated. On the front-end I'm using
<a href="http://dojotoolkit.com">dojo.xhrGet</a> to load the information directly into the browser.</p>
<p>I'd love to hear your feedback in the comments section below. Let me know 
what you found for your own databases. Were there any issues? How did you deal
with them? </p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Wed 20 February 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/02/20/how-large-are-my-mysql-tables/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/02/13/secure-vnc-installation-red-hat-enterprise-linux/" rel="bookmark" title="Permalink to Secure VNC Installation of Red Hat Enterprise Linux 6">
                <h2 class="post-title">
                    Secure VNC Installation of Red Hat Enterprise Linux 6
                </h2>
            </a>
                <p><img src="/images/rhel6_welcome.png" alt="RHEL 6 welcome screen" />
Image CC-BY-SA,
<a href="https://access.redhat.com/knowledge/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Installation_Guide/sn-welcome-s390.html">Red Hat</a></p>
<p>From time to time I happen to remotely
<a href="http://otb.bg">install Red Hat Enterprise Linux</a>
servers via the Internet.
When the system configuration is not decided upfront you need
to use interactive mode. This means VNC in my case.</p>
<p>In this tutorial I will show you how to make VNC installations more secure
when using public networks to connect to the server.</p>
<h2>Meet your tools</h2>
<p>Starting with Red Hat Enterprise Linux 6 and all the latest Fedora releases, the
installer supports SSH connections during install.</p>
<blockquote>
<p>Note that by default, root has a blank password.</p>
<p>If you don't want any user to be able to ssh in and have full access to your hardware, 
you must specify sshpw for username root. Also note that if Anaconda fails to parse the 
kickstart file, it will allow anyone to login as root and have full access to your hardware.</p>
<p>Fedora Kickstart manual https://fedoraproject.org/wiki/Anaconda/Kickstart#sshpw</p>
</blockquote>
<h2>Preparation</h2>
<p>We are going to use SSH port forwarding and tunnel VNC traffic through it.
Create a kickstart file as shown below:</p>
<div class="highlight"><pre>install
url --url http://example.com/path/to/rhel6
lang en_US.UTF-8
keyboard us
network --onboot yes --device eth0 --bootproto dhcp
vnc --password=s3cr3t
sshpw --user=root s3cr3t
</pre></div>


<p>The first 5 lines configure the loader portion of the installer. They will setup
networking and fetch the installer image called stage2. This is completely automated.
<strong>NB:</strong> If you miss some of the lines or have a syntax error the installer will prompt for
values. You either need a remote console access or somebody present at the server console!</p>
<p>The last 2 lines configure passwords for VNC and SSH respectively.</p>
<p>Make this file
<a href="https://fedoraproject.org/wiki/Anaconda/Kickstart#Chapter_6._Making_the_Kickstart_File_Available">available</a>
over HTTP(S), FTP or NFS.</p>
<p><strong>NB:</strong> Make sure that the file is available on the same network where your server is,
or use HTTPS if on public networks.</p>
<h2>Installation</h2>
<p>Now, using your favorite installation media start the
installation process like this: </p>
<div class="highlight"><pre><span class="n">boot</span><span class="o">:</span> <span class="n">linux</span> <span class="n">sshd</span><span class="o">=</span><span class="mi">1</span> <span class="n">ks</span><span class="o">=</span><span class="n">http</span><span class="o">://</span><span class="n">example</span><span class="o">.</span><span class="na">com</span><span class="o">/</span><span class="n">ks</span><span class="o">.</span><span class="na">cfg</span>
</pre></div>


<p>After a minute or more the installer will load stage2, with the
interactive VNC session. You need to know the IP address or hostname
of the server. Either look into DHCP logs, have somebody look at the
server console and tell you that (it's printed on tty1) or script it in
a <a href="https://fedoraproject.org/wiki/Anaconda/Kickstart#Chapter_4._Pre-installation_Script">%pre</a>
script which will send you an email for example.</p>
<p>When ready, redirect one of your local ports through SSH to the VNC port on the server:</p>
<div class="highlight"><pre><span class="nv">$ </span>ssh -L 5902:localhost:5901 -N root@server.example.com
</pre></div>


<p>Now connect to DISPLAY :2 on your system to begin the installation:</p>
<div class="highlight"><pre><span class="nv">$ </span>vncviewer localhost:2 <span class="p">&amp;</span>
</pre></div>


<h2>Warning Bugs Present</h2>
<p>As it happens, I find bugs everywhere. This is no exception.
Depending on your network/DHCP configuration IP address during install may 
change mid-air and cause VNC client connection to freeze.</p>
<p>The reason for this bug is evident from the code (rhel6-branch):</p>
<div class="highlight"><span class="filename">iw/timezone_gui.py</span><pre><span class="k">if</span> <span class="ow">not</span> <span class="n">anaconda</span><span class="o">.</span><span class="n">isKickstart</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">utcCheckbox</span><span class="o">.</span><span class="n">set_active</span><span class="p">(</span><span class="ow">not</span> <span class="n">hasWindows</span><span class="p">(</span><span class="n">anaconda</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">bootloader</span><span class="p">))</span>
</pre></div>


<div class="highlight"><span class="filename">textw/timezone_text.py</span><pre><span class="k">if</span> <span class="ow">not</span> <span class="n">anaconda</span><span class="o">.</span><span class="n">isKickstart</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">hasWindows</span><span class="p">(</span><span class="n">anaconda</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">bootloader</span><span class="p">):</span>
    <span class="n">asUtc</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>


<p>Because we are using a kickstart file Anaconda will assume the system clock <strong>DOES NOT</strong>
use UTC. If you forget to configure it manually you may see time on the server shifting
back or forward (depending on your timezone) while installing. If your DHCP is configured
for short lease time the address will expire before the installation completes. When new
address is requested from DHCP it may be different and this will cause your VNC connection
to freeze.</p>
<p>To workaround this issue select the appropriate value for the system clock settings during install
and possibly use static IP address during the installation.</p>
<h2>Feedback</h2>
<p>As always I'd love to hear your feedback in the comments section below. Let me know 
your tips and tricks to perform secure remote installations using public networks.</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Wed 13 February 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/02/13/secure-vnc-installation-red-hat-enterprise-linux/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/02/08/the-shoes-start-up/" rel="bookmark" title="Permalink to The shoes start-up">
                <h2 class="post-title">
                    The shoes start-up
                </h2>
            </a>
                <p>Did you know there is a start-up company producing men's shoes? Me neither,
and I love good quality shoes.</p>
<blockquote>
<p>Beckett Simonon launched in 2012, and slashed prices by working with local manufacturers and
selling directly to customers online.</p>
<p>The company, which currently operates out of Bogota, Colombia, says it has 
generated $80,000 in revenue after two months in operation, and has five employees.</p>
<p>Julie Strickland http://www.inc.com/julie-strickland/mens-fashion-startups.html</p>
</blockquote>
<p><img src="/images/Bailey_Chukka_Boot.jpg" style="float: left; margin-right: 10px;"/></p>
<p>From what I can tell <a href="http://www.beckettsimonon.com">Beckett Simonon</a> produce nice shoes.
I would rate them between very good and high quality, just looking at the pictures.
All designs are very classy and stylish, which is rare these days. Leather looks
high quality, soles too.</p>
<p>The ones I loved right away are the Bailey Chukka Boot model, shown here.
So far my gut feeling about shoes has never been wrong, even on the Internet, so
I'm thinking to pre-order a pair.</p>
<p>Anybody wants to team up for a joint order?</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Fri 08 February 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/02/08/the-shoes-start-up/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/02/05/performance-test-md5-sha1-sha256-sha512/" rel="bookmark" title="Permalink to Performance test of MD5, SHA1, SHA256 and SHA512">
                <h2 class="post-title">
                    Performance test of MD5, SHA1, SHA256 and SHA512
                </h2>
            </a>
                <p>A few months ago I wrote
<a href="https://github.com/atodorov/django-s3-cache">django-s3-cache</a>.
This is Amazon Simple Storage Service (S3) cache backend for Django
which uses hashed file names.
django-s3-cache uses <code>sha1</code> instead of <code>md5</code> which appeared to be
faster at the time. I recall that my testing wasn't very robust so I did another
round.</p>
<h2>Test Data</h2>
<p>The file <a href="http://s3.amazonaws.com/atodorov/blog/urls.txt.gz">urls.txt</a>
contains 10000 unique paths from the <a href="http://www.dif.io">dif.io</a>
website and looks like this:</p>
<div class="highlight"><pre>/updates/Django-1.3.1/Django-1.3.4/7858/
/updates/delayed_paperclip-2.4.5.2 c23a537/delayed_paperclip-2.4.5.2/8085/
/updates/libv8-3.3.10.4 x86_64-darwin-10/libv8-3.3.10.4/8087/
/updates/Data::Compare-1.22/Data::Compare-Type/8313/
/updates/Fabric-1.4.0/Fabric-1.4.4/8652/
</pre></div>


<h2>Test Automation</h2>
<p>I used the standard <a href="http://docs.python.org/2/library/timeit.html">timeit</a>
module in Python.</p>
<div class="highlight"><span class="filename">test.py</span><pre><span class="c">#!/usr/bin/python</span>

<span class="kn">import</span> <span class="nn">timeit</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">import hashlib</span>
<span class="sd">for line in url_paths:</span>
<span class="sd">    h = hashlib.md5(line).hexdigest()</span>
<span class="sd">#    h = hashlib.sha1(line).hexdigest()</span>
<span class="sd">#    h = hashlib.sha256(line).hexdigest()</span>
<span class="sd">#    h = hashlib.sha512(line).hexdigest()</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="p">,</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">url_paths = []</span>
<span class="sd">f = open(&#39;urls.txt&#39;, &#39;r&#39;)</span>
<span class="sd">for l in f.readlines():</span>
<span class="sd">    url_paths.append(l)</span>
<span class="sd">f.close()</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="p">)</span>

<span class="k">print</span> <span class="n">t</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">repeat</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>


<h2>Test Results</h2>
<p>The main statement hashes all 10000 entries one by one. This statement is
executed 1000 times in a loop, which is repeated 3 times. I have Python 2.6.6
on my system. After every test run the system was rebooted.
Execution time in seconds is available below.</p>
<div class="highlight"><pre>MD5     10.275190830230713, 10.155328989028931, 10.250311136245728
SHA1    11.985718965530396, 11.976419925689697, 11.86873197555542
SHA256  16.662450075149536, 21.551337003707886, 17.016510963439941
SHA512  18.339390993118286, 18.11187481880188,  18.085782051086426
</pre></div>


<p>Looks like I was wrong the first time! MD5 is still faster but not that much.
I will stick with SHA1 for the time being.</p>
<p>If you are interested in Performance Testing checkout the
<a target="_blank" href="http://www.amazon.com/s/ref=as_li_ss_tl?_encoding=UTF8&camp=1789&creative=390957&field-keywords=performance%20testing&linkCode=ur2&rh=n%3A283155%2Ck%3Aperformance%20testing&sprefix=performance%20testing%2Caps%2C270&tag=atodorovorg-20&url=search-alias%3Dstripbooks&linkId=UVEZLZJOVYOCVGOT">performance testing books on Amazon</a><img src="https://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=ur2&o=1" width="1" height="1" border="0" style="border:none !important; margin:0px !important;" />.</p>
<p>As always I’d love to hear your thoughts and feedback. Please use the comment form below.</p>
<h2>Python 2.7 vs. 3.6 and BLAKE2</h2>
<p><strong>UPDATE: added on June 9th 2017</strong></p>
<p>After request from my reader <em>refi64</em> I've tested this again between different
versions of Python and included a few more hash functions. The test data is the same,
the test script was slightly modified for Python 3:</p>
<div class="highlight"><span class="filename">test3.py</span><pre><span class="kn">import</span> <span class="nn">timeit</span>

<span class="k">print</span> <span class="p">(</span><span class="n">timeit</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">import hashlib</span>
<span class="sd">for line in url_paths:</span>
<span class="sd">#    h = hashlib.md5(line).hexdigest()</span>
<span class="sd">#    h = hashlib.sha1(line).hexdigest()</span>
<span class="sd">#    h = hashlib.sha256(line).hexdigest()</span>
<span class="sd">#    h = hashlib.sha512(line).hexdigest()</span>
<span class="sd">#    h = hashlib.blake2b(line).hexdigest()</span>
<span class="sd">    h = hashlib.blake2s(line).hexdigest()</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="p">,</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">url_paths = [l.encode(&#39;utf8&#39;) for l in open(&#39;urls.txt&#39;, &#39;r&#39;).readlines()]</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="n">repeat</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">1000</span><span class="p">))</span>
</pre></div>


<p>Test was repeated 3 times for each hash function and the best time was taken into account.
The test was performed on a recent Fedora 26 system. The results are as follows:</p>
<div class="highlight"><pre>Python 2.7.13

MD5     [13.94771409034729, 13.931367874145508, 13.908519983291626]
SHA1    [15.20741891860962, 15.241390943527222, 15.198163986206055]
SHA256  [17.22162389755249, 17.229840993881226, 17.23402190208435]
SHA512  [21.557533979415894, 21.51376700401306, 21.522911071777344]


Python 3.6.1

MD5     [11.770181038000146, 11.778772834999927, 11.774679265000032]
SHA1    [11.5838599839999, 11.580340686999989, 11.585769942999832]
SHA256  [14.836309305999976, 14.847088003999943, 14.834776135999846]
SHA512  [19.820048629999746, 19.77282728099999, 19.778471210000134]

BLAKE2b [12.665497404000234, 12.668979115000184, 12.667314543999964]
BLAKE2s [11.024885618000098, 11.117366972000127, 10.966767880999669]
</pre></div>


<ul>
<li>Python 3 is faster than Python 2</li>
<li>SHA1 is a bit faster than MD5, maybe there's been some optimization</li>
<li>BLAKE2b is faster than SHA256 and SHA512</li>
<li>BLAKE2s is the fastest of all functions</li>
</ul>
<p><strong>Note:</strong> BLAKE2b is optimized for 64-bit platforms, like mine and I thought it
will be faster than BLAKE2s (optimized for 8- to 32-bit platforms) but that's
not the case. I'm not sure why is that though. If you do, please let me know
in the comments below!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Tue 05 February 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/02/05/performance-test-md5-sha1-sha256-sha512/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/01/31/tip-save-money-on-amazon-buy-used-books/" rel="bookmark" title="Permalink to Tip: Save Money on Amazon - Buy Used Books">
                <h2 class="post-title">
                    Tip: Save Money on Amazon - Buy Used Books
                </h2>
            </a>
                <p>I like to buy books, the real ones, printed on paper. This however comes at
a certain price when buying from Amazon. The book price itself is
usually bearable but many times shipping costs to Bulgaria
will double the price. Especially if you are making a single book order.</p>
<p>To save money I started buying used books when available. For books that are
not so popular I look for items that have been owned by a library.</p>
<p>This is how I got a hardcover 1984 edition of
<a href="http://www.amazon.com/gp/product/190676820X/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=190676820X&linkCode=as2&tag=atodorovorg-20">The Gentlemen's Clubs of London</a><img src="http://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=190676820X" width="1" height="1" border="0"  style="border:none !important; margin:0px !important;" />
by Anthony Lejeune for $10. This is my best deal so far.
The book was brand new I dare to say. There was no edge wear, no damaged pages,
with nice and vibrant colors. The second page had the library sign and no other marks.</p>
<p>Let me know if you had an experience buying used books online? Did you score a great
deal like I did?</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Thu 31 January 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/01/31/tip-save-money-on-amazon-buy-used-books/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/01/31/click-tracking-without-mailchimp/" rel="bookmark" title="Permalink to Click Tracking without MailChimp">
                <h2 class="post-title">
                    Click Tracking without MailChimp
                </h2>
            </a>
                <p>Here is a standard notification message that users at <a href="http://www.dif.io">Difio</a>
receive. It is plain text, no HTML crap, short and URLs are clean and
descriptive. As the project lead developer I wanted to track when people click on
these links and visit the website but also keep existing functionality.</p>
<p><img alt="&quot;Email with links&quot;" src="/images/email_w_links.png" title="Email with links" /></p>
<h2>Standard approach</h2>
<p>A pretty common approach when sending huge volumes of email is to use an external
service, such as MailChimp. This is one of many email
marketing services which comes with a lot of features. The most important to me
was analytics and reports.</p>
<p>The downside is that MailChimp (and I guess others) use HTML formatted emails
extensively. I don't like that and I'm sure my users will not like it as well. 
They are all developers. Not to mention that MailChimp is much more expensive
than <a href="http://aws.amazon.com/ses/">Amazon SES</a> which I use currently.
No MailChimp for me!</p>
<p>Another common approach, used by Feedburner by the way,
is to use shortened URLs which redirect to the original ones and measure clicks
in between. I also didn't like this for two reasons: 1) the shortened URLs look
ugly and they are not at all descriptive and 2) I need to generate them automatically
and maintain all the mappings. Why bother ?</p>
<h2>How I did it?</h2>
<p>So I needed something which will do a redirect to a predefined URL, measure how many
redirects were there (essentially clicks on the link) and look nice. The solution is
very simple, if you have not recognized it by now from the picture above. </p>
<p>I opted for a custom redirect engine, which will add tracking information to the
destination URL so I can track it in Google Analytics.</p>
<p>Previous URLs were of the form <code>http://www.dif.io/updates/haml-3.1.2/haml-3.2.0.rc.3/11765/</code>.
I've added the humble <code>/daily/?</code> prefix before the URL path so it becomes
<code>http://www.dif.io/daily/?/updates/haml-3.1.2/haml-3.2.0.rc.3/11765/</code></p>
<p>Now <code>/updates/haml-3.1.2/haml-3.2.0.rc.3/11765/</code> becomes a query string parameter which
the <code>/daily/index.html</code> page uses as its destination. Before doing the redirect
a script adds tracking parameters so that Google Analytics will properly
report this visit. Here is the code: </p>
<div class="highlight"><pre><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
<span class="kd">var</span> <span class="nx">uri</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">question</span> <span class="o">=</span> <span class="nx">uri</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">param</span> <span class="o">=</span> <span class="nx">uri</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">question</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">uri</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">question</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">param</span> <span class="o">+</span> <span class="s1">&#39;?utm_source=email&amp;utm_medium=email&amp;utm_campaign=Daily_Notification&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>


<p>Previously Google Analytics was reporting these visits as direct hits while now it lists them under
campaigns like so:</p>
<p><img alt="&quot;Difio Analytics&quot;" src="/images/analytics_difio_campaigns.png" title="Difio Analytics" /></p>
<p>Because all visitors of <a href="http://www.dif.io">Difio</a> use JavaScript enabled browsers
I combined this approach with another one, to
<a href="/blog/2013/01/28/remove-query-string-with-javascript-and-html5/">remove query string with JavaScript</a>
and present clean URLs to the visitor.</p>
<h2>Why JavaScript?</h2>
<p>You may be asking why the hell I am using JavaScript and not Apache's wonderful mod_rewrite module? 
This is because the destination URLs are hosted in <a href="http://aws.amazon.com/s3/">Amazon S3</a> and I'm
planning to integrate with <a href="http://aws.amazon.com/cloudfront/">Amazon CloudFront</a>. Both of them
don't support .htaccess rules nor anything else similar to mod_rewrite.</p>
<p>As always I'd love to hear your thoughts and feedback. Please use the comment form below.</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Thu 31 January 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/01/31/click-tracking-without-mailchimp/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/01/30/startup-talk-5-book-list/" rel="bookmark" title="Permalink to StartUP Talk#5 - book list">
                <h2 class="post-title">
                    StartUP Talk#5 - book list
                </h2>
            </a>
                <p>Yesterday I have visited an interesting talk by
<a href="http://www.linkedin.com/in/tpanayotov">Teodor Panayotov</a> held at
<a href="http://www.betahaus.bg/">betahaus Sofia</a>. He was talking about his
path to success and all the companies he had worked in or founded.</p>
<p>I'm writing this post as a personal note to not forget all the good books
Teodor mentioned in his presentation.</p>
<p>I intend to read the these four as a start:</p>
<p><a href="http://www.amazon.com/gp/product/0307465357/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0307465357&linkCode=as2&tag=atodorovorg-20">The 4-Hour Workweek: Escape 9-5, Live Anywhere, and Join the New Rich (Expanded and Updated)</a><img src="http://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=0307465357" width="1" height="1" border="0" style="border:none !important; margin:0px !important;" /></p>
<p><a href="http://www.amazon.com/gp/product/0887307280/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0887307280&linkCode=as2&tag=atodorovorg-20">The E-Myth Revisited: Why Most Small Businesses Don't Work and What to Do About It</a><img src="http://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=0887307280" width="1" height="1" border="0" style="border:none !important; margin:0px !important;" /></p>
<p><a href="http://www.amazon.com/gp/product/1422121100/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=1422121100&linkCode=as2&tag=atodorovorg-20">Mastering the Hype Cycle: How to Choose the Right Innovation at the Right Time (Gartner)</a><img src="http://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=1422121100" width="1" height="1" border="0" style="border:none !important; margin:0px !important;" /></p>
<p><a href="http://www.amazon.com/gp/product/1599180413/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=1599180413&linkCode=as2&tag=atodorovorg-20">Business Models Made Easy</a><img src="http://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=1599180413" width="1" height="1" border="0" style="border:none !important; margin:0px !important;" /></p>
<p>The rest he recommended are:</p>
<p><a href="http://www.amazon.com/gp/product/1591842719/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=1591842719&linkCode=as2&tag=atodorovorg-20">How to Get Rich: One of the World's Greatest Entrepreneurs Shares His Secrets</a><img src="http://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=1591842719" width="1" height="1" border="0" style="border:none !important; margin:0px !important;" /></p>
<p><a href="http://www.amazon.com/gp/product/1451614217/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=1451614217&linkCode=as2&tag=atodorovorg-20">Abundance: The Future Is Better Than You Think</a><img src="http://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=1451614217" width="1" height="1" border="0" style="border:none !important; margin:0px !important;" /></p>
<p><a href="http://www.amazon.com/gp/product/0143037889/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0143037889&linkCode=as2&tag=atodorovorg-20">The Singularity Is Near: When Humans Transcend Biology</a><img src="http://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=0143037889" width="1" height="1" border="0" style="border:none !important; margin:0px !important;" /></p>
<p><a href="http://www.amazon.com/gp/product/1440428433/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=1440428433&linkCode=as2&tag=atodorovorg-20">The Law Of Success: Napoleon Hill</a><img src="http://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=1440428433" width="1" height="1" border="0" style="border:none !important; margin:0px !important;" /></p>
<p>If you happen to read any of these <a href="http://www.goodreads.com/review/list/16191345-alexander-todorov?shelf=to-read">before me</a>,
please share your thoughts on the book.</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Wed 30 January 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/01/30/startup-talk-5-book-list/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/01/28/remove-query-string-with-javascript-and-html5/" rel="bookmark" title="Permalink to Remove Query String with JavaScript and HTML5">
                <h2 class="post-title">
                    Remove Query String with JavaScript and HTML5
                </h2>
            </a>
                <p>A <a href="http://en.wikipedia.org/wiki/Query_string">query string</a> is the stuff after
the question mark in URLs.</p>
<p><img alt="&quot;URL with query string&quot;" src="/images/url_w_qs.png" /></p>
<h2>Why remove query strings?</h2>
<p>Two reasons: clean URLs and social media.</p>
<p>Clean URLs not only look better but they prevent users to see if you are tracking
where they came from. The picture above shows what the address bar
looks like after the user clicks a link in Feedburner. The high-lightened part is
what Google Analytics uses to distinguish Feedburner traffic from other types of
traffic. I don't want my users to see this.</p>
<p>As you know, social media sites give URLs a score, whether it is based on number of
bookmarks, reviews, comments, likes or whatever. Higher scores usually result in
increased traffic to your site. Query strings mess things up because <a href="http://www.dif.io">http://www.dif.io</a>
and <a href="http://www.dif.io/?query">http://www.dif.io/?query</a> are usually considered two different URLs. So instead
of having a high number of likes for your page you get several scores and never
make it to the headlines.</p>
<h2>JavaScript and HTML5 to the rescue</h2>
<p>Place this JavaScript code in the <code>&lt;head&gt;</code> section of your pages. Preferably near the top.</p>
<div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
<span class="kd">var</span> <span class="nx">uri</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">uri</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">clean_uri</span> <span class="o">=</span> <span class="nx">uri</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">uri</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">));</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">replaceState</span><span class="p">({},</span> <span class="nb">document</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span> <span class="nx">clean_uri</span><span class="p">);</span>
<span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>


<p>This code will clean the URL in the browser address bar without reloading the page.
It works for HTML5 enabled browsers.</p>
<p>This works for me with 
Firefox 10.0.12, Opera 12.02.1578 and Chrome 24.0.1312.56 under Linux.
<strike>In fact I'm using this snippet on this very own blog as well.</strike>
<strong>UPDATE:</strong> I've
<a href="/blog/2015/11/25/blog-migration-from-octopress-to-pelican/">migrated to Pelican</a>
and haven't enabled this script on the blog!</p>
<p><strong>Updated on 2013-01-30</strong></p>
<p>Here is another approach proposed by reader Kamen Mazdrashki: </p>
<div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
<span class="kd">var</span> <span class="nx">clean_uri</span> <span class="o">=</span> <span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span> <span class="o">+</span> <span class="s2">&quot;//&quot;</span> <span class="o">+</span> <span class="nx">location</span><span class="p">.</span><span class="nx">host</span> <span class="o">+</span> <span class="nx">location</span><span class="p">.</span><span class="nx">pathname</span><span class="p">;</span>
<span class="cm">/*</span>
<span class="cm">var hash_pos = location.href.indexOf(&quot;#&quot;);</span>
<span class="cm">if (hash_pos &gt; 0) {</span>
<span class="cm">    var hash = location.href.substring(hash_pos, location.href.length);</span>
<span class="cm">    clean_uri += hash;</span>
<span class="cm">}</span>
<span class="cm">*/</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">replaceState</span><span class="p">({},</span> <span class="nb">document</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span> <span class="nx">clean_uri</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>


<p>If you'd like to keep the hash tag aka named anchor aka fragment identifier at the end of the URL
then uncomment the commented section.</p>
<p>I've tested removing the hashtag from the URL. Firefox doesn't seem to scroll the page
to where I wanted but your experience may vary. I didn't try hard enough to
verify the results.</p>
<p>One question still remains though: Why would someone point the users to an URL which contains
named anchors and then remove them? I don't see a valid use case for this scenario.</p>
<p>You may want to take a look at the many
<a target="_blank" href="http://www.amazon.com/s/ref=as_li_ss_tl?_encoding=UTF8&camp=1789&creative=390957&field-keywords=HTML5%20and%20JavaScript&linkCode=ur2&rh=i%3Aaps%2Ck%3AHTML5%20and%20JavaScript&tag=atodorovorg-20&url=search-alias%3Daps&linkId=5JHZNZC3Q5R3RB3L">HTML5 and JavaScript books</a><img src="https://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=ur2&o=1" width="1" height="1" border="0" style="border:none !important; margin:0px !important;" />
if you don't have enough experience with the subject. For those of you who
are looking into Node.js I can recommend two book by my friend Krasi Tsonev:
<a rel="nofollow" href="http://www.amazon.com/gp/product/1783287330/ref=as_li_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=1783287330&linkCode=as2&tag=atodorovorg-20&linkId=ZBA3EYC4PZGKASAF">Node.js Blueprints - Practical Projects to Help You Unlock the Full Potential of Node.js</a><img src="http://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=1783287330" width="1" height="1" border="0" style="border:none !important; margin:0px !important;" />
and
<a rel="nofollow" href="http://www.amazon.com/gp/product/B00XJRN9S6/ref=as_li_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=B00XJRN9S6&linkCode=as2&tag=atodorovorg-20&linkId=OLBCPLXOAILZTJR5">Node.js By Example</a><img src="http://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=B00XJRN9S6" width="1" height="1" border="0" style="border:none !important; margin:0px !important;" />
.</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Mon 28 January 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/01/28/remove-query-string-with-javascript-and-html5/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/01/28/hello-world/" rel="bookmark" title="Permalink to Hello World">
                <h2 class="post-title">
                    Hello World
                </h2>
            </a>
                <p>Hi everyone and welcome to my blog! My name is Alex and you can read more <a href="/blog/2013/01/25/about-me/">about me</a>
if you like.</p>
<p>After several years of rather unsuccessful blogging I decided to revamp my blog,
influenced by the book
<em>Technical Blogging: Turn Your Expertise into a Remarkable Online Presence</em>
(
<a href="http://www.amazon.com/gp/product/1934356883/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=1934356883&linkCode=as2&tag=atodorovorg-20">Amazon</a><img src="http://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=1934356883" width="1" height="1" border="0" style="border:none !important; margin:0px !important;" />
|
<a href="http://www.tkqlhce.com/click-7040110-11260198?url=http%3A%2F%2Fshop.oreilly.com%2Fproduct%2F9781934356883.do%3Fcmp%3Daf-npa-book-product_cj_9781934356883_%7BPID%7D&cjsku=9781934356883" target="_top">O'Reilly</a><img src="http://www.ftjcfx.com/image-7040110-11260198" width="0" height="0" border="0" style="margin:0;padding:0;display:none;"/>
).</p>
<p>I'm starting fresh with new domain name and a big list of topics to write about. This blog will
be the place to share my thoughts on open source software, QA and cloud. From time to time
I intend to write about start-ups and being a start-up owner as well.</p>
<p>All content is published under
<a href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0</a>
license and all source code is under the <a href="http://opensource.org/licenses/MIT">MIT</a> license if not stated
otherwise.</p>
<p>I hope you find it interesting and helpful.</p>
<p><strong>Update 2013-09-22:</strong>
I have migrated some older blog posts and materials scattered around various places
to this site as well. So this isn't the very first post anymore!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Mon 28 January 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/01/28/hello-world/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2013/01/25/about-me/" rel="bookmark" title="Permalink to About Me">
                <h2 class="post-title">
                    About Me
                </h2>
            </a>
                <p><img style="float:left; margin-right: 25px;" src="/images/aboutme2.jpg" alt="This is how I look" title="This is how I look"/></p>
<p>My name is Alexander Todorov and this is how I look. It's pretty close!</p>
<p>I'm currently a contractor operating in the field of open source software and
quality engineering and a start-up owner with many ideas.</p>
<p>My professional interests cover vast amount of topics including but not limited
to Linux and open source, quality engineering, DevOps, cloud and
platform-as-a-service, programming with Python and Django.</p>
<p>I used to teach to students at Technical University of Sofia.
Nowadays I teach the
<a href="https://github.com/HackBulgaria/QA-and-Automation-101">QA and Automation 101</a>
course at HackBulgaria!</p>
<p>Execute this command to see my email:</p>
<div class="highlight"><pre><span class="n">echo</span> <span class="mi">17535658</span><span class="mf">@572.24</span> <span class="o">|</span> <span class="n">tr</span> <span class="p">[</span><span class="mi">12345678</span><span class="p">]</span> <span class="p">[</span><span class="n">abdgortv</span><span class="p">]</span>
</pre></div>


<p>Below you can find a list of current ventures and some of the more interesting
previous ones.</p>
<p><img style="float: left; margin-right: 10px;" src="/images/logos/mrsenko.png" alt="Mr. Senko" /></p>
<p><a href="http://mrsenko.com/?utm_source=atodorov.org&amp;utm_medium=blog&amp;utm_campaign=about">Mr. Senko</a>
is an open source tech support company, focusing on libraries and components used to build
other applications. Whenever you need something fixed and released into a new package version
Mr. Senko is the go-to place!
<br /></p>
<p><img style="float: left; margin-right: 10px;" src="/images/logos/difio.png" alt="Difio" /></p>
<p><a href="http://www.dif.io">Difio</a> was a service targeted at developers
who use open source packages and libraries. It shut down on Sept 10th 2014.
<br /><br /></p>
<p>I have some hard-earned certificates including:</p>
<ul>
<li>RHCE - Red Hat Certified Engineer - Oct 2008</li>
<li>RHCI - Red Hat Certified Instructor - Oct 2009</li>
<li>RHCVA - Red Hat Certified Virtualization Administrator - Sep 2010</li>
<li>Red Hat Partner Platform Certified Salesperson - Oct 2011</li>
<li>Red Hat Partner Virtualization Certified Salesperson - Oct 2011</li>
<li>Red Hat Partner Middleware Certified Salesperson - Oct 2011</li>
</ul>
<p>and I also own some domains. If you are interested just ask!</p>
<ul>
<li><a href="http://atodorov.org">atodorov.org</a></li>
<li><a href="http://www.dif.io">dif.io</a> - not in use anymore</li>
<li><a href="http://mrsenko.com/?utm_source=atodorov.org&amp;utm_medium=blog&amp;utm_campaign=about_domain">Mr. Senko</a></li>
<li><a href="http://obuvki41plus.com">obuvki41plus.com</a></li>
<li><a href="http://otb.bg">otb.bg</a></li>
<li>qecloud.com</li>
<li>qecloud.net</li>
<li>qecloud.org</li>
</ul>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Fri 25 January 2013
            </p>
<p>There are <a href="http://atodorov.org/blog/2013/01/25/about-me/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2012/07/13/mission-impossible-abrt-bugzilla-plugin-on-rhel6/" rel="bookmark" title="Permalink to Mission Impossible - ABRT Bugzilla Plugin on RHEL6">
                <h2 class="post-title">
                    Mission Impossible - ABRT Bugzilla Plugin on RHEL6
                </h2>
            </a>
                <p>Some time ago Red Hat introduced Automatic Bug Reporting Tool to their Red Hat Enterprise Linux
platform. This is a nice tool which lets users report bugs easily to Red Hat.
However one of the plugins in the latest version doesn't seem usable at all.</p>
<p>First make sure you have <code>libreport-plugin-bugzilla</code> package installed. This is the plugin to
report bugs directly to <a href="https://bugzilla.redhat.com">Bugzilla</a>. It may not be installed by default
because customers are supposed to report issues to Support first - this is why they pay anyway.
If you are a tech savvy user though, you may want to skip Support and go straight to the developers.</p>
<p>To enable Bugzilla plugin: </p>
<ul>
<li>Edit the file <code>/etc/libreport/events.d/bugzilla_event.conf</code> change the line<div class="highlight"><pre>EVENT=report_Bugzilla analyzer=libreport reporter-bugzilla -b
</pre></div>


</li>
</ul>
<p>to</p>
<div class="highlight"><pre>    EVENT=report_Bugzilla reporter-bugzilla -b
</pre></div>


<ul>
<li>
<p>Make sure ABRT will collect meaningful backtrace. If debuginfo is missing it will not let you continue.
Edit the file <code>/etc/libreport/events.d/ccpp_event.conf</code>. There should be something like this:</p>
<div class="highlight"><pre><span class="x">EVENT=analyze_LocalGDB analyzer=CCpp</span>
<span class="x">        abrt-action-analyze-core --core=coredump -o build_ids &amp;&amp;</span>
<span class="x">        abrt-action-generate-backtrace &amp;&amp;</span>
<span class="x">        abrt-action-analyze-backtrace</span>
<span class="x">        (</span>
<span class="x">            bug_id=</span><span class="p">$(</span><span class="err">reporter-bugzilla</span> <span class="err">-h</span> <span class="err">`cat</span> <span class="err">duphash`</span><span class="p">)</span><span class="x"> &amp;&amp;</span>
<span class="x">            if test -n &quot;</span><span class="p">$</span><span class="nv">bug_id</span><span class="x">&quot;; then</span>
<span class="x">                abrt-bodhi -r -b </span><span class="p">$</span><span class="nv">bug_id</span><span class="x"></span>
<span class="x">            fi</span>
<span class="x">        )</span>
</pre></div>


</li>
<li>
<p>Change it to look like this - i.e. add the missing <code>/usr/libexec/</code> line:</p>
<div class="highlight"><pre><span class="x">EVENT=analyze_LocalGDB analyzer=CCpp</span>
<span class="x">        abrt-action-analyze-core --core=coredump -o build_ids &amp;&amp;</span>
<span class="x">        /usr/libexec/abrt-action-install-debuginfo-to-abrt-cache --size_mb=4096 &amp;&amp;</span>
<span class="x">        abrt-action-generate-backtrace &amp;&amp;</span>
<span class="x">        abrt-action-analyze-backtrace &amp;&amp;</span>
<span class="x">        (</span>
<span class="x">            bug_id=</span><span class="p">$(</span><span class="err">reporter-bugzilla</span> <span class="err">-h</span> <span class="err">`cat</span> <span class="err">duphash`</span><span class="p">)</span><span class="x"> &amp;&amp;</span>
<span class="x">            if test -n &quot;</span><span class="p">$</span><span class="nv">bug_id</span><span class="x">&quot;; then</span>
<span class="x">                abrt-bodhi -r -b </span><span class="p">$</span><span class="nv">bug_id</span><span class="x"></span>
<span class="x">            fi</span>
<span class="x">        )</span>
</pre></div>


</li>
</ul>
<p>Supposedly after everything is configured properly ABRT will install missing debuginfo packages,
generate the backtrace and let you report it to Bugzilla. Because of
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=759443">bug 759443</a> this will not happen.</p>
<p>To work around the problem you can try to manually install the missing debuginfo packages.
Go to your system profile in RHN and subscribe the system to all appropriate debuginfo channels.
Then install the packages. In my case:</p>
<div class="highlight"><pre>    # debuginfo-install firefox
</pre></div>


<p>And finally - <a href="https://bugzilla.redhat.com/show_bug.cgi?id=800754">bug 800754</a> which was already reported!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Fri 13 July 2012
            </p>
<p>There are <a href="http://atodorov.org/blog/2012/07/13/mission-impossible-abrt-bugzilla-plugin-on-rhel6/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2012/07/12/combining-pdf-files-on-the-command-line/" rel="bookmark" title="Permalink to Combining PDF Files On The Command Line">
                <h2 class="post-title">
                    Combining PDF Files On The Command Line
                </h2>
            </a>
                <p><strong>VERSION</strong></p>
<p>Red Hat Enterprise Linux 6</p>
<p><strong>PROBLEM</strong></p>
<p>You have to create a single PDF file by combining multiple files -
for example individually scanned pages.</p>
<p><strong>ASSUMPTIONS</strong></p>
<p>You know how to start a shell and havigate to the directory containing the files.</p>
<p><strong>SOLUTION</strong></p>
<p>If individual PDF files are named, for example, <code>doc_01.pdf</code>, <code>doc_02.pdf</code>, <code>doc_03.pdf</code>,
<code>doc_04.pdf</code>, then you can combine them with the <code>gs</code> command:</p>
<div class="highlight"><pre>    $ gs -dBATCH -dNOPAUSE -sDEVICE=pdfwrite -sOutputFile=mydocument.pdf doc_*.pdf
</pre></div>


<p>The resulting PDF file will contain all pages from the individual files.</p>
<p><strong>MORE INFO</strong></p>
<p>The <code>gs</code> command is part of the <a href="http://www.ghostscript.com/">ghostscript</a> rpm package.
You can find more about it using <code>man gs</code>, the documentation file <code>/usr/share/doc/ghostscript-*/index.html</code>
or <a href="http://www.ghostscript.com">http://www.ghostscript.com</a>.</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Thu 12 July 2012
            </p>
<p>There are <a href="http://atodorov.org/blog/2012/07/12/combining-pdf-files-on-the-command-line/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2012/05/19/cross-domain-ajax-served-from-cdn/" rel="bookmark" title="Permalink to Cross-domain AJAX Served From CDN">
                <h2 class="post-title">
                    Cross-domain AJAX Served From CDN
                </h2>
            </a>
                <p>This week Amazon <a href="http://aws.typepad.com/aws/2012/05/amazon-cloudfront-support-for-dynamic-content.html">announced</a>
support for dynamic content in their CDN solution <a href="http://aws.amazon.com/cloudfront/"><em>Amazon CloudFront</em></a>.
The announce coincided with my efforts to migrate more pieces of <em>Difio</em>'s <a href="http://www.dif.io">website</a> to <em>CloudFront</em>.</p>
<p>In this article I will not talk about hosting static files on CDN. This is easy and I've already written
about it <a href="/blog/2012/04/17/using-openshift-as-amazon-cloudfront-origin-server/">here</a>. I will show how to
cache AJAX(JSONP actually) responses and serve them directly from <em>Amazon CloudFront</em>.</p>
<h2>Background</h2>
<p>For those of you who may not be familiar (are there any) CDN stands for
<a href="https://en.wikipedia.org/wiki/Content_delivery_network">Content Delivery Network</a>. In short
this employs numerous servers with identical content. The requests from the browser are served
from the location which gives best performance for the user. This is used by all major websites
to speed-up static content like images, video, CSS and JavaScript files.</p>
<p>AJAX means <a href="https://en.wikipedia.org/wiki/Ajax_%28programming%29">Asynchronous JavaScript and XML</a>.
This is what Google uses to create dynamic user interface which doesn't require to reload the page.</p>
<h2>Architecture</h2>
<p><em>Difio</em> has two web interfaces. The primary one is a static HTML website
which employs JavaScript for the dynamic areas. It is hosted on the dif.io domain.
The other one is powered by Django and provides the same interface plus the
<a href="https://difio-otb.rhcloud.com/dashboard/">applications dashboard</a> and several API functions
which don't have a visible user interface. This is under the *.rhcloud.com domain b/c it is hosted on
<a href="http://openshift.redhat.com"><em>OpenShift</em></a>.</p>
<p>The present state of the website is the result of rapid development using conventional methods - 
HTML templates and server-side processing. This is migrating to modern web technology like static HTML
and JavaScript while the server side will remain pure API service.</p>
<p>For this migration to happen I need the HTML pages at dif.io to execute JavaScript and load information
which comes from the rhcloud.com domain. Unfortunately this is not easily doable with AJAX because
of the <a href="https://en.wikipedia.org/wiki/Same_origin_policy">Same origin policy</a> in browsers.</p>
<p>I'm using the <a href="http://dojotoolkit.org/"><em>Dojo Toolkit</em></a> JavaScript framework which has a solution.
It's called <a href="https://en.wikipedia.org/wiki/JSONP">JSONP</a>. Here's how it works:</p>
<div class="highlight"><pre>     dif.io ------ JSONP request --&gt; abc.rhcloud.com --v
        ^                                              |
        |                                              |
    JavaScript processing                              |
        |                                              |
        +------------------ JSONP response ------------+
</pre></div>


<p>This is pretty standard configuration for a web service.</p>
<h2>Going to the clouds</h2>
<p>The way <em>Dojo</em> implements JSONP is through the
<a href="http://dojotoolkit.org/reference-guide/1.7/dojo/io/script.html">dojo.io.script</a> module.
It works by appending a query string parameter of the form <em>?callback=funcName</em> which the server uses
to generate the JSONP response. This callback name is dynamically generated by <em>Dojo</em> based on the order
in which your call to <em>dojo.io.script</em> is executed.</p>
<p>Until recently <em>Amazon CloudFront</em> ignored all query string parameters when requesting the content from
the origin server. Without the query string it was not possible to generate the JSONP response.
Luckily Amazon resolved the issue only one day after I asked about it on their forums.</p>
<p>Now <em>Amazon CloudFront</em> will use the URL path and the query string parameters to identify the objects in cache.
To enable this edit the CloudFront distribution <em>behavior(s)</em> and set <em>Forward Query Strings</em> to Yes.</p>
<p>When a visitor of the website requests the data <em>Amazon CloudFront</em> will use exactly the same url path and query strings
to fetch the content from the origin server. All that I had to do is switch the domain of the JSONP service
to point to the cloudfront.net domain. It became like this:</p>
<div class="highlight"><pre>                                                        | Everything on this side is handled by Amazon.
                                                        | No code required!
                                                        |
     dif.io ------ JSONP request --&gt; xyz.cloudfront.net -- JSONP request if cache miss --&gt; abc.rhcloud.com --v
        ^                              |                ^                                                    |
        |                              |                |                                                    |
    JavaScript processing              |                +---------- JSONP response --------------------------+
        |                              |
        +---- cached JSONP response ---+
</pre></div>


<p>As you can see the website structure and code didn't change at all. All that changed was a single domain name.</p>
<h2>Controlling the cache</h2>
<p><em>Amazon CloudFront</em> will keep the contents in cache based on the origin headers if present or the manual configuration
from the AWS Console. To work around frequent requests to the origin server it is considered best practice to set the
Expires header to a value far in the future, like 1 year.
However if the content changes you need some way to tell <em>CloudFront</em> about it. The most commonly used method is through
using different URLs to access the same content. This will cause <em>CloudFront</em> to cache the content under the new location
while keeping the old content until it expires.</p>
<p><em>Dojo</em> makes this very easy:</p>
<div class="highlight"><pre><span class="nx">require</span><span class="p">([</span><span class="s2">&quot;dojo/io/script&quot;</span><span class="p">],</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">script</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">script</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span>
                <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;https://xyz.cloudfront.net/api/json/updates/1234&quot;</span><span class="p">,</span>
                <span class="nx">callbackParamName</span><span class="o">:</span> <span class="s2">&quot;callback&quot;</span><span class="p">,</span>
                <span class="nx">content</span><span class="o">:</span> <span class="p">{</span><span class="nx">t</span><span class="o">:</span> <span class="nx">timeStamp</span><span class="p">},</span>
                <span class="nx">load</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">jsonData</span><span class="p">)</span> <span class="p">{</span>
                    <span class="p">....</span>
                <span class="p">},</span>
</pre></div>


<p>The <em>content</em> property allows additional key/value pairs to be sent in the query string. The
<em>timeStamp</em> parameter serves only to control <em>Amazon CloudFront</em> cache. It's not processed server side.</p>
<p>On the server-side we have:</p>
<div class="highlight"><pre><span class="n">response</span><span class="p">[</span><span class="s">&#39;Cache-Control&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;max-age=31536000&#39;</span>
<span class="n">response</span><span class="p">[</span><span class="s">&#39;Expires&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">+</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">31536000</span><span class="p">))</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%a, </span><span class="si">%d</span><span class="s"> %b %Y %H:%M:%S GMT&#39;</span><span class="p">)</span>
</pre></div>


<h2>Benefits</h2>
<p>There were two immediate benefits:</p>
<ul>
<li>Reduced page load time. Combined with serving static files from CDN this greatly improves the user experience;</li>
<li>Reduced server load. Content is requested only once if it is missing from the cache and then served from CloudFront.
The server isn't so busy serving content so it can be used to do more computations or simply reduce the bill.</li>
</ul>
<p>The presented method works well for <em>Difio</em> because of two things:</p>
<ul>
<li>The content which <em>Difio</em> serves usually doesn't change at all once made public. In rare occasions, for example an error
has been published, we have to regenerate new content and publish it under the same URL.</li>
<li>Before content is made public it is inspected for errors and this also preseeds the cache.</li>
</ul>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Sat 19 May 2012
            </p>
<p>There are <a href="http://atodorov.org/blog/2012/05/19/cross-domain-ajax-served-from-cdn/#disqus_thread">comments</a>.</p>        </div>

    <hr>
    <!-- Pager -->
    <ul class="pager">
        <li class="next">
                <a href="http://atodorov.org/author/alexander-todorov16.html">Older Posts &rarr;</a>
                <a href="http://atodorov.org/author/alexander-todorov14.html"> &larr; Newest Posts</a>
        </li>
    </ul>
    Page 15 / 16
    <hr>
            </div>
        </div>
    </div>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                            <li>
                                <a href="https://twitter.com/atodorov_">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/atodorov">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://bg.linkedin.com/in/alextodorov">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="http://feeds.feedburner.com/atodorov">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://www.youtube.com/playlist?list=PLFjlI7p-h1hxBP3cIjEqePSeoBDHud5Db">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-youtube fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="http://amzn.to/1ivu2q4">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-amazon fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="http://mrsenko.com/?utm_source=atodorov.org&utm_medium=blog&utm_campaign=social_icon">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-user-secret fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                    </ul>
<section>
    <p>
        I am the project lead for
        <a href="http://kiwitcms.org/?utm_source=atodorov.org&utm_medium=blog&utm_campaign=footer">Kiwi TCMS</a>
        and the current maintainer of <a href="http://MrSenko.com/pylint-workshop/">pylint-django</a>!
    </p>
    <p>
        <small>
            <em>
                Some of the links contained within this site have my referral id (e.g.,
                <a target="_blank" href="http://www.amazon.com/ref=as_li_ss_tl?_encoding=UTF8&camp=1789&creative=390957&linkCode=ur2&tag=atodorovorg-20&linkId=L6Q34XAXQS5RDMOY">Amazon</a><img src="https://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=ur2&o=1" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />),
                which provides me with a small commission for each sale. Thank you for your support.
            </em>
        </small>
    </p>
</section>

<form action="http://google.com/search" method="get" style="width:300px;margin:0 auto;">
    <fieldset role="search">
        <input type="hidden" name="sitesearch" value="http://atodorov.org" />
        <input class="search" type="text" name="q" placeholder="Search" style="width:100%"/>
    </fieldset>
</form>

<p class="copyright text-muted">
    <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">CC-BY-SA</a> &amp;
    <a rel="license" href="http://opensource.org/licenses/MIT">MIT</a>
    2011-2018 &diams; Alexander Todorov
</p>

<script type='text/javascript'>
window.__lo_site_id = 55936;
    (function() {
        var wa = document.createElement('script'); wa.type = 'text/javascript'; wa.async = true;
        wa.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://cdn') + '.luckyorange.com/w.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(wa, s);
      })();
</script>
                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="http://atodorov.org/theme/js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="http://atodorov.org/theme/js/bootstrap.min.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37979549-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'atodorov';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>

</html>