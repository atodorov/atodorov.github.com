
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>atodorov.org - you can logoff, but you can never leave</title>
  <meta name="author" content="Alexander Todorov">

  
  <meta name="description" content="Beware if you are using code like this: models.DateTimeField(default=datetime.now()) i.e. passing a function return value as the default option for a &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://atodorov.org/blog/page/4/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/atodorov" rel="alternate" title="atodorov.org - you can logoff, but you can never leave" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=Russo+One" rel="stylesheet" type="text/css" />
<meta name="google-site-verification" content="XynqZtldWNBbmsynVQZremIxaaO8Wgs6AGR8UZ7KIkM" />

  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-37979549-1', 'atodorov.org');
  ga('send', 'pageview');

</script>


</head>

<body   >
  <header role="banner"><hgroup>
<div id="logo-container">
<div id="logo">atodorov.org</div>
<div id="logo-sub"><em>
you can logoff, but you can never leave
</em></div>
</div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/atodorov" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/give-away/">Give Away List</a></li>
  <li><a href="/projects/">Projects</a></li>
  <li><a href="/domains/">Domains</a></li>
  <li><a href="http://amzn.to/1wTPaLe">Previous: Traction</a></li>
  <li><a href="http://amzn.to/1lLi5NU">Previous: How to Win Friends</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/15/beware-of-django-default-model-field-option-when-using-datetime-now/">Beware of Django Default Model Field Option When Using datetime.now()</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-15T15:54:00+03:00" pubdate data-updated="true">Apr 15<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/04/15/beware-of-django-default-model-field-option-when-using-datetime-now/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Beware if you are using code like this:</p>

<pre><code>models.DateTimeField(default=datetime.now())
</code></pre>

<p>i.e. passing a function return value as the default option for a model field in Django.
In some cases the value will be calculated once when the application starts or
the module is imported and will not be updated later. The most common scenario
is DateTime fields which default to now(). The correct way is to use a callable:</p>

<pre><code>models.DateTimeField(default=datetime.now)
</code></pre>

<p>I&#8217;ve hit this issue on a low volume application which uses cron to collect its own
metrics by calling an internal URL. The app was running as WSGI app and I wondered
why I got records with duplicate dates in the DB. A more detailed (correct) example follows:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">_strftime</span><span class="p">():</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s">&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Metrics</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span><span class='line'>    <span class="n">key</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">db_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span><span class='line'>    <span class="n">value</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FloatField</span><span class="p">()</span>
</span><span class='line'>    <span class="n">added_on</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">db_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
</span><span class='line'>    <span class="n">added_on_as_text</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_strftime</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://www.dif.io">Difio</a> also had the same bug but didn&#8217;t exhibit the problem
because all objects with default date-time values were created on the backend nodes
which get updated and restarted very often.</p>

<p>For more info read this
<a href="http://david.feinzeig.com/blog/2011/12/06/how-to-properly-set-a-default-value-for-a-datetimefield-in-django/">blog</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/08/positive-biological-effects-of-open-source-on-humans/">Positive Biological Effects of Open Source on Humans</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-08T16:45:00+03:00" pubdate data-updated="true">Apr 8<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/04/08/positive-biological-effects-of-open-source-on-humans/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Recently I watched a <a href="http://www.youtube.com/watch?v=ReRcHdeUG9Y">talk by Simon Sinek</a>
about leadership. He talks about Endorphins, Dopamine, Serotonin and Oxytocin
and how they make us feel and act a particular way. Then I though - maybe that&#8217;s why working
in the open source field always felt great and natural to me. Maybe we humans
are programmed to follow the open source way!</p>

<p>This article scratches the surface where body chemistry and open source intersect.
I hope it will help both volunteers and community managers get an insight of the
driving forces in our bodies, how they relate to the open source world and promt
further exploration. By seeking to better understand the positive effects and avoid
the negative ones we can become better contributors and leaders which ultimately
helps our communities.</p>

<h2>Endorphins</h2>

<p>Endorphins stand for endurance. Their job is to mask physical pain and it has been
suggested to have evolutionary roots based on the theory that they helped with the
survival of early humans. Athletes experience so called Runner&#8217;s high.</p>

<p>In the open source world one may work on a feature or task for hours and hours
without feeling exhausted. The task itself keeps you going and excited.
This is endorphins going through your brain.</p>

<p>In software one may experience an endorphin rush during public release days for example. For large
projects like Fedora the release process includes many steps and may take several hours.
During all that time the release engineer is usually available regardless of their native
time zone.</p>

<p>Effects of endorphins could potentially increase the likelihood of injury or extreme exhaustion,
as pain sensation could be more easily ignored. Work and rest cycles need to be properly balanced.</p>

<h2>Dopamine</h2>

<p>This is the feeling when we achieve our goals or found something we were looking for.
Dopamine helps us get things done! This is why we&#8217;re told to write down our goals and then
cross them off. It makes people more productive.</p>

<p>Getting dopamine through open source is very easy - all you need to do is fix a bug,
then another one, and another one, and another one &#8230; After every task you complete the body
gets a small dopamine fix. &#8220;Release early, release often &#8230;&#8221; and you get your fix :).</p>

<p>Dopamine however is highly addictive and destructive if unbalanced. It has the same negative
effects as any other addiction - alcohol, drugs, etc. Be aware of that and don&#8217;t fall for the
performance trap.</p>

<p>Endorphins and Dopamine are so called selfish chemicals. You can get them without external help.
The next two are the social chemicals.</p>

<h2>Serotonin</h2>

<p>It is responsible for feelings of pride and status and assessing social rank.
Serotonin is produced when you are recognized for achievements by the open source community
or credited by somebody (e.g. Johnny Bravo mentioned a great idea on IRC today).</p>

<p>As a contributor one may work on items which will help you get recognition but ultimately this
is not for you to decide. However practice shows that credit and recognition are relatively easy
to get in the open source world provided one has contributed to make the project and the
community better in some sort.</p>

<p>In software this is being granted commit rights to a repository, being in the top spot of
some metrics, having your blog read by other members or simply people asking for help or
what you think about some topic.</p>

<p>Serotonin is considered the leadership chemical. As one becomes a leader recognized by the
community there&#8217;s a catch - the more your status goes up the more work you have to
do. The more people recognize you as the leader the more they expect you to sacrifice yourself
in case it all goes Pete Tong. If you are not ready to step up find a more suitable place in
the community instead.</p>

<h2>Oxytocin</h2>

<p>Oxytocin is responsible for feelings of love, trust and friendship. It makes us feel safe.
It is also very good for the body because it makes us healthier, boosts our
immune system, increases ability to solve problems and increases creativity.</p>

<p>One way to get Oxytocin is by physical touch - e.g. a hand shake. This is probably one of
the reasons beer gatherings are so popular among open source developers.
Working digitally we need a way to
reinforce human bonds in our communities. Knowing the person on the other end of the wire
ultimately makes us feel safer. If you are in open source just go for that conference or a
local beer bash you wanted to go - it is good for you (but don&#8217;t get drunk).</p>

<p>Another way to get Oxytocin is by performing or witnessing acts of human generosity.
This comes natural in open source world where people give up their free time and energy to work towards
a shared goal. Just by working in an open source environment you get all that goodness for you.</p>

<p>The best thing about Oxytocin is that it is not addictive and slowly builds up in the body.
The bad side is that it takes a while to build up. This is why you have to stay a little longer
in open source before it starts feeling safe and welcoming.</p>

<h2>Cortisol</h2>

<p>The last chemical Simon talks about is Cortisol. It is bad, very bad. It will crash your body.
Cortisol means stress. It is designed to keep humans (and animals) alive by hyper tuning
our senses in case of danger. Trouble is you are not supposed to have it in your body for
long periods of time because it shuts down non-essential systems to deliver that extra energy.</p>

<p>Luckily most open source projects are not stressful and I think can be considered a safe place
to work in. In the end one can always shift to another role or move to another project if it
becomes too pressing.</p>

<p>By committing
to help another member or perform service to the community our bodies get all the good
stuff and beat the negative. Service to a community is exactly what open source does!
See, humans are programmed to live and work the open source way!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/01/happy-april-fools-day/">Happy April Fools Day</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-01T11:35:00+03:00" pubdate data-updated="true">Apr 1<span>st</span>, 2014</time>
        
         | <a href="/blog/2014/04/01/happy-april-fools-day/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Happy April Fools Day everyone! Here are few stories that I find particularly
amusing.</p>

<p><a href="http://thisisanothercastle.com/2014/03/26/april-fools-top-5-pranks-game-developers-pulled-on-players/">Top 5 Pranks Game Developers Pulled on Players</a>
- now that&#8217;s what I call dedication. #1 is definitely worth a peek :)</p>

<p><a href="http://signaltower.co/april-fools-pranks-for-developers/">April Fools Pranks for Developers</a> or
office workers! This is pure evil which messes up with the default CSS settings
on your computer.</p>

<p>What other developer related pranks did you find ?</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/28/i-need-an-app-to-connect-with-my-facebook-page-fans/">I Need an App to Connect With My Facebook Page Fans</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-28T23:18:00+02:00" pubdate data-updated="true">Mar 28<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/03/28/i-need-an-app-to-connect-with-my-facebook-page-fans/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The biggest problem of Facebook is the sheer number of news items
which are filtered out if users are not actively engaged with them.
For a page admin/business owner this means Facebook makes a poor job at reaching
to my fans and potential customers unless I keep paying them money!
I need two basic features to solve this problem.</p>

<h2>Contact All Users App aka Newsletter</h2>

<p>I need to be able to message my fan base like a newsletter with the following
requirements in mind:</p>

<ul>
<li>Users have already liked the page, don&#8217;t make them sign-up or follow anything else;</li>
<li>Preferably use Facebook messages instead of email;</li>
<li>Let them unsubscribe from the newsletter without going away/blocking the page;</li>
</ul>


<p>The first one is straight forward - I&#8217;ve already put some money in promoting my page
and collecting fans. No need for more hurdles to get started. For reference out of 500
users none has actually subscribed to the page. This gives you an idea how much they
will subscribe to newsletters and such. They click LIKE and forget about it.</p>

<p>The second one is dependent on the target audience. I have the feeling that my target
audience is reading Facebook messages much more than email.</p>

<p>My primary use case of this will be to send new offers and validation queries to the
target audience in order to tailor the content and business to them.</p>

<h2>Weekly Digest App</h2>

<p>Looking at my Facebook page stats it is clear that only promoted content gets a higher reach.
This includes both content paid for and content posted during periods where the page itself
had an active advertisement.</p>

<p>This is no coincidence I think. When the page is promoted to new audience they will get around
the available tabs, explore and like pictures and scroll down to see some of the older content.
Assuming the person becomes a page fan they will fall into the previously described trap (content filter)
and not see much of the page activity.</p>

<p>I need an application which will aggregate the content from the last week and send it to
everyone. This app needs to:</p>

<ul>
<li>Be able to configure digest period/cut-off days and when to send the digest;</li>
<li>Allow users to unsubscribe or alter their digest preferences;</li>
</ul>


<p>Primary use case is to alert users of content which they may have missed.</p>

<ul>
<li>Bonus feature: exclude content which was seen by the specific person or they somehow reacted to it;</li>
</ul>


<h2>Where to next </h2>

<p>I am actively looking for such kinds of apps but haven&#8217;t found any yet. When time allows I will
be looking at the Facebook API to see if this is at all possible to implement.</p>

<p>Any suggestions ?</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/19/sms-pin-verification-with-twilio-and-django/">SMS PIN Verification With Twilio and Django</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-19T11:41:00+02:00" pubdate data-updated="true">Mar 19<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/03/19/sms-pin-verification-with-twilio-and-django/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is a quick example of SMS PIN verification using Twilio cloud services and
Django which I did for a small site recently.</p>

<p><img src="/images/sms_pin.png" title="SMS PIN form" alt="SMS PIN form" /></p>

<p>The page template contains the following HTML snippet</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">id=</span><span class="s">&quot;mobile_number&quot;</span> <span class="na">name=</span><span class="s">&quot;mobile_number&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;111-111-1111&quot;</span> <span class="na">required</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">&quot;btn&quot;</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">onClick=</span><span class="s">&quot;send_pin()&quot;</span><span class="nt">&gt;&lt;i</span> <span class="na">class=</span><span class="s">&quot;icon-share&quot;</span><span class="nt">&gt;&lt;/i&gt;</span> Get PIN<span class="nt">&lt;/button&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>and a JavaScript function utilizing jQuery:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">send_pin</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>                <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;{% url &#39;ajax_send_pin&#39; %}&quot;</span><span class="p">,</span>
</span><span class='line'>                <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
</span><span class='line'>                <span class="nx">data</span><span class="o">:</span> <span class="p">{</span> <span class="nx">mobile_number</span><span class="o">:</span>  <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#mobile_number&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span> <span class="p">},</span>
</span><span class='line'>            <span class="p">})</span>
</span><span class='line'>            <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;PIN sent via SMS!&quot;</span><span class="p">);</span>
</span><span class='line'>            <span class="p">})</span>
</span><span class='line'>            <span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">,</span> <span class="nx">errorThrown</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">alert</span><span class="p">(</span><span class="nx">errorThrown</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nx">jqXHR</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
</span><span class='line'>            <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then create the following views in Django:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">_get_pin</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&quot;&quot;&quot; Return a numeric PIN with length digits &quot;&quot;&quot;</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">length</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">10</span><span class="o">**</span><span class="n">length</span><span class="p">),</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">_verify_pin</span><span class="p">(</span><span class="n">mobile_number</span><span class="p">,</span> <span class="n">pin</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&quot;&quot;&quot; Verify a PIN is correct &quot;&quot;&quot;</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">pin</span> <span class="o">==</span> <span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">mobile_number</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">ajax_send_pin</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&quot;&quot;&quot; Sends SMS PIN to the specified number &quot;&quot;&quot;</span>
</span><span class='line'>    <span class="n">mobile_number</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;mobile_number&#39;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="ow">not</span> <span class="n">mobile_number</span><span class="p">:</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s">&quot;No mobile number&quot;</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="s">&#39;text/plain&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">403</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">pin</span> <span class="o">=</span> <span class="n">_get_pin</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># store the PIN in the cache for later verification.</span>
</span><span class='line'>    <span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">mobile_number</span><span class="p">,</span> <span class="n">pin</span><span class="p">,</span> <span class="mi">24</span><span class="o">*</span><span class="mi">3600</span><span class="p">)</span> <span class="c"># valid for 24 hrs</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">client</span> <span class="o">=</span> <span class="n">TwilioRestClient</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">TWILIO_ACCOUNT_SID</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">TWILIO_AUTH_TOKEN</span><span class="p">)</span>
</span><span class='line'>    <span class="n">message</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">messages</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
</span><span class='line'>                        <span class="n">body</span><span class="o">=</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">pin</span><span class="p">,</span>
</span><span class='line'>                        <span class="n">to</span><span class="o">=</span><span class="n">mobile_number</span><span class="p">,</span>
</span><span class='line'>                        <span class="n">from_</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">TWILIO_FROM_NUMBER</span><span class="p">,</span>
</span><span class='line'>                    <span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s">&quot;Message </span><span class="si">%s</span><span class="s"> sent&quot;</span> <span class="o">%</span> <span class="n">message</span><span class="o">.</span><span class="n">sid</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="s">&#39;text/plain&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">process_order</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&quot;&quot;&quot; Process orders made via web form and verified by SMS PIN. &quot;&quot;&quot;</span>
</span><span class='line'>    <span class="n">form</span> <span class="o">=</span> <span class="n">OrderForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
</span><span class='line'>        <span class="n">pin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;pin&quot;</span><span class="p">,</span> <span class="s">&quot;0&quot;</span><span class="p">))</span>
</span><span class='line'>        <span class="n">mobile_number</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;mobile_number&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="n">_verify_pin</span><span class="p">(</span><span class="n">mobile_number</span><span class="p">,</span> <span class="n">pin</span><span class="p">):</span>
</span><span class='line'>            <span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s">&#39;transaction_complete&#39;</span><span class="p">)</span>
</span><span class='line'>        <span class="k">else</span><span class="p">:</span>
</span><span class='line'>            <span class="n">messages</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">&quot;Invalid PIN!&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">else</span><span class="p">:</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span>
</span><span class='line'>                    <span class="n">request</span><span class="p">,</span>
</span><span class='line'>                    <span class="s">&#39;order.html&#39;</span><span class="p">,</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>                        <span class="s">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                <span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>PINs are only numeric and are stored in the CACHE instead of the database which
I think is simpler and less expensive in terms of I/O operations.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/17/how-do-you-test-thai-scalable-fonts/">How Do You Test Thai Scalable Fonts</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-17T22:51:00+02:00" pubdate data-updated="true">Mar 17<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/03/17/how-do-you-test-thai-scalable-fonts/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Recently I wrote about <a href="/blog/2014/03/04/how-do-you-test-fonts/">testing fonts</a>.
I finally managed to get an answer from the authors of <em>thai-scalable-fonts</em>.</p>

<blockquote><p>> * What is your approach for testing Fonts-TLWG?</p><p>It&#8217;s not automated test. What it does is generate PDF with sample<br/>texts at several sizes (the waterfall), pangrams, and glyph table.<br/>It needs human eyes to investigate.</p><p>> * What kind of problems is your test suite designed for ?</p><p>- Shaping<br/>- Glyph coverage<br/>- Metrics</p><p>We also make use of fontforge features to make spotting errors<br/>easier, such as<br/>- Show extremas<br/>- Show almost vertical/horizontal lines/curves</p><footer><strong>Theppitak Karoonboonyanan</strong> <cite>Fonts-TLWG</cite></footer></blockquote>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/07/reducing-aws-cloud-costs-real-money-example/">Reducing AWS Cloud Costs - Real Money Example</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-07T17:14:00+02:00" pubdate data-updated="true">Mar 7<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/03/07/reducing-aws-cloud-costs-real-money-example/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://aws.amazon.com/ebs/pricing/effective-february-2014/">Last month</a> Amazon
reduced by 50% prices for EBS storage. This, combined with
<a href="/blog/2014/02/07/aws-tip-shrinking-ebs-root-volume-size/">shrinking EBS root volume size</a> and
<a href="/blog/2014/02/10/moving-tmp-from-ebs-to-instance-storage/">moving /tmp to instance storage</a>
allowed me to reduce EBS related costs behind <a href="http://www.dif.io">Difio</a> by around 50%.
Following are the real figures from my AWS Bill.</p>

<p>EBS costs for Difio were gradually rising up with every new node added to the cluster and
increased package processing (resulting in more I/O):</p>

<ul>
<li>November 2013 - $7.38</li>
<li>December 2013 - $10.55</li>
<li>January 2014 - $11.97</li>
</ul>


<figure class='code'><figcaption><span>January 2014 </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>EBS
</span><span class='line'>$0.095 per GB-Month of snapshot data stored     9.052 GB-Mo     $0.86
</span><span class='line'>$0.10  per GB-month of provisioned storage      101.656 GB-Mo  $10.17
</span><span class='line'>$0.10  per 1 million I/O requests               9,405,243 IOs   $0.94
</span><span class='line'>                                                        Total: $11.97</span></code></pre></td></tr></table></div></figure>


<p>In February there was one new system added to process additional requests
(cluster nodes run as spot instances) and an increased number of temporary
instances (although I haven&#8217;t counted them) while I was restructuring AMI
internals to accommodate the <a href="https://github.com/difio/difio">open source</a>
version of Difio. My assumption (based on historical data) is this would
have driven the costs up in the region of $15 per month only for EBS.</p>

<p>After implementing the stated minimal improvements and having Amazon reduced the prices by
half the bill looks like this:</p>

<figure class='code'><figcaption><span>February 2014 </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>EBS
</span><span class='line'>$0.095 per GB-Month of snapshot data stored     8.668 GB-Mo     $0.82
</span><span class='line'>$0.05  per GB-month of provisioned storage      58.012 GB-Mo    $2.90
</span><span class='line'>$0.05  per 1 million I/O requests               5,704,482 IOs   $0.29
</span><span class='line'>                                                        Total:  $4.01</span></code></pre></td></tr></table></div></figure>


<h2>Explanation</h2>

<p><em>Snapshot data stored</em> is the volume of snapshots (AMIs, backups, etc) which
I have. This is fairly constant.</p>

<p><em>Provisioned storage</em> is the volume of EBS storage provisioned for running
instances (e.g. root file system, data partitions, etc.). This was reduced
mainly because of shrinking the root volumes. (Previously I&#8217;ve used larger
root volumes for a bigger /tmp).</p>

<p><em>I/O requests</em> is the number of I/O requests associated with your EBS volumes.
As far as I understand Amazon doesn&#8217;t charge for I/O related to ephemeral storage.
Moving /tmp from EBS to instance storage is the reason this was reduced roughly by half.</p>

<h2>Where To Next</h2>

<p>I&#8217;ve reduced the root volumes back to the 8GB defaults but this has still room for
improvement b/c the AMI is quite minimal. This will bring the largest improvements.
Another thing is the still relatively high I/O rate that touches EBS volumes.
I haven&#8217;t investigated where this comes from though.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/04/how-do-you-test-fonts/">How Do You Test Fonts</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-04T21:30:00+02:00" pubdate data-updated="true">Mar 4<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/03/04/how-do-you-test-fonts/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="/blog/2014/03/03/last-week-in-fedora-qa/">Previously</a> I mentioned about testing
fonts but didn&#8217;t have any idea how this is done. Authors
Khaled Hosny of <a href="http://www.amirifont.org/">Amiri Font</a> and Steve White of
<a href="http://www.gnu.org/software/freefont/">GNU FreeFont</a> provided valuable insight
and material for further reading. I&#8217;ve asked them:</p>

<ul>
<li>What is your approach for testing ?</li>
<li>What kind of problems is your test suite designed for ?</li>
</ul>


<p>Here&#8217;s what they say:</p>

<blockquote><p>Currently my test suite consists of text strings (or lists of code<br/>points) and expected output glyph sequences and then use HarfBuzz<br/>(through its hb-shape command line tool) to check that the fonts always<br/>output the expected sequence of glyphs, sometimes with the expected<br/>positioning as well. Amiri is a complex font that have many glyph<br/>substitution and positioning rules, so the test suite is designed to<br/>make sure those rules are always executed correctly to catch regressions<br/>in the font (or in HarfBuzz, which sometimes happens since the things I<br/>do in my fonts are not always that common).</p><p>I think Lohit project do similar testing for their fonts, and HarfBuzz<br/>itself has a similar test suite with a bunch of nice scripts (though<br/>they are not installed when building HarfBuzz, yet[1]).</p><p>Recently I added more kinds of tests, namely checking that OTS[2]<br/>sanitizes the fonts successfully as this is important for using them on<br/>the web, and a test for a common mistakes I made in my feature files<br/>that result in unexpected blank glyphs in the fonts.</p><footer><strong>Khaled Hosny</strong> <cite>Amiri Font</cite></footer></blockquote>


<ol>
<li><a href="https://github.com/behdad/harfbuzz/pull/12">https://github.com/behdad/harfbuzz/pull/12</a></li>
<li><a href="https://github.com/khaledhosny/ots">https://github.com/khaledhosny/ots</a></li>
</ol>


<blockquote><p>The answer is complicated.  I&#8217;ll do what I can to answer.</p><p>First, the FontForge application has a &#8220;verification&#8221; function which<br/>can be run from a script, and which identifies numerous technical<br/>problems.</p><p>FontForge also has a &#8220;Find Problems&#8221; function that I run by hand.</p><p>The monospaced face has special restrictions, first that all glyphs of<br/>non-zero width must be of the same width, and second, that all glyphs<br/>lie within the vertical bounds of the font.</p><p>Beside this, I have several other scripts that check for a few things<br/>that FontForge doesn&#8217;t (duplicate names, that glyph slots agree with<br/>Unicode code within Unicode character blocks).</p><p>Several tests scripts have yet to be uploaded to the version control<br/>system &#8211; because I&#8217;m unsure of them.</p><p>There is a more complicated check of TrueType tables, which attempts<br/>to find cases of tables that have been &#8220;shadowed&#8221; by the<br/>script/language specification of another table.  This is helpful, but<br/>works imperfectly.</p><p>ALL THAT SAID,</p><p>In the end, every script used in the font has to be visually checked.<br/>This process takes me weeks, and there&#8217;s nothing systematic about it,<br/>except that I look at printout of documents in each language to see if<br/>things have gone awry.</p><p>For a few documents in a few languages, I have images of how text<br/>*should* look, and can compare that visually (especially important for<br/>complex scripts.)</p><p>A few years back, somebody wrote a clever script that generated images<br/>of text and compared them pixel-by-pixel.  This was a great idea, and<br/>I wish I could use it more effectively, but the problem was that it<br/>was much too sensitive.  A small change to the font (e.g. PostScript<br/>parameters) would cause a small but global change in the rendering.<br/>Also the rendering could vary from one version of the rendering<br/>software to another.  So I don&#8217;t use this anymore.</p><p>That&#8217;s all I can think of right now.</p><p>In fact, testing has been a big problem in getting releases out.  In<br/>the past, each release has taken at least two weeks to test, and then<br/>another week to fix and bundle&#8230;if I was lucky.  And for the past<br/>couple of years, I just haven&#8217;t been able to justify the time<br/>expenditure.  (Besides this, there are still a few serious problems<br/>with the fonts&#8211;once again, a matter of time.)</p><p>Have a look at the bugs pages, to get an idea of work being done.</p><footer><strong>Steve White</strong> <cite>GNU FreeFont</cite></footer></blockquote>


<p><a href="http://savannah.gnu.org/bugs/?group=freefont">http://savannah.gnu.org/bugs/?group=freefont</a></p>

<p>I&#8217;m not sure if ImageMagic or PIL can help solve the rendering and compare
problem Steve is talking about. They can definitely be used for
<a href="/blog/2013/05/17/linux-and-python-tools-to-compare-images/">image comparison</a>
so maybe coupled with some rendering library it&#8217;s worth a quick try.</p>

<p>If you happen to know more about fonts, please join me in
<a href="/blog/2014/02/28/action-improving-test-coverage-in-fedora/">improving overall test coverage in Fedora</a>
by designing test suites for fonts packages.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/03/last-week-in-fedora-qa/">Last Week in Fedora QA</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-03T10:23:00+02:00" pubdate data-updated="true">Mar 3<span>rd</span>, 2014</time>
        
         | <a href="/blog/2014/03/03/last-week-in-fedora-qa/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Here are some highlights from the past week discussions in Fedora which I found
interesting or participated in.</p>

<h2>Call to Action: Improving Overall Test Coverage in Fedora</h2>

<p>I can not stress enough how important it is to further
<a href="/blog/2014/02/28/action-improving-test-coverage-in-fedora/">improve test coverage in Fedora</a>!
You can help too. Here&#8217;s how:</p>

<ul>
<li>Join upstream and create a test suite for a package you find interesting;</li>
<li>Provide patches - <a href="https://lists.fedoraproject.org/pipermail/devel/2014-February/196035.html">first patch</a>
came in less than 30 minutes of initial announcement :);</li>
<li>Review packages in the wiki and help identify false negatives;</li>
<li>Forward to people who may be interested to work on these items;</li>
<li>Share and promote in your local open source and developer communities;</li>
</ul>


<h2>Auto BuildRequires</h2>

<p><a href="http://people.redhat.com/~rjones/auto-buildrequires/">Auto-BuildRequires</a>
is a simple set of scripts which compliments <code>rpmbuild</code> by
automatically suggesting BuildRequires lines for the just built package.</p>

<p>It would be interesting to have this integrated into Koji and/or
continuous integration environment and compare the output between every two
consecutive builds (iow older and newer package versions). It sounds like a
good way to identify newly added or removed dependencies and update the package
specs accordingly.</p>

<h2>How To Test Fonts Packages</h2>

<p>This is exactly what
<a href="https://lists.fedoraproject.org/pipermail/test/2014-February/120570.html">Christopher Meng asked</a>
and frankly I have no idea.</p>

<p>I&#8217;ve come across a few fonts packages (<em>amiri-fonts</em>, <em>gnu-free-fonts</em> and <em>thai-scalable-fonts</em>)
which seem to have some sort of test suites but I don&#8217;t know how they work or
what type of problems they test for. On top of that all three have a different
way of doing things (e.g. not using a standardized test framework or a variation of such).</p>

<p>I&#8217;ll keep you posted on this once I manage to get more info from upstream developers.</p>

<h2>Is URL Field in RPM Useless</h2>

<p>So is it? Opinions here differ from totally useless to &#8220;don&#8217;t remove it, I need it&#8221;.
However I run a small test and from 2574 RPMs on the source DVD there is around
40% of &#8220;something different than HTTP 200 OK&#8221;. This means <strong>40% potentially broken URLs</strong>!</p>

<p>The majority are responses in the 3XX range and only less than 10% are
actual errors (4XX, 5XX, missing URLs or connection errors).</p>

<p>It will be interesting to see if this can be removed from <code>rpm</code> altogether.
I don&#8217;t think it will happen soon but if we don&#8217;t use it why have it there?</p>

<p>My script for the test is
<a href="https://github.com/atodorov/fedora-scripts/blob/master/test-rpm-url-field.sh">here</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/28/action-improving-test-coverage-in-fedora/">Call to Action: Improving Overall Test Coverage in Fedora</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-28T14:46:00+02:00" pubdate data-updated="true">Feb 28<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/02/28/action-improving-test-coverage-in-fedora/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Around Christmas 2013
<a href="/blog/2013/12/24/upstream-test-suite-status-of-fedora-20/">I said</a></p>

<blockquote><p>&#8230; it looks like on average 30% of the packages execute their test suites at<br/>build time in the %check section and less than 35% have test suites at all!<br/>Theres definitely room for improvement and I plan to focus on this during 2014!</p></blockquote>


<p>I&#8217;ve recently started working on this goal by first identifying potential offending
packages and discussing the idea on Fedora&#8217;s
<a href="https://lists.fedoraproject.org/pipermail/devel/2014-February/thread.html">devel</a>,
<a href="https://lists.fedoraproject.org/pipermail/packaging/2014-February/thread.html">packaging</a>
and <a href="https://lists.fedoraproject.org/pipermail/test/2014-February/thread.html">test</a>
mailing lists.</p>

<p>May I present you nearly <strong>2000 packages</strong> which need your love:</p>

<ul>
<li><a href="https://fedoraproject.org/wiki/QA/Testing_in_check">wiki/QA/Testing_in_check</a></li>
<li><a href="https://fedoraproject.org/wiki/QA/Missing_upstream_test_suites">wiki/QA/Missing_upstream_test_suites</a></li>
</ul>


<p>The intent for these pages is to serve as a source of working material for Fedora
volunteers.</p>

<h2>How Can I Help</h2>

<ul>
<li>Join upstream and create a test suite for a package you find interesting;</li>
<li>Provide patches - <a href="https://lists.fedoraproject.org/pipermail/devel/2014-February/196035.html">first patch</a>
came in less than 30 minutes of initial announcement :);</li>
<li>Review packages in the wiki and help identify false negatives;</li>
<li>Forward to people who may be interested to work on these items;</li>
<li>Share and promote in your local open source and developer communities;</li>
</ul>


<h2>Important</h2>

<p>If you would like to gain some open source practice and QA experience I will
happily provide mentorship and general help so you can start working on Fedora.
Just ping me!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/27/mocking-django-auth-profile-module-without-database/">Mocking Django AUTH_PROFILE_MODULE Without a Database</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-27T16:18:00+02:00" pubdate data-updated="true">Feb 27<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/02/27/mocking-django-auth-profile-module-without-database/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://www.dif.io">Difio</a> is a Django based service which uses a profile
model to provide site-specific, per-user information.
In the process of <a href="https://github.com/difio/difio">open sourcing Difio</a> its core
functionality becomes available as a Django app. The trouble is that the
<code>UserProfile</code> model contains site-specific and proprietary data which doesn&#8217;t
make sense to the public nor I want to release it.</p>

<p>The solution is to have a <code>MockProfile</code> model and work with
that by default while <a href="http://www.dif.io">www.dif.io</a> and other implementations
override it as needed.
<strong>How do you do that without creating useless table and records in the database
but still have the profiles created automatically for every user?</strong></p>

<p>It turns out the solution is quite simple. See my comments inside the code below.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">class</span> <span class="nc">AbstractMockProfile</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&quot;&quot;&quot;</span>
</span><span class='line'><span class="sd">        Any AUTH_PROFILE_MODULE model should inherit this</span>
</span><span class='line'><span class="sd">        and override the default methods.</span>
</span><span class='line'>
</span><span class='line'><span class="sd">        This model provides the FK to User!</span>
</span><span class='line'><span class="sd">    &quot;&quot;&quot;</span>
</span><span class='line'>    <span class="n">user</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">is_subscribed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class='line'>        <span class="sd">&quot;&quot;&quot; Is this user subscribed for our newsletter? &quot;&quot;&quot;</span>
</span><span class='line'>        <span class="k">return</span> <span class="bp">True</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span class='line'>        <span class="c"># no DB table created b/c model is abstract</span>
</span><span class='line'>        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">MockProfileManager</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Manager</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&quot;&quot;&quot;</span>
</span><span class='line'><span class="sd">        This manager creates MockProfile&#39;s on the fly without</span>
</span><span class='line'><span class="sd">        touching the database. It is needed by User.get_profile()</span>
</span><span class='line'><span class="sd">        b/c we can&#39;t have an abstract base class as AUTH_PROFILE_MODULE.</span>
</span><span class='line'><span class="sd">    &quot;&quot;&quot;</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">using</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span class='line'>        <span class="sd">&quot;&quot;&quot; It doesn&#39;t matter which database we use! &quot;&quot;&quot;</span>
</span><span class='line'>        <span class="k">return</span> <span class="bp">self</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span class='line'>        <span class="sd">&quot;&quot;&quot;</span>
</span><span class='line'><span class="sd">            User.get_profile() calls .using(...).get(user_id__exact=X)</span>
</span><span class='line'><span class="sd">            so we instrument it here to return a MockProfile() with</span>
</span><span class='line'><span class="sd">            user_id=X parameter. Anything else may break!!!</span>
</span><span class='line'><span class="sd">        &quot;&quot;&quot;</span>
</span><span class='line'>        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span class='line'>            <span class="n">params</span><span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;__&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>        <span class="c"># this creates an object in memory. To save it to DB</span>
</span><span class='line'>        <span class="c"># call obj.save() which we DON&#39;T do anyway!</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">MockProfile</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">MockProfile</span><span class="p">(</span><span class="n">AbstractMockProfile</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&quot;&quot;&quot;</span>
</span><span class='line'><span class="sd">        In-memory (fake) profile class used by default for</span>
</span><span class='line'><span class="sd">        the AUTH_PROFILE_MODULE setting.</span>
</span><span class='line'><span class="sd">    &quot;&quot;&quot;</span>
</span><span class='line'>    <span class="n">objects</span> <span class="o">=</span> <span class="n">MockProfileManager</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span class='line'>        <span class="c"># DB table is NOT created automatically</span>
</span><span class='line'>        <span class="c"># when managed = False</span>
</span><span class='line'>        <span class="n">managed</span> <span class="o">=</span> <span class="bp">False</span>
</span></code></pre></td></tr></table></div></figure>


<p>In Difio core the user profile is always used like this</p>

<pre><code>profile = request.user.get_profile()
if profile.is_subscribed():
    pass
</code></pre>

<p>and by default</p>

<pre><code>AUTH_PROFILE_MODULE = "difio.MockProfile"
</code></pre>

<p>Voila!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/21/skip-or-render-specific-blocks-from-jinja2-templates/">Skip or Render Specific Blocks From Jinja2 Templates</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-21T00:08:00+02:00" pubdate data-updated="true">Feb 21<span>st</span>, 2014</time>
        
         | <a href="/blog/2014/02/21/skip-or-render-specific-blocks-from-jinja2-templates/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I wasn&#8217;t able to find detailed information on how to skip rendering
or only render specific blocks from Jinja2 templates so here&#8217;s my solution.
Hopefully you find it useful too.</p>

<p>With below template I want to be able to render <strong>only</strong> <em>kernel_options</em> block
as a single line and then render the rest of the template <strong>excluding</strong> <em>kernel_options</em>.</p>

<figure class='code'><figcaption><span>base.j2 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='jinja'><span class='line'><span class="cp">{%</span> <span class="k">block</span> <span class="nv">kernel_options</span> <span class="cp">%}</span><span class="x"></span>
</span><span class='line'><span class="x">console=tty0</span>
</span><span class='line'><span class="x">    </span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">debug</span> <span class="cp">%}</span><span class="x"></span>
</span><span class='line'><span class="x">        debug=1</span>
</span><span class='line'><span class="x">    </span><span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x"></span>
</span><span class='line'><span class="cp">{%</span> <span class="k">endblock</span> <span class="nv">kernel_options</span> <span class="cp">%}</span><span class="x"></span>
</span><span class='line'>
</span><span class='line'><span class="cp">{%</span> <span class="k">if</span> <span class="nv">OS_MAJOR</span> <span class="o">==</span> <span class="m">5</span> <span class="cp">%}</span><span class="x"></span>
</span><span class='line'><span class="x">key --skip</span>
</span><span class='line'><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
</span><span class='line'>
</span><span class='line'><span class="x">%packages</span>
</span><span class='line'><span class="x">@base</span>
</span><span class='line'><span class="cp">{%</span> <span class="k">if</span> <span class="nv">OS_MAJOR</span> <span class="o">&gt;</span> <span class="m">5</span> <span class="cp">%}</span><span class="x"></span>
</span><span class='line'><span class="x">%end</span>
</span><span class='line'><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>


<p>To render a particular block you have to use the low level Jinja API
<em><a href="http://jinja.pocoo.org/docs/api/#jinja2.Template.blocks">template.blocks</a></em>.
This will return a dict of block rendering functions which need a <em>Context</em> to work with.</p>

<p>The second part is trickier. To remove a block we have to create an extension
which will filter it out. The provided <em>SkipBlockExtension</em> class does
exactly this.</p>

<p>Last but not least - if you&#8217;d like to use both together you have to disable
caching in the <em>Environment</em> (so you get a fresh template every time), render
your blocks first, configure <em>env.skip_blocks</em> and render the entire template
without the specified blocks.</p>

<figure class='code'><figcaption><span>jinja2-render </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#!/usr/bin/env python</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">os</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">jinja2.ext</span> <span class="kn">import</span> <span class="n">Extension</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">jinja2</span> <span class="kn">import</span> <span class="n">Environment</span><span class="p">,</span> <span class="n">FileSystemLoader</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">SkipBlockExtension</span><span class="p">(</span><span class="n">Extension</span><span class="p">):</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">environment</span><span class="p">):</span>
</span><span class='line'>        <span class="nb">super</span><span class="p">(</span><span class="n">SkipBlockExtension</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
</span><span class='line'>        <span class="n">environment</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">skip_blocks</span><span class="o">=</span><span class="p">[])</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">filter_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>
</span><span class='line'>        <span class="n">block_level</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>        <span class="n">skip_level</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>        <span class="n">in_endblock</span> <span class="o">=</span> <span class="bp">False</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s">&#39;block_begin&#39;</span><span class="p">):</span>
</span><span class='line'>                <span class="k">if</span> <span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s">&#39;block&#39;</span><span class="p">):</span>
</span><span class='line'>                    <span class="n">block_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>                    <span class="k">if</span> <span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">look</span><span class="p">()</span><span class="o">.</span><span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">skip_blocks</span><span class="p">):</span>
</span><span class='line'>                        <span class="n">skip_level</span> <span class="o">=</span> <span class="n">block_level</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s">&#39;endblock&#39;</span> <span class="p">):</span>
</span><span class='line'>                <span class="n">in_endblock</span> <span class="o">=</span> <span class="bp">True</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">if</span> <span class="n">skip_level</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span class='line'>                <span class="k">yield</span> <span class="n">token</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s">&#39;block_end&#39;</span><span class="p">):</span>
</span><span class='line'>                <span class="k">if</span> <span class="n">in_endblock</span><span class="p">:</span>
</span><span class='line'>                    <span class="n">in_endblock</span> <span class="o">=</span> <span class="bp">False</span>
</span><span class='line'>                    <span class="n">block_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span class='line'>
</span><span class='line'>                    <span class="k">if</span> <span class="n">skip_level</span> <span class="o">==</span> <span class="n">block_level</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
</span><span class='line'>                        <span class="n">skip_level</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
</span><span class='line'>    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;OS_MAJOR&#39;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;ARCH&#39;</span> <span class="p">:</span> <span class="s">&#39;x86_64&#39;</span><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">abs_path</span>  <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span class='line'>    <span class="n">dir_name</span>  <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">abs_path</span><span class="p">)</span>
</span><span class='line'>    <span class="n">base_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">abs_path</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span>
</span><span class='line'>                <span class="n">loader</span> <span class="o">=</span> <span class="n">FileSystemLoader</span><span class="p">(</span><span class="n">dir_name</span><span class="p">),</span>
</span><span class='line'>                <span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span><span class="n">SkipBlockExtension</span><span class="p">],</span>
</span><span class='line'>                <span class="n">cache_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c"># disable cache b/c we do 2 get_template()</span>
</span><span class='line'>            <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># first render only the block we want</span>
</span><span class='line'>    <span class="n">template</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="n">base_name</span><span class="p">)</span>
</span><span class='line'>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">template</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s">&#39;kernel_options&#39;</span><span class="p">](</span><span class="n">template</span><span class="o">.</span><span class="n">new_context</span><span class="p">(</span><span class="n">context</span><span class="p">)):</span>
</span><span class='line'>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;Boot Args:&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;---------------------------&quot;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># now instruct SkipBlockExtension which blocks we don&#39;t want</span>
</span><span class='line'>    <span class="c"># and get a new instance of the template with these blocks removed</span>
</span><span class='line'>    <span class="n">env</span><span class="o">.</span><span class="n">skip_blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;kernel_options&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">template</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="n">base_name</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;---------------------------&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The above code results in the following output:</p>

<pre><code>$ ./jinja2-render ./base.j2 
Boot Args: console=tty0 debug=1 
---------------------------

key --skip

%packages
@base
---------------------------
</code></pre>

<p>Teaser: this is part of my effort to replace SNAKE with a client side
kickstart template engine for
<a href="/blog/2013/11/19/open-source-quality-assurance-infrastructure-for-fedora-qa/">Beaker</a>
so stay tuned!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/19/7-years-1400-bugs-red-hat-qa/">7 Years and 1400 Bugs Later as Red Hat QA</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-19T10:43:00+02:00" pubdate data-updated="true">Feb 19<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/02/19/7-years-1400-bugs-red-hat-qa/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Today I celebrate my 7th year working at Red Hat&#8217;s Quality Engineering department.
Here&#8217;s my story!</p>

<p><img src="/images/redhat_platform_qe.jpg" title="Platform QE" alt="Platform QE" /></p>

<p>On a cold winter Friday in 2007 I left my job as a software developer in Sofia,
packed my stuff together, purchased my <a href="http://amzn.to/1hlPuyr">first laptop</a> and
on Sunday jumped the train to Brno to join the Release Test Team at Red Hat.
Little did I know what it was all about. When I was offered the position
I was on a very noisy bus and had to pick between two positions. I didn&#8217;t quite understood
what were the options and just picked the second one.
Luckily everything turned out great and continues to this day.</p>

<p>I&#8217;m sharing my experience and highlighting some bugs which I&#8217;ve found.
Hopefully you will find this interesting and amusing. If you are a QA engineer
I urge you to take a look at <a href="http://red.ht/1gbHElQ">my public bug portfolio</a>,
dive into details, read the comments and learn as much as you can.</p>

<h2>What do I do exactly</h2>

<p>From all QE teams in Red Hat, Release Test Team is the first one and
last one to test a release. The team has both technical function and a more managerial one.
Our focus is on the core Red Hat Enterprise Linux product.
Unfortunately I can&#8217;t go into much details because this is not a public facing unit.
I will limit myself to <strong>public and/or non-sensitive information</strong>.</p>

<p>We are the first to test a new nightly build or a
snapshot of the upcoming RHEL release. If the tree is installable other teams take over
and do their magic. At the end when bits are published live we&#8217;re the last to
verify that content is published where it is expected to be. In short this is
covering the work of the release engineering team which is to build a product and
publish the contents for consumption.</p>

<p>The same principles apply to Fedora although the engagement here is less demanding.</p>

<p>Personally I have been and continue to be responsible for Red Hat Enterprise Linux 5
family of releases. It&#8217;s up to me to give the go ahead for further testing or request
a re-spin. This position
also has the power to block and delay the GA release if not happy with testing or
there is a considerable risk of failure until things are sorted out.</p>

<p>Like in other QA teams I create test plan documents, write test case scenarios,
implement test automation scripts (and sometimes tools), regularly execute said test
plans and test cases, find and report any new bugs and verify old ones are fixed.
Most importantly make sure RHEL installs and is usable for further testing :).</p>

<p>Sometimes I have to deal with capacity planning and as RHEL 5 installation
test lead I have to organize and manage the entire installation testing campaign
for that product.</p>

<p>My favorite testing technique is
<a href="https://en.wikipedia.org/wiki/Exploratory_testing">exploratory testing</a>.</p>

<h2>Stats and Numbers</h2>

<p>It is hard (if not impossible) to <a href="https://github.com/atodorov/qe-metrics">measure QA work</a>
with numbers alone but here are some interesting facts about my experience so far.</p>

<ul>
<li>Nearly 1400 bugs filed (1390 at the time of writing);</li>
<li>Reported bugs across 32 different products. Top 3 being RHEL 6, RHEL 5 and Fedora (1000+ bugs);</li>
<li>Top 3 components for reporting bugs against: anaconda, releng, kernel;</li>
<li>Nearly 100 bugs filed in my first year 2007;</li>
<li>The 3 most productive years being 2010, 2009, 2011 (800 + bugs);</li>
<li>Filed 200 bugs/year which is about 1 bug/day considering holidays;</li>
<li>35th top bug reporter (excluding robot accounts). I was in top 10 a few years back;</li>
</ul>


<p>Many of <a href="http://red.ht/1gbHElQ">the bugs I report</a> are private so if you&#8217;d like
to know more stats just ask me and I&#8217;ll see what I can do.</p>

<h2>2007</h2>

<p>My very first bug is <a href="https://bugzilla.redhat.com/show_bug.cgi?id=231860">RHBZ #231860</a>(private)
which is about the graphical update tool Pup which used to show the wrong number of available
updates.</p>

<p>Then I&#8217;ve played with adding <a href="https://fedorahosted.org/dogtail/">Dogtail</a> support to Anaconda.
While initially this was rejected (Fedora 6/7), it was <a href="https://fedoraproject.org/wiki/Anaconda/Features/Dogtail">implemented</a>
few years later (Fedora 9) and then removed once again during the big Anaconda rewrite.</p>

<p>I&#8217;ve spent my time working extensively on RHEL 5 battling with multi-lib issues, SELinux denials and
generally making the 5 family less rough. Because I was still on-boarding I generally worked
on everything I could get my hands on and also did some work on RHEL3-U9 (latest release
before EOL) and some RHEL4-U6 testing.</p>

<p>With ia64 on RHEL3 I found a corner case
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=240782">kernel bug</a> which flooded the serial
console with messages and caused a multi-CPU system to freeze.</p>

<h2>In 2008 Time went backwards</h2>

<p>My first bug in 2008 is <a href="https://bugzilla.redhat.com/show_bug.cgi?id=428280">RHBZ #428280</a>.
glibc introduced SHA-256/512 hashes for hashing passwords with crypt but that wasn&#8217;t documented.</p>

<p><strong>UPDATE 2014-02-21</strong>
While testing 5.1 to 5.2 updates I found
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=435475">RHBZ #435475</a> - a severe
<strong>performance degradation</strong> in the package installation process. Upgrades
took almost twice as much time to complete, rising <strong>from 4 hours to 7 hours</strong>
depending on hardware and package set. This was a tough one to test and verify.
<strong>END UPDATE</strong></p>

<p>While dogfooding the 5.2 beta in March I hit
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=437252">RHBZ #437252</a> - kernel: Timer ISR/0: Time went backwards.
To this date this is one of my favorite bugs with a great error message!</p>

<p>Removal of a hack in RPM led to file conflicts under <code>/usr/share/doc</code> in several packages:
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=448905">RHBZ #448905</a>,
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=448906">RHBZ #448906</a>,
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=448907">RHBZ #448907</a>,
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=448909">RHBZ #448909</a>,
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=448910">RHBZ #448910</a>,
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=448911">RHBZ #448911</a>
which is also the first time I happen to file several bugs in a row.</p>

<p>ia64 couldn&#8217;t boot with encrypted partitions -
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=464769">RHBZ #464769</a>,
RHEL 5 introduced support for ext4 - <a href="https://bugzilla.redhat.com/show_bug.cgi?id=465248">RHBZ #465248</a>
and I&#8217;ve hit a fontconfig issue during upgrades - <a href="https://bugzilla.redhat.com/show_bug.cgi?id=469190">RHBZ #469190</a>
which continued to resurface occasionally during the next 5 years.</p>

<p>This is the year when I took over responsibility for the general installation
testing of RHEL 5 from James Laska and will continue to do so until it reaches end-of-life!</p>

<p>I&#8217;ve also worked on RHEL 4, Fedora and even the OLPC project. On the testing side of things
I&#8217;ve participated in testing
<a href="https://fedoraproject.org/wiki/QA/TestPlans/Networking">Fedora networking on the XO</a>
hardware and worked on translation and general issues.</p>

<h2>2009 - here comes RHEL 6</h2>

<p>This year starts my 3 most productive years period.</p>

<p>The second bug reported this
year is <a href="https://bugzilla.redhat.com/show_bug.cgi?id=481338">RHBZ #481338</a> which
also mentions one of my hobbies - wrist watches. While browsing a particular
website Xorg CPU usage rose to 100%. I&#8217;ve seen a number of these through the years
and I&#8217;m still not sure if its Xorg or Firefox or both to blame. And I still see my
CPU usage go to 100% just like that and drain my battery. I&#8217;m open to suggestions how
to test and debug what&#8217;s going on as it doesn&#8217;t happen in a reproducible fashion.</p>

<p>I happened to work on RHEL 4, RHEL 5, Fedora and the upcoming RHEL 6 releases and
managed to file bugs in a row not once but twice.
I wish I was paid per bug reported back then :).</p>

<p>The first series was about empty debuginfo packages with both empty packages which
shouldn&#8217;t have existed at all
(e.g. <a href="https://bugzilla.redhat.com/show_bug.cgi?id=500628">redhat-release</a>)
and missing debuginfo information for binary packages
(e.g. <a href="https://bugzilla.redhat.com/show_bug.cgi?id=500612">nmap</a>).</p>

<p>The second series is around 100 bugs which had to do with the texinfo
documentation of packages when installed with &#8211;excludedocs. The first one
is <a href="https://bugzilla.redhat.com/show_bug.cgi?id=515909">RHBZ #515909</a> and the
last one <a href="https://bugzilla.redhat.com/show_bug.cgi?id=516014">RHBZ #516014</a>.
While this works great for bumping up your bug count it made lots of developers
unhappy and not all bugs were fixed. Still the use case is valid and these
were proper software errors. It is also the first time I&#8217;ve used a script to
file the bugs automatically and not by hand.</p>

<p>Near the end of the year I&#8217;ve started testing installation on new hardware
by the likes of Intel and AMD before they hit the market. I had the pleasure to work
with the latest chipsets and CPUs, even sometime pre-release versions and make sure
Red Hat Enterprise Linux installed and worked properly on them. I&#8217;ve stopped doing
this last year to free up time for other tasks.</p>

<h2>2010 - one bug a day keeps developers at bay :)</h2>

<p>My most productive year with 1+ bugs per day.</p>

<p>2010 starts with a bug about file conflicts (private one) and continues with the same
narrative throughout the year.
As a matter of fact I did a small experiment and found around <strong>50000</strong>
(you read that right, fifty thousand) potentially
conflicting files, mostly between multi-lib packages, which were being ignored by RPM
due to its multi-lib policies. However these were primarily man pages or documentation
and most of them didn&#8217;t get fixed. The proper fix would have been to introduce a
-docs sub-package and split these files from the actual binaries. Fortunately the world
migrated to 64bit only and this isn&#8217;t an issue anymore.</p>

<p>By that time RHEL 6 development was running at its peak capacity and there were Beta
versions available. Almost the entire year I&#8217;ve been working on internal RHEL 6 snapshots
and discovering the many new bugs introduced with tons of new features in the installer.
Some of the new features included better IPv6 support, dracut and KVM.</p>

<p>An interesting set of bugs from September are the rpmlint errors and warnings ones,
for example <a href="https://bugzilla.redhat.com/show_bug.cgi?id=634931">RHBZ #634931</a>. I just
run the most basic test tool against some packages. It generated lots of false negatives
but also revealed bugs which were fixed.</p>

<p>Although there were many bugs filed this year I don&#8217;t see any particularly interesting ones.
It&#8217;s been more like lots of work to improve the overall quality than exploring
edge cases and finding interesting failures. If you find a bug from this period that you
think is interesting I will comment on it.</p>

<h2>2011 - Your system may be seriously compromised</h2>

<p>This is the last year of my 3 year top cycle.</p>

<p>It starts with <a href="https://bugzilla.redhat.com/show_bug.cgi?id=666687">RHBZ #666687</a> -
a patch for my crappy printer-scanner-coffee maker which I&#8217;ve been carrying around
since <a href="https://bugzilla.redhat.com/show_bug.cgi?id=498228">2009</a> when I bought it.</p>

<p>I was still working primarily on RHEL 6 but helped test the latest RHEL 4 release
before it went end-of-life. The interesting thing about it was that unlike other
released RHEL4-U9 was not available on installation media but only as an update from
RHEL4-U8. This was a great experience which you happen to see
<a href="https://access.redhat.com/site/support/policy/updates/errata/">every 4 to 5 years</a> or so.</p>

<p>Btw I&#8217;ve also led the installation testing effort and RTT team through the last few
RHEL 4 releases but given the product was approaching EOL there weren&#8217;t many changes
and things went smoothly.</p>

<p>A minor side activity was me playing around with
<a href="/blog/2011/03/14/usb-multi-seat-on-red-hat-enterprise-linux-6/">USB Multi-seat</a>
and finding a few bugs here and there along the way.</p>

<p>Another interesting activity in 2011 was proof-reading the entire product documentation
before its release which I can now relate to the
<a href="/blog/2014/02/03/fosdem-2014-report-day-2-testing-and-automation/">Testing Documentation</a>
talk at FOSDEM 2014.</p>

<p>In 2011 I&#8217;ve started using the cloud and most notably Red Hat&#8217;s OpenShift PaaS service.
First internally as an early adopter and later externally after the product was announced
to the public. There are a few interesting bugs here but they are private and I&#8217;m not
at liberty to share although they&#8217;ve all been fixed since then.</p>

<p>An interesting bug with NUMA, Xen and ia64
(<a href="https://bugzilla.redhat.com/show_bug.cgi?id=696599">RHBZ #696599</a> - private) had
me and devel banging our heads against the wall until we figured out that on this
particular system the NUMA configuration was not suitable for running Xen virtualization.</p>

<p>Can you spot the problem here ?</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">try</span><span class="p">:</span>
</span><span class='line'>    <span class="kn">import</span> <span class="nn">kickstartGui</span>
</span><span class='line'><span class="k">except</span><span class="p">:</span>
</span><span class='line'>    <span class="k">print</span> <span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Could not open display because no X server is running.&quot;</span><span class="p">))</span>
</span><span class='line'>    <span class="k">print</span> <span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Try running &#39;system-config-kickstart --help&#39; for a list of options.&quot;</span><span class="p">))</span>
</span><span class='line'>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Be honest and use the comments form to tell me what you&#8217;ve found. If you struggled
then see <a href="https://bugzilla.redhat.com/show_bug.cgi?id=703085">RHBZ #703085</a> and come
back again to comment. I&#8217;d love to hear from you.</p>

<p>What do you do when you see an error message saying:
<strong>Your system may be seriously compromised! /usr/sbin/NetworkManager tried to load a kernel module.</strong>
This is the scariest error message I&#8217;ve ever seen. Luckily its just
SELinux overreacting, see <a href="https://bugzilla.redhat.com/show_bug.cgi?id=704090">RHBZ #704090</a>.</p>

<h2>2012 is in the red zone</h2>

<p>While the number of reported bugs dropped significantly compared to previous
years this is the year when I&#8217;ve reported almost exclusively high priority and
urgent bugs, the first one being
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=771901">RHBZ #771901</a>.</p>

<p><a href="https://bugzilla.redhat.com/show_bug.cgi?id=799384">RHBZ #799384</a>(against Fedora)
is one of the rare cases when I was able to contribute
(although just by raising awareness) to localization and improved support for
Bulgarian and Cyrillic.
The other one case was <a href="http://atodorov.org/blog/2013/10/11/fedora-20-gnome-3-dot-10-test-day-post-mortem/">last year</a>.
Btw I find it strange that although
<a href="https://en.wikipedia.org/wiki/Cyrillic_script">Cyrillic was invented by Bulgarians</a>
we didn&#8217;t (or still don&#8217;t) have a native font co-maintainer.
Somebody please step up!</p>

<p>The red zone bugs continue to span till the end of the year across RHEL 5, 6 and
early cuts of RHEL 7 with a pinch of OpenShift and some internal and external test tools.</p>

<h2>In 2013 Bugzilla hit 1 million bugs</h2>

<p>The year starts with a very annoying and still not fixed bug against ABRT.
It&#8217;s very frustrating when the tool which is supposed to help you file bugs
doesn&#8217;t work properly, see <a href="https://bugzilla.redhat.com/show_bug.cgi?id=903591">RHBZ #903591</a>.
It&#8217;s a known fact that
<a href="/2012/07/13/mission-impossible-abrt-bugzilla-plugin-on-rhel6/">ABRT has problems</a>
and for this scenario I may have a
<a href="/blog/2013/10/12/tip-installing-missing-debuginfo-packages-for-abrt/">tip</a> for you.</p>

<p><a href="https://bugzilla.redhat.com/show_bug.cgi?id=923416">RHBZ #923416</a> - another one of these
100% CPU bugs. As I said they happen from time to time and mostly go by unfixed or
partially fixed because of their nature. Btw as I&#8217;m writing this post and have
a few tabs open in Firefox it keeps using between 15% and 20% CPU and the CPU
temperature is over 90 degrees C. And all I&#8217;m doing is writing text in the console.
Help!</p>

<p><a href="https://bugzilla.redhat.com/show_bug.cgi?id=967229">RHBZ #967229</a> - a minor one but
reveals an important thing - your output (and input for that matter) methods may
be producing different results. Worth testing if your software supports more than one.</p>

<p>This year I did some odd jobs working on several of Red Hat&#8217;s layered products mainly
Developer Toolset. It wasn&#8217;t a tough job and was a refreshing break away from the mundane
installation testing.</p>

<p>While I stopped working actively on the various RHEL families which are under development
or still supported I happened to be one of top 10 bug reporters for high/urgent priority bugs
for RHEL 7. In appreciation Red Hat sent me lots of corporate gifts and the Platform QE hoodie
pictured at the top of the page. Many thanks!</p>

<p>In the summer Red Hat&#8217;s
<a href="/blog/2013/08/23/red-hats-bugzilla-hits-one-million-bugs/">Bugzilla hit One Million bugs</a>.
The closest I come to this milestone is
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=999941">RHBZ #999941</a>.</p>

<p>I finally managed to transfer most of my responsibilities to co-workers and joined
the Fedora QA team as a part-time contributor. I had some highs and lows with
<a href="/blog/2013/10/07/fedora-20-virtualization-and-gnome-test-days-at-init-lab-this-week/">Fedora test days in Sofia</a>
as well. Good thing is I scored another 15 bugs across the
<a href="/blog/2013/10/08/fedora-20-virtualization-test-day-post-mortem/">virtualization stack</a>
and <a href="/blog/2013/10/11/fedora-20-gnome-3-dot-10-test-day-post-mortem/">GNOME 3.10</a>.</p>

<p>The year wraps up with another series of identical bugs,
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=1024729">RHBZ #1024729</a> and
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=1025289">RHBZ #1025289</a> for example.
As it <a href="/blog/2013/12/24/upstream-test-suite-status-of-fedora-20/">turned out</a>
lots of packages don&#8217;t have any test suites at all and those
which do don&#8217;t always execute them automatically in %check. I&#8217;ve promised myself
to improve this but still haven&#8217;t had time to work on it. Hopefully by
March I will have something in the works.</p>

<h2>2014 - Fedora QA improvement</h2>

<p>Last two months I&#8217;ve been working on some internal projects and looking
a little bit into improving processes, test coverage and QA infrastructure -
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=1064895">RHBZ #1064895</a>.
And Rawhide (upcoming Fedora 21) isn&#8217;t behaving -
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=1063245">RHBZ #1063245</a>.</p>

<p>My goal for this year is to do more work on improving the overall test coverage
of Fedora and together with the Fedora QA team bring an
<a href="/blog/2013/11/19/open-source-quality-assurance-infrastructure-for-fedora-qa/">open testing infrastructure</a>
to the community.</p>

<p>Let&#8217;s see how well that plays out!</p>

<h2>What do I do now</h2>

<p>During the last year I have gradually changed my responsibilities to work more on Fedora.
As a volunteer in the Fedora QA I&#8217;m regularly testing installation
of Rawhide trees and try to work closely with the community. I still have to
manage RHEL 5 test cycles where I don&#8217;t expect nothing disruptive at this stage in the
product life-cycle!</p>

<p>I&#8217;m open to any ideas and help which can improve test coverage and quality of software
in Fedora. If you&#8217;re just joining the open source world this is an excellent
opportunity to do some good, get noticed and even maybe get a job. I will definitely
help you get through the process if you&#8217;re willing to commit your time to this.</p>

<p>I hope this long post has been useful and fun to read. Please use the comments form to tell
me if I&#8217;m missing something or you&#8217;d like to know more.</p>

<p><em>Looking forward to the next 7 years!</em></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/10/moving-tmp-from-ebs-to-instance-storage/">Moving /tmp From EBS to Instance Storage</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-10T13:48:00+02:00" pubdate data-updated="true">Feb 10<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/02/10/moving-tmp-from-ebs-to-instance-storage/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve seen a fair amount of stories about moving away from Amazon&#8217;s EBS volumes
to ephemeral instance storage. I&#8217;ve decided to give it a try starting with <code>/tmp</code>
directory where <a href="http://www.dif.io">Difio</a> operates.</p>

<p>It should be noted that although instance storage may be available for some instance
types it may not be attached by default. Use this command to check:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl http://169.254.169.254/latest/meta-data/block-device-mapping/
</span><span class='line'>ami
</span><span class='line'>root
</span><span class='line'>swap
</span></code></pre></td></tr></table></div></figure>


<p>In the above example there is no instance storage present.</p>

<p>You can attach one either when launching the EC2 instance or when creating a customized AMI
(instance storage devices are pre-defined in the AMI). When creating an AMI you can attach more ephemeral devices
but they will not available when instance is launched. The maximum number of available
instance storage devices can be found in the
<a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/InstanceStorage.html#StorageOnInstanceTypes">docs</a>.
That is to say if you have an AMI which defines 2 ephemeral devices and launch a
standard m1.small instance there will be only one ephemeral device present.</p>

<p>Also note that for M3 instances, you must specify instance store volumes in the
block device mapping for the instance. When you launch an M3 instance, Amazon ignores
any instance store volumes specified in the block device mapping for the AMI.</p>

<p>As far as I can see the AWS Console doesn&#8217;t indicate if instance storage is attached
or not. For instance with 1 ephemeral volume:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl http://169.254.169.254/latest/meta-data/block-device-mapping/
</span><span class='line'>ami
</span><span class='line'>ephemeral0
</span><span class='line'>root
</span><span class='line'>swap
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>curl http://169.254.169.254/latest/meta-data/block-device-mapping/ephemeral0
</span><span class='line'>sdb
</span></code></pre></td></tr></table></div></figure>


<p>Ephemeral devices can be mounted in <code>/media/ephemeralX/</code>, but not all volumes.
I&#8217;ve found that usually only <code>ephemeral0</code> is mounted automatically.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl http://169.254.169.254/latest/meta-data/block-device-mapping/
</span><span class='line'>ami
</span><span class='line'>ephemeral0
</span><span class='line'>ephemeral1
</span><span class='line'>root
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>ls -l /media/
</span><span class='line'>drwxr-xr-x 3 root root 4096 21   2009 ephemeral0
</span></code></pre></td></tr></table></div></figure>


<p>For Difio I have an init.d script which executes when the system
boots. To enable <code>/tmp</code> on ephemeral storage I just added the following snippet:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">echo</span> <span class="s2">$&quot;Mounting /tmp on ephemeral storage:&quot;</span>
</span><span class='line'><span class="k">for </span>ef in <span class="sb">`</span>curl http://169.254.169.254/latest/meta-data/block-device-mapping/ 2&gt;/dev/null | grep ephemeral<span class="sb">`</span>; <span class="k">do</span>
</span><span class='line'><span class="k">    </span><span class="nv">disk</span><span class="o">=</span><span class="sb">`</span>curl http://169.254.169.254/latest/meta-data/block-device-mapping/<span class="nv">$ef</span> 2&gt;/dev/null<span class="sb">`</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">$&quot;Unmounting /dev/$disk&quot;</span>
</span><span class='line'>    umount /dev/<span class="nv">$disk</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">$&quot;mkfs /dev/$disk&quot;</span>
</span><span class='line'>    mkfs.ext4 -q /dev/<span class="nv">$disk</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">$&quot;Mounting /dev/$disk&quot;</span>
</span><span class='line'>    mount -t ext4 /dev/<span class="nv">$disk</span> /tmp <span class="o">&amp;&amp;</span> chmod 1777 /tmp <span class="o">&amp;&amp;</span> success <span class="o">||</span> failure
</span><span class='line'><span class="k">done</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>NB:</strong> success and failure are from <code>/etc/rc.d/init.d/functions</code>.
If you are using LVM or RAID you need to reconstruct your block devices
accordingly!</p>

<p>If everything goes right I should be able to reduce my AWS costs by saving on
provisioned storage and I/O requests. I&#8217;ll keep you posted on this after a month or two.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/08/articles-week-git-submodules-stopping-spam-without-captcha/">Articles of the Week: Git Submodules and Stopping SPAM Without CAPTCHA</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-08T23:00:00+02:00" pubdate data-updated="true">Feb 8<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/02/08/articles-week-git-submodules-stopping-spam-without-captcha/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Here are two articles which I found very useful and interesting this week:</p>

<p><a href="http://chrisjean.com/2009/04/20/git-submodules-adding-using-removing-and-updating/">Git Submodules: Adding, Using, Removing, Updating</a>
is a clear description of working with git submodules which I had to do recently.
There&#8217;s a huge comments section with more useful info as well.</p>

<p><a href="http://nedbatchelder.com/text/stopbots.html">Stopping spambots with hashes and honeypots</a>
is a very interesting read about non-CAPTCHA techniques to stop SPAM bots from filling forms
and comments on your site. I didn&#8217;t even know these exist but I have to admin this is not my
area of expertise either. The author just scratches the surface of the topic and there are other
methods described in the comments as well. Make sure to read this if you are building forms
or sites with comments.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/07/tip-how-to-build-updates.img-for-fedora/">Tip: How to Build updates.img for Fedora</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-07T11:01:00+02:00" pubdate data-updated="true">Feb 7<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/02/07/tip-how-to-build-updates.img-for-fedora/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Anaconda the Fedora, CentOS and Red Hat Enterprise Linux installer has the
capability to incorporate
<a href="https://fedoraproject.org/wiki/Anaconda/Updates">updates at runtime</a>.
These updates are generally distributed as an <code>updates.img</code> file. Here is how
to easily build one from a working installation tree.</p>

<p>Instead of using the git sources to build an updates.img I prefer using the SRPM
from the tree which I am installing. <strike>This way the resulting updates image will be
more consistent with the anaconda version already available in the tree. And in theory
everything you need to build it should already be available as well.</strike>
<strong>UPDATE 2014-02-08:</strong> You can also build the <code>updates.img</code> from the git source tree
which is shown at the bottom of this article.</p>

<p>The following steps work for me on a Fedora 20 system.</p>

<ul>
<li>Download the source RPM for anaconda from the tree and extract the sources to a working
directory. Then;</li>
</ul>


<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd </span>anaconda-20.25.16-1
</span><span class='line'>git init
</span><span class='line'>git add .
</span><span class='line'>git commit -m <span class="s2">&quot;initial import&quot;</span>
</span><span class='line'>git tag anaconda-20.25.16-1
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>The above steps will create a local git repository and tag the initial contents before
modification. The tag is required later by the script which creates the updates image;</p></li>
<li><p>After making your changes commit them and from the top anaconda directory execute:</p></li>
</ul>


<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>./scripts/makeupdates -t anaconda-20.25.16-1
</span></code></pre></td></tr></table></div></figure>


<p>You can also add RPM contents to the updates.img but you need to download the packages first:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>yumdownloader python-coverage python-setuptools
</span><span class='line'>
</span><span class='line'>./scripts/makeupdates -t anaconda-20.25.16-1 -a ~/python-coverage-3.7-1.fc20.x86_64.rpm -a ~/python-setuptools-1.4.2-1.fc20.noarch.rpm
</span><span class='line'>BUILDDIR /home/atodorov/anaconda-20.25.16-1
</span><span class='line'>Including anaconda
</span><span class='line'>2 RPMs added manually:
</span><span class='line'>python-setuptools-1.4.2-1.fc20.noarch.rpm
</span><span class='line'>python-coverage-3.7-1.fc20.x86_64.rpm
</span><span class='line'><span class="nb">cd</span> /home/atodorov/anaconda-20.25.16-1/updates <span class="o">&amp;&amp;</span> rpm2cpio /home/atodorov/python-setuptools-1.4.2-1.fc20.noarch.rpm | cpio -dium
</span><span class='line'>3534 blocks
</span><span class='line'><span class="nb">cd</span> /home/atodorov/anaconda-20.25.16-1/updates <span class="o">&amp;&amp;</span> rpm2cpio /home/atodorov/python-coverage-3.7-1.fc20.x86_64.rpm | cpio -dium
</span><span class='line'>1214 blocks
</span><span class='line'>&lt;stdin&gt; to &lt;stdout&gt; 4831 blocks
</span><span class='line'>
</span><span class='line'>updates.img ready
</span></code></pre></td></tr></table></div></figure>


<p>In the above example I have only modified the top level anaconda file (<code>/usr/sbin/anaconda</code>
inside the installation environment) experimenting with
<a href="http://nedbatchelder.com/code/coverage/">python-coverage</a> integration.</p>

<p>You are done! Make the <code>updates.img</code> available to Anaconda and start using it!</p>

<p><strong>UPDATE 2014-02-08:</strong> If you prefer working with the anaconda source tree here&#8217;s
how to do it:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>git clone git://git.fedorahosted.org/git/anaconda.git
</span><span class='line'><span class="nb">cd </span>anaconda/
</span><span class='line'>git checkout anaconda-20.25.16-1 -b my_feature-branch
</span><span class='line'>
</span><span class='line'>... make changes ...
</span><span class='line'>
</span><span class='line'>git commit -a -m <span class="s2">&quot;Fixed something&quot;</span>
</span><span class='line'>
</span><span class='line'>./scripts/makeupdates -t anaconda-20.25.16-1
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/07/aws-tip-shrinking-ebs-root-volume-size/">AWS Tip: Shrinking EBS Root Volume Size</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-07T00:23:00+02:00" pubdate data-updated="true">Feb 7<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/02/07/aws-tip-shrinking-ebs-root-volume-size/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Amazon&#8217;s Elastic Block Store volumes are easy to use and expand but notoriously
hard to shrink once their size has grown. Here is my tip for shrinking EBS size
and saving some money from over-provisioned storage. I&#8217;m assuming that you want to
shrink the root volume which is on EBS.</p>

<ul>
<li>Write down the block device name for the root volume (/dev/sda1) - <em>from AWS console:
Instances; Select instance; Look at Details tab; See Root device or Block devices</em>;</li>
<li>Write down the availability zone of your instance - <em>from AWS console: Instances;
column Availability Zone</em>;</li>
<li>Stop instance;</li>
<li>Create snapshot of the root volume;</li>
<li>From the snapshot, create a second volume, in the <strong>same availability zone</strong> as
your instance (you will have to attach it later). This will be your pristine source;</li>
<li>Create new empty EBS volume (not based on a snapshot), with smaller size,
in the same availability zone - <em>from AWS console: Volumes; Create Volume;
Snapshot == No Snapshot</em>; <strong>IMPORTANT</strong> - size should be large enough to hold
all the files from the source file system (try <code>df -h</code> on the source first);</li>
<li>Attach both volumes to instance while taking note of the block devices names
you assign for them in the AWS console;</li>
</ul>


<p>For example: In my case <code>/dev/sdc1</code> is the source snapshot and <code>/dev/sdd1</code> is the
empty target.</p>

<ul>
<li>Start instance;</li>
<li>Optionally check the source file system with <code>e2fsck -f /dev/sdc1</code>;</li>
<li>Create a file system for the empty volume - <code>mkfs.ext4 /dev/sdd1</code>;</li>
<li>Mount volumes at <code>/source</code> and <code>/target</code> respectively;</li>
<li>Now sync the files: <code>rsync -aHAXxSP /source/ /target</code>. <strong>Note the missing slash (/)
after <code>/target</code></strong>. If you add it you will end up with files inside <code>/target/source/</code>
which you don&#8217;t want;</li>
<li>Quickly verify the new directory structure with <code>ls -l /target</code>;</li>
<li>Unmount <code>/target</code>;</li>
<li>Optionally check the new file system for consistency <code>e2fsck -f /dev/sdd1</code>;</li>
<li><strong>IMPORTANT</strong> - check how <code>/boot/grub/grub.conf</code> specifies the root volume -
by UUID, by LABEL, by device name, etc. You will have to duplicate the same for the
new smaller volume or update <code>/target/boot/grub/grub.conf</code> to match the new volume.
Check <code>/target/etc/fstab</code> as well!</li>
</ul>


<p>In my case I had to <code>e2label /dev/sdd1 /</code> because both <code>grub.conf</code> and <code>fstab</code> were
using the device label.</p>

<ul>
<li>Shutdown the instance;</li>
<li>Detach all volumes;</li>
<li><strong>IMPORTANT</strong> - attach the new smaller volume to the instance using the same block device
name from the first step (e.g. <code>/dev/sda1</code>);</li>
<li>Start the instance and verify it is working correctly;</li>
<li>DELETE auxiliary volumes and snapshots so they don&#8217;t take space and accumulate costs!</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/03/fosdem-2014-report-day-2-testing-and-automation/">FOSDEM 2014 Report - Day #2 Testing and Automation</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-03T22:54:00+02:00" pubdate data-updated="true">Feb 3<span>rd</span>, 2014</time>
        
         | <a href="/blog/2014/02/03/fosdem-2014-report-day-2-testing-and-automation/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/fosdem/2014/testing_automation.jpg" title="Testing and Automation" alt="Testing and Automation" /></p>

<p>FOSDEM was hosting the
<a href="https://fosdem.org/2014/schedule/track/testing_and_automation/">Testing and automation devroom</a>
for the second year and this was the very reason I attended the conference. I managed to get in
early and stayed until 15:00 when I had to leave to catch my flight (which was late :().</p>

<p>There were 3 talks given by Red Hat employees in the testing devroom which was a nice opportunity
to meet some of the folks I&#8217;ve been working on IRC with. Unfortunately I didn&#8217;t meet anyone from
Fedora QA. Not sure if they were attending or not.</p>

<p>All the talks were interesting so see the official schedule and video for more details. I will
highlight only the items I saw as particularly interesting or have not heard of before.</p>

<h2>ANSTE</h2>

<p>ANSTE - Advanced Network Service Testing Environment is a test infrastructure controller,
something like our own <a href="http://beaker-project.org/">Beaker</a> but designed to create complex
networking environments. I think it lacks many of the provisioning features built in Beaker
and integration with various hypervisors and bare-metal provisioning. What it seems to do better
(as far as I can tell from the talk) is to deploy virtual systems and create more complex network
configuration between them. Not something I will need in the near future but definitely worth
a look at.</p>

<h2>cwrap</h2>

<blockquote><p>cwrap is&#8230;</p><p>a set of tools to create a fully isolated network environment to test client/server components on a single host.<br/>It provides synthetic account information, hostname resolution and support for privilege separation.<br/>The heart of cwrap consists of three libraries you can preload to any executable.</p></blockquote>


<p>That one was the coolest technology I&#8217;ve seen so far although I may not need to use it at all,
hmmm maybe testing DHCP fits the case.</p>

<p>It evolved from the Samba project and takes advantage of the order in which
libraries are searched when resolving functions. When you preload the project libraries
to any executable they will override standard libc functions for working with sockets,
user accounts and privilege escalation.</p>

<p>The socket_wrapper library redirects networking sockets through local UNIX sockets and
gives you the ability to test applications which need privileged ports with a local developer
account.</p>

<p>The nss_wrapper library provides artificial information for user and group accounts,
network name resolution using a hosts file and loading and testing of NSS modules.</p>

<p>The uid_wrapper library allows uid switching as a normal user (e.g. fake root) and
supports user/group changing in the local thread using the syscalls (like glibc).</p>

<p>All of these wrapper libraries are controlled via environment variables and definitely
makes testing of daemons and networking applications easier.</p>

<h2>Testing Documentation</h2>

<p>That one was just scratching the surface of an entire branch of testing which I&#8217;ve not
even considered before. The talk also explains why it is hard to test documentation and
what possible solutions there are.</p>

<p>If you write user guides and technical articles which need to
stay current with the software this is definitely the place to start.</p>

<h2>Automation in the Foreman Infrastructure</h2>

<p>The last <a href="http://ftp.osuosl.org/pub/fosdem//2014/previews/fosdem/fosdem_2014/dv/UD2218A/2014-02-02/12_51_36.ogv">talk</a>
I&#8217;ve listened to. Definitely the best one from a general testing approach
point of view. Greg talked about starting with Foreman unit tests, then testing the merged PR,
then integration tests, then moving on to test the package build and then the resulting packages themselves.</p>

<p>These guys try to even test their own infrastructure (infra as code) and the test suites
they use to test everything else. It&#8217;s all about automation and the level of confidence
you have in the entire process.</p>

<p>I like the fact that no single testing approach can make you confident enough before shipping
the code and that they&#8217;ve taken into account changes which get introduced at various places
(e.g. 3rd party package upgrades, distro specific issues, infrastructure changes and such)</p>

<p>If I had to attend only one session it would have been this one. There are many things for me
to take back home and apply to my work on Fedora and RHEL.</p>

<p>If you find any of these topics remotely interesting I advise you to wait until FOSDEM video
team uploads the recordings and watch the entire session stream. I&#8217;m definitely missing a lot
of stuff which can&#8217;t be easily reproduced in text form.</p>

<p>You can also find my report of the first FOSDEM&#8217;14 day on Saturday
<a href="/blog/2014/02/03/fosdem-2014-report-day-1-python-stands-lightning-talks/">here</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/03/fosdem-2014-report-day-1-python-stands-lightning-talks/">FOSDEM 2014 Report - Day #1 Python, Stands and Lightning Talks</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-03T21:37:00+02:00" pubdate data-updated="true">Feb 3<span>rd</span>, 2014</time>
        
         | <a href="/blog/2014/02/03/fosdem-2014-report-day-1-python-stands-lightning-talks/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>As promised I&#8217;m starting catching up on blogging after being sick and traveling.
Here&#8217;s my report of what I saw and found interesting at this year&#8217;s
<a href="https://fosdem.org/2014/">FOSDEM</a> which was held the last weekend in Brussels.</p>

<p>On Friday evening I&#8217;ve tried to attend the FOSDEM beer event at Delirium Cafe but
had a bad luck. At 21:30 the place was already packed with people. I managed to get
access to only one of the rooms but it looked like the wrong one :(. I think the space
is definitely small for all who are willing to attend.</p>

<p>During Saturday morning I did a quick sight-seeing most notably
<a href="www.migsworldwines.be/">Mig&#8217;s wine shop</a> and the area around it since I&#8217;ve never
been to this part of the city before. Then I took off to FOSDEM arriving at noon
(IOW not too late).</p>

<p>I&#8217;ve spent most of my day at building K where project stands were and I stayed quite
a long time around the Python and Perl stands meeting new people and talking to them
about their upgrade practices and how they manage package dependencies
(aka promoting <a href="http://www.dif.io">Difio</a>).</p>

<p><img src="/images/fosdem/2014/fedora_octopus.jpg" title="Fedora Octopus" alt="Fedora Octopus" /></p>

<p>Fedora stand was busy with 3D printing this year. I&#8217;ve seen 3D printing
before but here I was amazed of the fine-grained quality of the pieces produced.
This is definitely something to have in mind if you are building physical products.</p>

<p>Red Hat&#8217;s presence was very strong this year. In addition to the numerous talks they
gave there were also oVirt and OpenShift Origin stands which were packed with people.
I couldn&#8217;t even get close to say hi or take a picture.</p>

<p><img src="/images/fosdem/2014/doudou_linux.png" alt="DoudouLinux" style="float:left;margin-right:10px;"/></p>

<p>Near the end of the day I went to listen to some of the lightning talks. The ones that
I liked the most were MATE Desktop and DoudouLinux.</p>

<p>The thing about MATE which I liked
is that they have a <a href="https://github.com/mate-desktop/mate-university">MATE University</a>
initiative which is targeting developers who want to learn how to develop MATE extensions.
This is pretty cool with respect to community and developers on-boarding.</p>

<p><a href="http://www.doudoulinux.org">DoudouLinux</a> is a Debian based distribution targeted at
small children (2 or 3 years old) based on simple desktop and educational activities.
I&#8217;ve met project leader and founder Jean-Michel Philippe who gave the talk. We chatted for
a while when Alejandro Simon from <a href="http://www.kano.me/">Kano</a> came around and showed us a prototype
of their computer for children. I will definitely give DoudouLinux a try and maybe pre-order Kano as well.</p>

<p>In the evening there was a Python beer event at Delirium and after that dinner at
Chez Leon where I had snails and rabbit with cherries in cherry beer sauce.
I&#8217;ve had a few beers with Marc-Andre from <a href="http://egenix.com">eGenix</a>
and Charlie from <a href="http://www.clark-consulting.eu/">Clark Consulting</a> and the talk
was mostly about non-technical stuff which was nice.</p>

<p>After that we went back to Delirium and
re-united with <a href="http://akurtakov.blogspot.com">Alexander Kurtakov</a> and other folks from
Red Hat for more cherry beer!</p>

<p>Report of the second day of FOSDEM&#8217;14 on Sunday is
<a href="/blog/2014/02/03/fosdem-2014-report-day-2-testing-and-automation/">here</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/28/book-review-january-2014/">Book Review - January 2014</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-01-28T23:16:00+02:00" pubdate data-updated="true">Jan 28<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/01/28/book-review-january-2014/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Sorry for not being able to write anything this month. I&#8217;ve been very sick
and hardly even touched a computer in the last few weeks. I promise to make
it up to you next month. Until then here&#8217;s the books I&#8217;ve managed to read in
January.</p>

<h2>Hooked: How to Build Habit-Forming Products</h2>

<p><a href="http://amzn.to/1erRrnb">Hooked</a> is an ebook for Kindle which I luckily got for
free on NYE (it&#8217;s paid now). The book describes the so called &#8220;Hook Model&#8221;
which is a guide to building products people cant put down.</p>

<p>The book goes through a cycle of <strong>trigger</strong>, <strong>action</strong>, <strong>variable reward</strong> and
<strong>investment</strong> to describe how one can design a product which users keep using
without you doing anything (pretty much). There are plenty of examples with products
like Instagram and Pinterest.</p>

<p>I really find the book interesting and will strongly recommend it as a must read
to anyone who is building a product. If you&#8217;re thinking about a mobile app or an
online service this book is definitely for you.</p>

<h2>CyberJoly Drim</h2>

<p><a href="http://hell.pl/nina/carramba.htm">CyberJoly Drim</a> is a 1998 cyber punk story by
Polish writer Antonina Liedtke. One I&#8217;ve heard about through the years but found
just recently. It&#8217;s about a love story although everything else is fiction. PDF format
is around 30 pages.</p>

<p>I found it hard to read especially b/c my Polish is totally rusty (not to mention I hardly
understand it) and Google translate didn&#8217;t manage well neither. Anyway, not a bad read
before bed time if you like this kind of stuff.</p>

<h2>The First in Bulgarian Internet</h2>

<p>Last a book about
<a href="https://www.goodreads.com/book/show/13398350">Bulgarian Internet pioneers</a>. The book
compiles a great deal with historical data as well as interviews and web site descriptions.
It&#8217;s said to mention about 400 persons.</p>

<p>The events start around 1989 with the BBS systems at the time and the first one to appear in
the country with accounts of first time logging into the network and pretty much seeing a
computer. Then it goes to tell the story of first companies and Internet providers, how they
started business, how they grew and formed the country&#8217;s backbone infrastructure. There&#8217;s
lots of personal memories and stories as well. This goes to about 2002 when the book
was written.</p>

<p>The second part of the book mostly describes various websites, some of the first ones and
some milestone or famous ones. It&#8217;s organized by date of website launch but isn&#8217;t that much
interesting. I find the local contents at the time a bit boring.</p>

<p>The book isn&#8217;t what I initially expected - I wanted more personal stories and more news from
the kitchen. It&#8217;s not that, it looks to me the people who were interviewed had chosen their
words very carefully and didn&#8217;t reveal any sensational stories.</p>

<p>The nice thing about all of that is I&#8217;ve started using the web in early 1998 and remember
most of the events and websites described in the book. It&#8217;s good to remember the history.
I own the book and can give it to you if you like. It&#8217;s on the <a href="/give-away/">Give Away</a>
list.</p>

<p>I hope you find something interesting to read in my library. If not please share what did you
read this month.</p>

<hr />

<p>PS: I&#8217;m currently in Milan and will be visiting FOSDEM at the end of the week. Catch
you there if you&#8217;re coming.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/5/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/3/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <p>
    I am a QA contractor at Red Hat responsible for over
    <a href="/blog/2014/02/19/7-years-1400-bugs-red-hat-qa/">1500 bugs</a>,
    a general purpose open source developer, Red Hat Certified professional,
    cloud hacker and an <a href="/projects/">entrepreneur</a>.
  </p>

  <p>
    I&#8217;m living in the <a href="http://planet.sofiavalley.com">Sofia Valley</a>
    which is emerging as a busy place for start-up founders and tech enthusiasts
    in Eastern Europe! You can find more about me <a href="/about/">here</a>.
  </p>
</section>

<section>
  
    <a href="http://twitter.com/atodorov_" class="twitter-follow-button" data-show-count="true">Follow @atodorov_</a>
  
</section>


<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="atodorov.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>

<section>
    <h1>
        <a href="/blog/categories/books/">Book Reviews</a>
    </h1>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/10/14/anaconda-coverage.py-introduction/">Anaconda &amp; coverage.py - Pt.1 - Introduction</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/30/thunderbolt-to-vga-adapter-on-linux/">Thunderbolt to VGA adapter on Linux</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/25/unit-testing-bad-stub-design-in-dnf/">Unit Testing Example - Bad Stub Design in DNF</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/16/4000-bugs-in-fedora-checksec-failures/">4000+ bugs in Fedora - checksec failures</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/08/20/minor-typo-bug-in-messenger/">Minor Typo Bug in Messenger for bg_BG.UTF-8</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/08/17/pedometer-bug-in-samsung-s-health/">Pedometer Bug in Samsung S Health</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/08/14/tip-try-f10-when-editing-grub2-menu-in-efi-mode/">Tip: Try F10 When Editing grub2 Menu in EFI Mode</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/07/27/call-for-ideas-graphical-test-coverage-reports/">Call for Ideas: Graphical Test Coverage Reports</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/07/01/open-data-event-coming-to-sofia/">Open Data Event Coming to Sofia</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/22/devit-conf-2015-impressions/">DEVit Conf 2015 Impressions</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Disclaimer</h1>
  <p>
Some of the links contained within this site have my referral id (e.g., Amazon), which provides me with a small commission for each sale. Thank you for your support.
  </p>
</section>




  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">CC-BY-SA</a>
  &amp;
  <a rel="license" href="http://opensource.org/licenses/MIT">MIT</a>
  2011-2015 &diams; Alexander Todorov
  &diams;
  <a href="/about/">About Me</a>
  &diams;
  Popular categories:
<a href="/blog/categories/rhel/">Red Hat</a>,
<a href="/blog/categories/cloud/">Cloud</a>,
<a href="/blog/categories/fedora/">Fedora</a>,
<a href="/blog/categories/qa/">QA</a>,
<a href="/blog/categories/start-up/">Start-up</a>

  <a href="http://planet.sofiavalley.com" style="float:right">SofiaValley Blog</a>
</p>

<script type="text/javascript">
var uri = window.location.toString();
if (uri.indexOf("?") > 0) {
    var clean_uri = uri.substring(0, uri.indexOf("?"));
    window.history.replaceState({}, document.title, clean_uri);
}
</script>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'atodorov';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
