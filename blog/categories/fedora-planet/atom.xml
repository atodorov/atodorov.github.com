<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: fedora.planet | atodorov.org - you can logoff, but you can never leave]]></title>
  <link href="http://atodorov.org/blog/categories/fedora-planet/atom.xml" rel="self"/>
  <link href="http://atodorov.org/"/>
  <updated>2015-05-05T13:25:53+03:00</updated>
  <id>http://atodorov.org/</id>
  <author>
    <name><![CDATA[Alexander Todorov]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Thunderbolt to Ethernet Adapter on Linux]]></title>
    <link href="http://atodorov.org/blog/2015/05/04/thunderbolt-to-ethernet-adapter-on-linux/"/>
    <updated>2015-05-04T22:27:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/05/04/thunderbolt-to-ethernet-adapter-on-linux</id>
    <content type="html"><![CDATA[<p>As it seems my
<a href="http://www.amazon.com/gp/product/B008ALA6DW/ref=as_li_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=B008ALA6DW&linkCode=as2&tag=atodorovorg-20&linkId=T2J6D7GIDMKNWLYV">Thunderbolt to gigabit Ethernet adapter</a><img src="http://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=B008ALA6DW" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
works with
<a href="/blog/2015/04/26/installing-red-hat-enterprise-linux-7-on-macbook-air-2015/">RHEL 7 on a MacBook Air</a>
despite some reports it may not.</p>

<p>After plugging the device is automatically recognized and the <em>tg3</em> driver is loaded.
Detailed <em>lspci</em> below:</p>

<pre><code>0a:00.0 Ethernet controller: Broadcom Corporation NetXtreme BCM57762 Gigabit Ethernet PCIe
    Subsystem: Apple Inc. Device 00f6
    Physical Slot: 9
    Flags: bus master, fast devsel, latency 0, IRQ 19
    Memory at cd800000 (64-bit, prefetchable) [size=64K]
    Memory at cd810000 (64-bit, prefetchable) [size=64K]
    [virtual] Expansion ROM at cd820000 [disabled] [size=64K]
    Capabilities: [48] Power Management version 3
    Capabilities: [50] Vital Product Data
    Capabilities: [58] MSI: Enable- Count=1/8 Maskable- 64bit+
    Capabilities: [a0] MSI-X: Enable+ Count=6 Masked-
    Capabilities: [ac] Express Endpoint, MSI 00
    Capabilities: [100] Advanced Error Reporting
    Capabilities: [13c] Device Serial Number 00-00-ac-87-a3-25-20-33
    Capabilities: [150] Power Budgeting &lt;?&gt;
    Capabilities: [160] Virtual Channel
    Capabilities: [1b0] Latency Tolerance Reporting
    Kernel driver in use: tg3
</code></pre>

<p>Unplugging and pluggin back in the network cable works as expected.
I did see my computer freeze 2 out of 10 times when I've unplugged the Thunderbolt
adapter but couldn't reproduce it repliably or grab more info.</p>

<p>For the record this is with kernel 3.10.0-229.1.2.el7.x86_64 which is missing
this
<a href="https://git.kernel.org/cgit/linux/kernel/git/gregkh/char-misc.git/commit/?h=char-misc-next&amp;id=16603153666d22df544ae9f9b3764fd18da28eeb">upstream commit</a>.
I'm not sure why it works though.</p>

<p>If I remember correctly <em>tg3</em> is available during installation so you should
be able to use the Thunderbolt adapter instead of WiFi as well.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Compiling Twinkle SIP Phone on RHEL 7]]></title>
    <link href="http://atodorov.org/blog/2015/05/01/compiling-twinkle-sip-phone-on-rhel-7/"/>
    <updated>2015-05-01T15:04:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/05/01/compiling-twinkle-sip-phone-on-rhel-7</id>
    <content type="html"><![CDATA[<p>One of the best SIP clients for Linux is <a href="http://twinklephone.com/">Twinkle</a>.
However upstream is not active (or even maybe dead) and the package is missing from
latest Fedora releases and fails to build on RHEL 7.</p>

<p>First you need to build and install a few dependencies in the following order:
<a href="http://koji.fedoraproject.org/koji/packageinfo?packageID=8437">ucommon</a>,
<a href="http://koji.fedoraproject.org/koji/packageinfo?packageID=1443">ccrtp</a>,
<a href="http://koji.fedoraproject.org/koji/packageinfo?packageID=6408">libzrtpcpp</a>.
You will also need <a href="https://fedoraproject.org/wiki/EPEL">EPEL 7</a> enabled
to satisfy build dependencies.</p>

<p>Then apply the following patch to the original
<a href="http://koji.fedoraproject.org/koji/buildinfo?buildID=397914">twinkle.spec</a></p>

<pre><code>--- twinkle.spec.orig   2015-05-01 14:07:01.870710147 +0300
+++ twinkle.spec    2015-05-01 15:07:28.734734573 +0300
@@ -47,6 +47,8 @@

 %build
 export LDFLAGS=-lkio 
+export CPPFLAGS="$CPPFLAGS -I/usr/include/libzrtpcpp/" 
+%__autoconf
 %configure
 make %{?_smp_mflags}
</code></pre>

<p>The package now builds, installs and runs successfully on RHEL 7.
The compiled packages and dependencies are available in my
<a href="/blog/2015/04/29/rhel-7-repository-for-macbook-air/">Macbook Air RHEL 7 repository</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Fixing Tilde and Function Keys Mapping for MacBook Air on Linux]]></title>
    <link href="http://atodorov.org/blog/2015/04/30/fixing-tilde-and-function-keys-mapping-for-macbook-air-on-linux/"/>
    <updated>2015-04-30T11:33:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/04/30/fixing-tilde-and-function-keys-mapping-for-macbook-air-on-linux</id>
    <content type="html"><![CDATA[<p>Thera are two problems with the MacBook Air keyboard on Linux:</p>

<p>Function keys and media keys are switched and by default you have to
press Fn+F5 in order to refresh a browser page. The
<a href="https://chaidarun.com/fedora-mbp">solution</a> is</p>

<pre><code>echo 2 &gt; /sys/module/hid_apple/parameters/fnmode
</code></pre>

<p>The tilde key is mapped improperly, see
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=1025041#c2">RHBZ #1025041</a>.
To fix it</p>

<pre><code>echo 0 &gt; /sys/module/hid_apple/parameters/iso_layout
</code></pre>

<h2>Permanent fix</h2>

<p>Either you have to add the above commands in a boot script or you can
<code>yum install mba-kbd-fix</code> from my
<a href="/blog/2015/04/29/rhel-7-repository-for-macbook-air/">Macbook Air RHEL 7 repository</a>.
The RPM source can be found <a href="https://github.com/atodorov/mba-kbd-fix">here</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[RHEL 7 Repository for MacBook Air]]></title>
    <link href="http://atodorov.org/blog/2015/04/29/rhel-7-repository-for-macbook-air/"/>
    <updated>2015-04-29T13:00:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/04/29/rhel-7-repository-for-macbook-air</id>
    <content type="html"><![CDATA[<p>I've made a repository with binary (x86_64 only) and source RPM packages which
are missing from Red Hat Enterprise Linux 7 and necessary when using a
MacBook Air. To install execute the commands below:</p>

<pre><code>cd /etc/yum.repos.d/
wget https://s3.amazonaws.com/atodorov/rpms/macbook/el7/rhel7-macbook.repo
</code></pre>

<h2>Wireless driver</h2>

<pre><code>yum install kmod-wl
</code></pre>

<h2>Display backlight driver</h2>

<pre><code>yum install kmod-mba6x_bl
</code></pre>

<p>And uncomment <code>/etc/X11/xorg.conf.d/98-mba_bl.conf</code>.</p>

<p><em>Note:</em> the .spec file is available from
<a href="https://github.com/patjak/mba6x_bl/pull/26">RP #26</a>.</p>

<h2>Fixing keyboard mapping</h2>

<pre><code>yum install mba-kbd-fix
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Fixing Display Brightness on MacBook Air with RHEL 7]]></title>
    <link href="http://atodorov.org/blog/2015/04/29/fixing-display-brightness-on-macbook-air-with-rhel-7/"/>
    <updated>2015-04-29T12:14:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/04/29/fixing-display-brightness-on-macbook-air-with-rhel-7</id>
    <content type="html"><![CDATA[<p>One issue with RHEL/CentOS/Fedora on MacBook Air laptops is brightness control
and backlight behavior after suspend/resume. I've found the solution
<a href="http://mattoncloud.org/2014/02/05/fedora-20-on-a-macbook-air/">here</a>
and only tweaked it slightly for my use case.</p>

<h2>mba6x_bl doesn't load automatically</h2>

<p>The reason being the driver matches older hardware:</p>

<pre><code>$ modinfo mba6x_bl
filename:       /lib/modules/3.10.0-229.1.2.el7.x86_64/extra/mba6x_bl/mba6x_bl.ko
alias:          dmi:*:pnMacBookAir6*
license:        GPL
description:    MacBook Air 6,1 and 6,2 backlight driver
author:         Patrik Jakobsson &lt;patrik.r.jakobsson@gmail.com&gt;
rhelversion:    7.1
srcversion:     4D069C8EB0E470AF27E7F8D
depends:        video
vermagic:       3.10.0-229.1.2.el7.x86_64 SMP mod_unload modversions 
</code></pre>

<p>My system is <strong>MacBookAir7,2</strong> and doesn't match the module alias. So a
<a href="https://github.com/patjak/mba6x_bl/pull/25">quick fix</a> was needed.
For more info about <code>MODULE_ALIAS</code> see
<a href="https://wiki.archlinux.org/index.php/Modalias">ArchWiki</a>.
Alternatively on Red Hat based systems you can place a config file
under <code>/etc/sysconfig/modules</code>, see
<a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Deployment_Guide/sec-Persistent_Module_Loading.html">the docs</a>
for more details.</p>

<h2>intel_backlight driver is in the way</h2>

<p>On older systems mba6x_bl doesn't get used automatically. The problem is the offending
intel_backlight driver which gets used instead. To workaround it add this xorg.conf snippet:</p>

<pre><code>$ cat /etc/X11/xorg.conf.d/98-mba_bl.conf
Section "Device"
    Identifier      "Intel Graphics"
    Driver          "intel"
    Option          "Backlight"     "mba6x_backlight"
EndSection
</code></pre>

<p>For more info see <a href="https://bugzilla.redhat.com/show_bug.cgi?id=989555#c19">RHBZ 989555</a>.</p>

<h2>Everything in one go</h2>

<p>If you are using RHEL 7 or CentOS 7 (version 7.1 required) instead of Fedora you can take
a look at my <a href="/blog/2015/04/29/rhel-7-repository-for-macbook-air/">Macbook Air RHEL 7 repository</a>.</p>
]]></content>
  </entry>
  
</feed>
