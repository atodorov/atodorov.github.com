<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Mac | atodorov.org - you can logoff, but you can never leave]]></title>
  <link href="http://atodorov.org/blog/categories/mac/atom.xml" rel="self"/>
  <link href="http://atodorov.org/"/>
  <updated>2015-04-27T12:42:23+03:00</updated>
  <id>http://atodorov.org/</id>
  <author>
    <name><![CDATA[Alexander Todorov]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Compiling Broadcom wl-kmod WiFi Driver for RHEL 7]]></title>
    <link href="http://atodorov.org/blog/2015/04/27/compiling-broadcom-wl-kmod-wifi-driver-for-rhel-7/"/>
    <updated>2015-04-27T12:17:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/04/27/compiling-broadcom-wl-kmod-wifi-driver-for-rhel-7</id>
    <content type="html"><![CDATA[<p>After I got my
<a href="/blog/2015/04/26/installing-red-hat-enterprise-linux-7-on-macbook-air-2015/">MacBook Air installed with RHEL 7.1</a>
the first priority was getting wireless working.
First check if your device isn't already supported
<a href="http://linuxwireless.org/en/users/Drivers/b43/#Supported_devices">upstream</a>. Mine isn't</p>

<pre><code>14e4:43a0: Broadcom Corporation BCM4360 802.11ac Wireless Network Adapter (rev 03)
</code></pre>

<p>Next grab the src.rpm files necessary to build the <em>wl</em> driver from RPM Fusion.
For <code>akmods-0.5.2-1.fc21.src.rpm</code>, <code>broadcom-wl-6.30.223.248-2.fc21.src.rpm</code>,
<code>kmodtool-1-23.fc20.src.rpm</code> just execute <em>rpmbuild --rebuild</em> against each file
and install <code>kmodtool</code> and <code>akmods</code>.</p>

<p>Then you need two more files <code>buildsys-build-rpmfusion</code> and <code>wl-kmod</code>.
The first one is a helper tool containing list of recent kernels to build against,
the later one is the driver source itself. Both needed minor modifications before
building on RHEL 7.</p>

<p>I've created my own
<a href="https://github.com/atodorov/buildsys-build-rpmfusion-for-rhel7">buildsys-build-rpmfusion</a> package listing the current kernels
for RHEL 7.1. For <a href="https://github.com/atodorov/wl-kmod-for-rhel7">wl-kmod</a> I've introduced a
<a href="https://github.com/atodorov/wl-kmod-for-rhel7/blob/master/wl-kmod-100_redhat.patch">patch</a>
which modifies the other patches in the package so it builds correctly on 7.1.</p>

<p><strong>Note:</strong> I don't know if there's a define which can be used to detect if we're building
on RHEL (maybe I can define my own) but direct kernel version number comparison doesn't
work here because Red Hat backports chosen functionality from more recent kernels without
changing the version number. This approach may not be the best one but I've tried to keep it clean
for easier maintenance in the future and it got me started very quickly.</p>

<p>Build the modified buildsys-build-rpmfusion and:</p>

<pre><code>yum install buildsys-build-rpmfusion-7-1.x86_64.rpm buildsys-build-rpmfusion-kerneldevpkgs-current-7-1.x86_64.rpm
</code></pre>

<p>Build the wl-kmod package and:</p>

<pre><code>yum install akmod-wl-6.30.223.248-5.el7.x86_64.rpm broadcom-wl-6.30.223.248-2.el7.noarch.rpm kmod-wl-3.10.0-229.el7.x86_64-6.30.223.248-5.el7.x86_64.rpm kmod-wl-6.30.223.248-5.el7.x86_64.rpm
</code></pre>

<p>If necessary re-create your initramfs image to include <em>wl.ko</em>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Installing Red Hat Enterprise Linux 7 on MacBook Air 2015]]></title>
    <link href="http://atodorov.org/blog/2015/04/26/installing-red-hat-enterprise-linux-7-on-macbook-air-2015/"/>
    <updated>2015-04-26T20:33:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/04/26/installing-red-hat-enterprise-linux-7-on-macbook-air-2015</id>
    <content type="html"><![CDATA[<p>Recently I've upgraded to a new
<a href="http://www.amazon.com/gp/product/B00UGECEUY/ref=as_li_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=B00UGECEUY&linkCode=as2&tag=atodorovorg-20&linkId=3YENGI5TIYKEC5GM">MacBook Air</a><img src="http://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=B00UGECEUY" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
(13 inch, early 2015) laptop and luckily enough I'm running
Red Hat Enterprise Linux 7.1 on it. Here is how to install it.</p>

<h2>Prepare boot media</h2>

<p>The easiest method is to boot from a USB stick which holds
either the entire DVD or just boot.iso. Since I happened to find a 1GB only USB stick I
went for the boot.iso. <code>dd if=boot.iso of=/dev/sdb</code> is the only thing you need to prepare
the boot media.</p>

<h2>Initial boot</h2>

<p><img src="/images/mac/boot_menu.jpg" title="Mac boot menu" alt="Mac boot menu" /></p>

<p>While computer is booting hold the (left) Alt (Option) key to enter <em>Startup Manager</em>.
Wait a second or two before it displays your local hard drive and the USB boot media.
Select the option <em>EFI boot</em> to boot the anaconda installer.</p>

<h2>Installation</h2>

<p>Booting from a boot.iso means I need to use the network to grab the rest of the installation.
Because the wireless card needs proprietary drivers
I've tried both USB to Ethernet adapter and USB tethering with my phone.</p>

<p><strong>Note:</strong> initially I have forgotten to plug in my USB networking card which resulted in
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=1191286">bug #1191286</a>. After cold-plugging and
rebooting the system everything was fine. Subsequently I don't see any problems with the
USB networking card. The bug should be fixed in RHEL 7.2 btw.</p>

<p><strong>Note:</strong> I've been using a
<a href="http://www.amazon.com/gp/product/B002PONXAI/ref=as_li_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=B002PONXAI&linkCode=as2&tag=atodorovorg-20&linkId=N4KGQKYSBSDWMMM6">USB docking station from Plugable</a><img src="http://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=B002PONXAI" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
for years because their products are Linux friendly. In particular the networking chip is ASIX and
there is no problems with drivers for Linux.</p>

<p>In my case I've wiped out the entire SSD disk b/c I don't care about dual boot.
Previously I've heard about anaconda crashing while it tries to detect the Mac OS file system.
I've played around with Rawhide before going for RHEL 7.1 and didn't see any problems related to
foreign filesystems.</p>

<p>I've gone with the default partitioning scheme while slightly modifing the partition sizes, etc.</p>

<h2>Post install</h2>

<p>There are several issues which still need attention. I didn't have enough time in the last few
days to check these out:</p>

<ul>
<li>GNOME 3 sucks big time. Fortunately I was able to install MATE Desktop from EPEL;</li>
<li>Wireless card needs drivers; I've managed to compile them myself, will share the info soon;</li>
<li>Display brightness doesn't seem to work at all. On top of that the display goes full black
after suspend-resume. I could barely see anything on it.</li>
<li>The onboard keyboard is quite annoying for previous ThinkPad user like myself. Most
importantly I need to press Fn to activate the F1, F2, etc keys which I use a lot in mcedit.
I'll share more info aafter I figure out how to remap the keyboard;</li>
<li>There is a very annoying boot chime which I have no idea how to disable;</li>
<li>I do have a Thunderbolt to Ethernet adapter and hot-plug seems to work (at least partially)
despite claims that this is not supported in Linux;</li>
<li>Power manager was reporting my battery life totally wrong but after a full discharge/recharge
it seems to have calibrated itself. I need to fix brightness and other issues before doing more
tests;</li>
<li>Output sound works out of the box, haven't tested camera and microphone input yet;</li>
<li>ATrpms and EPEL are still missing some codecs for RHEL 7 which means no movies;</li>
<li>Fan speed needs adjustments;</li>
<li>I have not yet tested presenting via projector but already have a few ideas how to make it work;</li>
</ul>


<h2>Fedora 22 on MacBook Air</h2>

<p>I did try Fedora 22 Beta and experienced
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=1215458">bug #1215458</a>.
Also for some reason the installation hit an error downloading a package and didn't let me retry
but forced me to exit the process.</p>

<p>I'll continue posting my updates until the system runs smoothly like it is supposed to.</p>
]]></content>
  </entry>
  
</feed>
