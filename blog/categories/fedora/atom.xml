<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Fedora | atodorov.org - you can logoff, but you can never leave]]></title>
  <link href="http://atodorov.org/blog/categories/fedora/atom.xml" rel="self"/>
  <link href="http://atodorov.org/"/>
  <updated>2014-02-10T14:18:32+02:00</updated>
  <id>http://atodorov.org/</id>
  <author>
    <name><![CDATA[Alexander Todorov]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Tip: How to Build updates.img for Fedora]]></title>
    <link href="http://atodorov.org/blog/2014/02/07/tip-how-to-build-updates.img-for-fedora/"/>
    <updated>2014-02-07T11:01:00+02:00</updated>
    <id>http://atodorov.org/blog/2014/02/07/tip-how-to-build-updates.img-for-fedora</id>
    <content type="html"><![CDATA[<p>Anaconda the Fedora, CentOS and Red Hat Enterprise Linux installer has the
capability to incorporate
<a href="https://fedoraproject.org/wiki/Anaconda/Updates">updates at runtime</a>.
These updates are generally distributed as an <code>updates.img</code> file. Here is how
to easily build one from a working installation tree.</p>

<p>Instead of using the git sources to build an updates.img I prefer using the SRPM
from the tree which I am installing. <strike>This way the resulting updates image will be
more consistent with the anaconda version already available in the tree. And in theory
everything you need to build it should already be available as well.</strike>
<strong>UPDATE 2014-02-08:</strong> You can also build the <code>updates.img</code> from the git source tree
which is shown at the bottom of this article.</p>

<p>The following steps work for me on a Fedora 20 system.</p>

<ul>
<li>Download the source RPM for anaconda from the tree and extract the sources to a working
directory. Then;</li>
</ul>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd </span>anaconda-20.25.15
</span><span class='line'>git init
</span><span class='line'>git add .
</span><span class='line'>git commit -m <span class="s2">&quot;initial import&quot;</span>
</span><span class='line'>git tag anaconda-20.25.15
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<ul>
<li><p>The above steps will create a local git repository and tag the initial contents before
modification. The tag is required later by the script which creates the updates image;</p></li>
<li><p>After making your changes commit them and from the top anaconda directory execute:</p></li>
</ul>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>./scripts/makeupdates -t anaconda-20.25.15
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>You can also add RPM contents to the updates.img but you need to download the packages first:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>yumdownloader python-coverage python-setuptools&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;./scripts/makeupdates -t anaconda-20.25.15 -a ~/python-coverage-3.7-1.fc20.x86_64.rpm -a ~/python-setuptools-1.4.2-1.fc20.noarch.rpm
</span><span class='line'>BUILDDIR /home/atodorov/anaconda-20.25.15
</span><span class='line'>Including anaconda
</span><span class='line'>2 RPMs added manually:
</span><span class='line'>python-setuptools-1.4.2-1.fc20.noarch.rpm
</span><span class='line'>python-coverage-3.7-1.fc20.x86_64.rpm
</span><span class='line'><span class="nb">cd</span> /home/atodorov/anaconda-20.25.15/updates &amp;amp;&amp;amp; rpm2cpio /home/atodorov/python-setuptools-1.4.2-1.fc20.noarch.rpm | cpio -dium
</span><span class='line'>3534 blocks
</span><span class='line'><span class="nb">cd</span> /home/atodorov/anaconda-20.25.15/updates &amp;amp;&amp;amp; rpm2cpio /home/atodorov/python-coverage-3.7-1.fc20.x86_64.rpm | cpio -dium
</span><span class='line'>1214 blocks
</span><span class='line'>&lt;stdin&gt; to &lt;stdout&gt; 4831 blocks&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;updates.img ready
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>In the above example I have only modified the top level anaconda file (<code>/usr/sbin/anaconda</code>
inside the installation environment) experimenting with
<a href="http://nedbatchelder.com/code/coverage/">python-coverage</a> integration.</p>

<p>You are done! Make the <code>updates.img</code> available to Anaconda and start using it!</p>

<p><strong>UPDATE 2014-02-08:</strong> If you prefer working with the anaconda source tree here's
how to do it:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>git clone git://git.fedorahosted.org/git/anaconda.git
</span><span class='line'><span class="nb">cd </span>anaconda/
</span><span class='line'>git checkout anaconda-20.25.15-1 -b my_feature-branch&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;... make changes ...&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;git commit -a -m <span class="s2">&quot;Fixed something&quot;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;./scripts/makeupdates -t anaconda-20.25.15-1
</span></code></pre></td></tr></table></div></figure></notextile></div></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[FOSDEM 2014 Report - Day #2 Testing and Automation]]></title>
    <link href="http://atodorov.org/blog/2014/02/03/fosdem-2014-report-day-2-testing-and-automation/"/>
    <updated>2014-02-03T22:54:00+02:00</updated>
    <id>http://atodorov.org/blog/2014/02/03/fosdem-2014-report-day-2-testing-and-automation</id>
    <content type="html"><![CDATA[<p><img src="/images/fosdem/2014/testing_automation.jpg" title="Testing and Automation" alt="Testing and Automation" /></p>

<p>FOSDEM was hosting the
<a href="https://fosdem.org/2014/schedule/track/testing_and_automation/">Testing and automation devroom</a>
for the second year and this was the very reason I attended the conference. I managed to get in
early and stayed until 15:00 when I had to leave to catch my flight (which was late :().</p>

<p>There were 3 talks given by Red Hat employees in the testing devroom which was a nice opportunity
to meet some of the folks I've been working on IRC with. Unfortunately I didn't meet anyone from
Fedora QA. Not sure if they were attending or not.</p>

<p>All the talks were interesting so see the official schedule and video for more details. I will
highlight only the items I saw as particularly interesting or have not heard of before.</p>

<h2>ANSTE</h2>

<p>ANSTE - Advanced Network Service Testing Environment is a test infrastructure controller,
something like our own <a href="http://beaker-project.org/">Beaker</a> but designed to create complex
networking environments. I think it lacks many of the provisioning features built in Beaker
and integration with various hypervisors and bare-metal provisioning. What it seems to do better
(as far as I can tell from the talk) is to deploy virtual systems and create more complex network
configuration between them. Not something I will need in the near future but definitely worth
a look at.</p>

<h2>cwrap</h2>

<p><blockquote><p>cwrap is...</p></p><p><p>a set of tools to create a fully isolated network environment to test client/server components on a single host.<br/>It provides synthetic account information, hostname resolution and support for privilege separation.<br/>The heart of cwrap consists of three libraries you can preload to any executable.</p></blockquote></p>

<p>That one was the coolest technology I've seen so far although I may not need to use it at all,
hmmm maybe testing DHCP fits the case.</p>

<p>It evolved from the Samba project and takes advantage of the order in which
libraries are searched when resolving functions. When you preload the project libraries
to any executable they will override standard libc functions for working with sockets,
user accounts and privilege escalation.</p>

<p>The socket_wrapper library redirects networking sockets through local UNIX sockets and
gives you the ability to test applications which need privileged ports with a local developer
account.</p>

<p>The nss_wrapper library provides artificial information for user and group accounts,
network name resolution using a hosts file and loading and testing of NSS modules.</p>

<p>The uid_wrapper library allows uid switching as a normal user (e.g. fake root) and
supports user/group changing in the local thread using the syscalls (like glibc).</p>

<p>All of these wrapper libraries are controlled via environment variables and definitely
makes testing of daemons and networking applications easier.</p>

<h2>Testing Documentation</h2>

<p>That one was just scratching the surface of an entire branch of testing which I've not
even considered before. The talk also explains why it is hard to test documentation and
what possible solutions there are.</p>

<p>If you write user guides and technical articles which need to
stay current with the software this is definitely the place to start.</p>

<h2>Automation in the Foreman Infrastructure</h2>

<p>The last talk I've listened to. Definitely the best one from a general testing approach
point of view. Greg talked about starting with Foreman unit tests, then testing the merged PR,
then integration tests, then moving on to test the package build and then the resulting packages themselves.</p>

<p>These guys try to even test their own infrastructure (infra as code) and the test suites
they use to test everything else. It's all about automation and the level of confidence
you have in the entire process.</p>

<p>I like the fact that no single testing approach can make you confident enough before shipping
the code and that they've taken into account changes which get introduced at various places
(e.g. 3rd party package upgrades, distro specific issues, infrastructure changes and such)</p>

<p>If I had to attend only one session it would have been this one. There are many things for me
to take back home and apply to my work on Fedora and RHEL.</p>

<p>If you find any of these topics remotely interesting I advise you to wait until FOSDEM video
team uploads the recordings and watch the entire session stream. I'm definitely missing a lot
of stuff which can't be easily reproduced in text form.</p>

<p>You can also find my report of the first FOSDEM'14 day on Saturday
<a href="/blog/2014/02/03/fosdem-2014-report-day-1-python-stands-lightning-talks/">here</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[FOSDEM 2014 Report - Day #1 Python, Stands and Lightning Talks]]></title>
    <link href="http://atodorov.org/blog/2014/02/03/fosdem-2014-report-day-1-python-stands-lightning-talks/"/>
    <updated>2014-02-03T21:37:00+02:00</updated>
    <id>http://atodorov.org/blog/2014/02/03/fosdem-2014-report-day-1-python-stands-lightning-talks</id>
    <content type="html"><![CDATA[<p>As promised I'm starting catching up on blogging after being sick and traveling.
Here's my report of what I saw and found interesting at this year's
<a href="https://fosdem.org/2014/">FOSDEM</a> which was held the last weekend in Brussels.</p>

<p>On Friday evening I've tried to attend the FOSDEM beer event at Delirium Cafe but
had a bad luck. At 21:30 the place was already packed with people. I managed to get
access to only one of the rooms but it looked like the wrong one :(. I think the space
is definitely small for all who are willing to attend.</p>

<p>During Saturday morning I did a quick sight-seeing most notably
<a href="www.migsworldwines.be/">Mig's wine shop</a> and the area around it since I've never
been to this part of the city before. Then I took off to FOSDEM arriving at noon
(IOW not too late).</p>

<p>I've spent most of my day at building K where project stands were and I stayed quite
a long time around the Python and Perl stands meeting new people and talking to them
about their upgrade practices and how they manage package dependencies
(aka promoting <a href="http://www.dif.io">Difio</a>).</p>

<p><img src="/images/fosdem/2014/fedora_octopus.jpg" title="Fedora Octopus" alt="Fedora Octopus" /></p>

<p>Fedora stand was busy with 3D printing this year. I've seen 3D printing
before but here I was amazed of the fine-grained quality of the pieces produced.
This is definitely something to have in mind if you are building physical products.</p>

<p>Red Hat's presence was very strong this year. In addition to the numerous talks they
gave there were also oVirt and OpenShift Origin stands which were packed with people.
I couldn't even get close to say hi or take a picture.</p>

<p><img src="http://atodorov.org/images/fosdem/2014/doudou_linux.png" alt="DoudouLinux" style="float:left;margin-right:10px;"/></p>

<p>Near the end of the day I went to listen to some of the lightning talks. The ones that
I liked the most were MATE Desktop and DoudouLinux.</p>

<p>The thing about MATE which I liked
is that they have a <a href="https://github.com/mate-desktop/mate-university">MATE University</a>
initiative which is targeting developers who want to learn how to develop MATE extensions.
This is pretty cool with respect to community and developers on-boarding.</p>

<p><a href="http://www.doudoulinux.org">DoudouLinux</a> is a Debian based distribution targeted at
small children (2 or 3 years old) based on simple desktop and educational activities.
I've met project leader and founder Jean-Michel Philippe who gave the talk. We chatted for
a while when Alejandro Simon from <a href="http://www.kano.me/">Kano</a> came around and showed us a prototype
of their computer for children. I will definitely give DoudouLinux a try and maybe pre-order Kano as well.</p>

<p>In the evening there was a Python beer event at Delirium and after that dinner at
Chez Leon where I had snails and rabbit with cherries in cherry beer sauce.
I've had a few beers with Marc-Andre from <a href="http://egenix.com">eGenix</a>
and Charlie from <a href="http://www.clark-consulting.eu/">Clark Consulting</a> and the talk
was mostly about non-technical stuff which was nice.</p>

<p>After that we went back to Delirium and
re-united with <a href="http://akurtakov.blogspot.com">Alexander Kurtakov</a> and other folks from
Red Hat for more cherry beer!</p>

<p>Report of the second day of FOSDEM'14 on Sunday is
<a href="/blog/2014/02/03/fosdem-2014-report-day-2-testing-and-automation/">here</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Upstream Test Suite Status of Fedora 20]]></title>
    <link href="http://atodorov.org/blog/2013/12/24/upstream-test-suite-status-of-fedora-20/"/>
    <updated>2013-12-24T08:01:00+02:00</updated>
    <id>http://atodorov.org/blog/2013/12/24/upstream-test-suite-status-of-fedora-20</id>
    <content type="html"><![CDATA[<p>Last week I've expressed my thoughts about the state of
<a href="https://lists.fedoraproject.org/pipermail/test/2013-December/119637.html">upstream test suites in Fedora</a>
along with some other ideas. Following the response on this thread I'm starting
to analyze all SRPM packages in Fedora 20 in order to establish a baseline. Here are my initial findings.</p>

<h2>What's Inside</h2>

<p>I've found two source distributions for Fedora 20:</p>

<ul>
<li>The <code>Fedora-20-source-DVD.iso</code> file which to my knowledge contains the sources
of all packages that comprise the installation media;</li>
<li>The <code>Everything/source/SRPMS/</code> directory which appears to contain the sources
of everything else available in the Fedora 20 repositories.</li>
</ul>


<p>There are <strong>2574</strong> SRPM packages in Fedora-20 source DVD and <strong>14364</strong> SRPMs
in the Everything/ directory. 9,2G vs. 41G.</p>

<h2>Test Suite Execution In %check</h2>

<p><a href="https://fedoraproject.org/wiki/Packaging:Guidelines#Test_Suites">Fedora Packaging Guidelines</a>
state</p>

<p><blockquote><p>If the source code of the package provides a test suite,<br/>it should be executed in the %check section,<br/>whenever it is practical to do so.</p></blockquote></p>

<p>In my research I found <strong>738</strong> SRPMs on the DVD which have a %check
section and <strong>4838</strong> such packages under <code>Everything/</code>. This is <strong>28,6%</strong> and <strong>33,6%</strong>
respectively.</p>

<h2>Test Suite Existence</h2>

<p>A quick grep for either <code>test/</code> or <code>tests/</code> directories in the package sources revealed
<strong>870</strong> SRPM packages in the source DVD which are very likely to have a test suite.
This is <strong>33,8%</strong>. <strike>I wasn't able to inspect the <code>Everything/</code> directory with this script
because it takes too long to execute and my system crashed out of memory.
I will update this post later with that info.</strike></p>

<p><em>UPDATE 2014-01-02</em>:
In the <code>Everything/</code> directory only <strong>4481</strong> (<strong>31,2%</strong>) SRPM packages appear to have
test suites.</p>

<p>The scripts and raw output are available at <a href="https://github.com/atodorov/fedora-scripts">https://github.com/atodorov/fedora-scripts</a>.</p>

<p>So it looks like on average <strong>30%</strong> of the packages execute their test suites at build
time in the %check section and less than <strong>35%</strong> have test suites at all!
There's definitely room for improvement and I plan to focus on this during 2014!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Can I Use Android Phone as Smart Card Reader]]></title>
    <link href="http://atodorov.org/blog/2013/12/18/can-i-use-android-phone-as-smart-card-reader/"/>
    <updated>2013-12-18T23:09:00+02:00</updated>
    <id>http://atodorov.org/blog/2013/12/18/can-i-use-android-phone-as-smart-card-reader</id>
    <content type="html"><![CDATA[<p>Today I had troubles with my Omnikey CardMan 6121 smart card reader.
For some reason it will not detect the card inside and was unusable.
<code>/var/log/messages</code> was filled with  <em>Card Not Powered</em> messages:</p>

<pre><code>Dec 18 11:17:55 localhost pcscd: eventhandler.c:292:EHStatusHandlerThread() Error powering up card: -2146435050 0x80100016
Dec 18 11:18:01 localhost pcscd: winscard.c:368:SCardConnect() Card Not Powered
Dec 18 11:18:02 localhost pcscd: winscard.c:368:SCardConnect() Card Not Powered
</code></pre>

<p><img src="http://atodorov.org/images/omnikey_cardman_6121.gif" style="float:right;margin-left:20px;" /></p>

<p>I've found the solution in
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=531998">RHBZ #531998</a>.</p>

<p><blockquote><p></p></p><p><p>I've found the problem, and it's purely mechanical.<br/>Omnikey has simply screwed up when they designed this reader.<br/>When the reader is inserted into the ExpressCard slot, it gets slightly<br/>compressed. This is enough to trigger the mechanical switch that detects<br/>insertions. If I jam something in there and force it apart, then pcscd<br/>starts reporting that the slot is empty.</p><footer><strong>Pierre Ossman</strong> <cite><a href='https://bugzilla.redhat.com/show_bug.cgi?id=531998#c12'>Comment #12</a></cite></footer></blockquote></p>

<p>So I tried moving the smart card a millimeter back and forth inside the reader and
that fixed it for me.</p>

<p>This smart card is standard SIM size and I wonder if it is possible to use
<a href="http://amzn.to/1dnl2gN">dual SIM</a> smart phones and <a href="http://amzn.to/18XpWlp">tablets</a>
as a reader? I will be happy to work on the software side if there is an open source
project already (e.g. OpenSC + drivers for Android). If not, why not?</p>

<p>If you happen to have information on the subject please share it in the comments.
Thanks!</p>
]]></content>
  </entry>
  
</feed>
