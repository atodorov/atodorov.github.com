<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Fedora | atodorov.org - you can logoff, but you can never leave]]></title>
  <link href="http://atodorov.org/blog/categories/fedora/atom.xml" rel="self"/>
  <link href="http://atodorov.org/"/>
  <updated>2015-04-08T15:20:58+03:00</updated>
  <id>http://atodorov.org/</id>
  <author>
    <name><![CDATA[Alexander Todorov]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Tip: Linux-IO default LUN is 0 instead of 1]]></title>
    <link href="http://atodorov.org/blog/2015/04/08/tip-linux-io-default-lun-is-0-instead-of-1/"/>
    <updated>2015-04-08T15:09:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/04/08/tip-linux-io-default-lun-is-0-instead-of-1</id>
    <content type="html"><![CDATA[<p>I've been testing iBFT in KVM which worked quite well with a RHEL 6 iSCSI target
and failed miserably when I switched to RHEL 7 iSCSI target.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>iPXE> dhcp net0
</span><span class='line'>DHCP (net0 52:54:00:12:34:56)... ok
</span><span class='line'>iPXE> set keep-san 1
</span><span class='line'>iPXE> sanboot iscsi:10.0.0.1:::1:iqn.2015-05.com.example:target1
</span><span class='line'>Could not open SAN device: Input/output error (http://ipxe.org/1d704539)
</span><span class='line'>iPXE></span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>The <a href="http://ipxe.org/err/1d7045">error page</a> says
<blockquote><p>Note that the default configuration when Linux is the target is for the disk to be LUN 1.</p></blockquote></p>

<p>Well this is not true for Linux-IO (targetcli). <strong>The default LUN is 0!</strong></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>iPXE> sanboot iscsi:10.0.0.1:::0:iqn.2015-05.com.example:target1
</span><span class='line'>Registered SAN device 0x80
</span><span class='line'>Booting from SAN device 0x80</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Kudos to Bruno Goncalves from Red Hat in helping me debug this issue!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Configure targetcli to Listen on IPv4 and IPv6]]></title>
    <link href="http://atodorov.org/blog/2015/04/08/how-to-configure-targetcli-to-listen-on-ipv4-and-ipv6/"/>
    <updated>2015-04-08T11:46:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/04/08/how-to-configure-targetcli-to-listen-on-ipv4-and-ipv6</id>
    <content type="html"><![CDATA[<p>In order to configure <em>targetcli</em> to listen on both IPv4 and IPv6 one has to
delete the default IPv4 portal configuration and replace it with IPv6 instead.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>targetcli&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/>
</span><span class='line'>/> cd iscsi/iqn.2015-04.com.example:target1/tpg1/portals
</span><span class='line'>/iscsi/iqn.20.../tpg1/portals> ls
</span><span class='line'>o- portals ............................................................................................................ [Portals: 1]
</span><span class='line'>  o- 0.0.0.0:3260 ............................................................................................................. [OK]
</span><span class='line'>/iscsi/iqn.20.../tpg1/portals> delete 0.0.0.0 3260
</span><span class='line'>Deleted network portal 0.0.0.0:3260
</span><span class='line'>/iscsi/iqn.20.../tpg1/portals> create ::0
</span><span class='line'>Using default IP port 3260
</span><span class='line'>Created network portal ::0:3260.
</span><span class='line'>/iscsi/iqn.20.../tpg1/portals> ls
</span><span class='line'>o- portals ............................................................................................................ [Portals: 1]
</span><span class='line'>  o- [::0]:3260 ............................................................................................................... [OK]
</span><span class='line'>/iscsi/iqn.20.../tpg1/portals> exit&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>netstat -antp | grep 3260&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>tcp6       0      0 :::3260                 :::*                    LISTEN</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>It appears the target is listening only on IPv6 but in fact it will
also accept connections over IPv4. I've tried it.</p>

<p>This is a bit counter intuitive, however if you try adding the IPv6 address
without removing the default IPv4 one <em>targetcli</em> will throw an error:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/iscsi/iqn.20.../tpg1/portals> create ::0
</span><span class='line'>Using default IP port 3260
</span><span class='line'>Could not create NetworkPortal in configFS.
</span><span class='line'>/></span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>For more information about <em>targetcli</em> usage see my previous post
<a href="/blog/2015/04/07/how-to-configure-iscsi-target-on-red-hat-enterprise-linux-7/">How to Configure iSCSI Target on Red Hat Enterprise Linux 7</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Configure iSCSI Target on Red Hat Enterprise Linux 7]]></title>
    <link href="http://atodorov.org/blog/2015/04/07/how-to-configure-iscsi-target-on-red-hat-enterprise-linux-7/"/>
    <updated>2015-04-07T15:52:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/04/07/how-to-configure-iscsi-target-on-red-hat-enterprise-linux-7</id>
    <content type="html"><![CDATA[<p>Linux-IO (LIO) Target is an open-source implementation of the SCSI target that
has become the standard one included in the Linux kernel and the one present in
Red Hat Enterprise Linux 7. The popular <em>scsi-target-utils</em> package is replaced
by the newer <em>targetcli</em> which makes configuring a software iSCSI target quite
different.</p>

<p>In earlier versions one had to edit the <code>/etc/tgtd/targets.conf</code> file and
<code>service tgtd restart</code>. Here is an example configuration:</p>

<pre><code>&lt;target iqn.2008-09.com.example:server.target1&gt;
    backing-store /dev/vg_iscsi/lv_lun1
    backing-store /dev/vg_iscsi/lv_lun2

    incominguser user2 secretpass23
    outgoinguser userA secretpassA
&lt;/target&gt;
</code></pre>

<p><em>targetcli</em> can be used either as an interactive shell or as stand alone commands.
Here is an example shell session which creates a file-based disk image. Comments are
provided inline:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>yum install -y targetcli&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>systemctl enable target&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>targetcli&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>first create a disk image with the name of disk1. All files are sparsely created.&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/> backstores/fileio create disk1 /var/lib/libvirt/images/disk1.img 10G
</span><span class='line'>Created fileio disk1 with size 10737418240&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>create an iSCSI target. NB: this only defines the target&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/> iscsi/ create iqn.2015-04.com.example:target1
</span><span class='line'>Created target iqn.2015-04.com.example:target1.
</span><span class='line'>Created TPG 1.
</span><span class='line'>Global pref auto_add_default_portal=true
</span><span class='line'>Created default portal listening on all IPs (0.0.0.0), port 3260.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>TPGs (Target Portal Groups) allow the iSCSI to support multiple complete&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>configurations within one target. This is useful for complex quality-of-service&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>configurations. targetcli will automatically create one TPG when the target&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>is created, and almost all setups only need one.&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>switch to TPG definition for our target&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/> cd iscsi/iqn.2015-04.com.example:target1/tpg1&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>list the contents&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/iscsi/iqn.20...:target1/tpg1> ls
</span><span class='line'>o- tpg1 ..................................................................................................... [no-gen-acls, no-auth]
</span><span class='line'>  o- acls ................................................................................................................ [ACLs: 0]
</span><span class='line'>  o- luns ................................................................................................................ [LUNs: 0]
</span><span class='line'>  o- portals .......................................................................................................... [Portals: 1]&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>o- 0.0.0.0:3260 ........................................................................................................... [OK]
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;h1>create a portal aka IP:port pairs which expose the target on the network&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/iscsi/iqn.20...:target1/tpg1> portals/ create
</span><span class='line'>Using default IP port 3260
</span><span class='line'>Binding to INADDR_ANY (0.0.0.0)
</span><span class='line'>This NetworkPortal already exists in configFS.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>create logical units (LUNs) aka disks inside our target&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>in other words bind the target to its on-disk storage&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/iscsi/iqn.20...:target1/tpg1> luns/ create /backstores/fileio/disk1
</span><span class='line'>Created LUN 0.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>disable authentication&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/iscsi/iqn.20...:target1/tpg1> set attribute authentication=0
</span><span class='line'>Parameter authentication is now '0'.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>enable read/write mode&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/iscsi/iqn.20...:target1/tpg1> set attribute demo_mode_write_protect=0
</span><span class='line'>Parameter demo_mode_write_protect is now '0'.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Enable generate_node_acls mode. This can be thought of as&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>"ignore ACLs mode" -- both  authentication and LUN mapping&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>will then use the TPG settings.&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/iscsi/iqn.20...:target1/tpg1> set attribute generate_node_acls=1
</span><span class='line'>Parameter generate_node_acls is now '1'.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>/iscsi/iqn.20...:target1/tpg1> ls
</span><span class='line'>o- tpg1 ........................................................................................................ [gen-acls, no-auth]
</span><span class='line'>  o- acls ................................................................................................................ [ACLs: 0]
</span><span class='line'>  o- luns ................................................................................................................ [LUNs: 1]
</span><span class='line'>  | o- lun0 ..................................................................... [fileio/disk1 (/var/lib/libvirt/images/disk1.img)]
</span><span class='line'>  o- portals .......................................................................................................... [Portals: 1]&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>o- 0.0.0.0:3260 ........................................................................................................... [OK]
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;h1>exit or Ctrl+D will save the configuration under /etc/target/saveconfig.json&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/iscsi/iqn.20...:target1/tpg1> exit
</span><span class='line'>Global pref auto_save_on_exit=true
</span><span class='line'>Last 10 configs saved in /etc/target/backup.
</span><span class='line'>Configuration saved to /etc/target/saveconfig.json&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>after creating a second target the layout looks like this&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/> ls
</span><span class='line'>o- / ......................................................................................................................... [...]
</span><span class='line'>  o- backstores .............................................................................................................. [...]
</span><span class='line'>  | o- block .................................................................................................. [Storage Objects: 0]
</span><span class='line'>  | o- fileio ................................................................................................. [Storage Objects: 2]
</span><span class='line'>  | | o- disk1 .................................................. [/var/lib/libvirt/images/disk1.img (10.0GiB) write-back activated]
</span><span class='line'>  | | o- disk2 .................................................. [/var/lib/libvirt/images/disk2.img (10.0GiB) write-back activated]
</span><span class='line'>  | o- pscsi .................................................................................................. [Storage Objects: 0]
</span><span class='line'>  | o- ramdisk ................................................................................................ [Storage Objects: 0]
</span><span class='line'>  o- iscsi ............................................................................................................ [Targets: 2]
</span><span class='line'>  | o- iqn.2015-04.com.example:target1 ................................................................................... [TPGs: 1]
</span><span class='line'>  | | o- tpg1 .................................................................................................. [gen-acls, no-auth]
</span><span class='line'>  | |   o- acls .......................................................................................................... [ACLs: 0]
</span><span class='line'>  | |   o- luns .......................................................................................................... [LUNs: 1]
</span><span class='line'>  | |   | o- lun0 ............................................................... [fileio/disk1 (/var/lib/libvirt/images/disk1.img)]
</span><span class='line'>  | |   o- portals .................................................................................................... [Portals: 1]
</span><span class='line'>  | |     o- 0.0.0.0:3260 ..................................................................................................... [OK]
</span><span class='line'>  | o- iqn.2015-04.com.example:target2 ................................................................................... [TPGs: 1]
</span><span class='line'>  |   o- tpg1 .................................................................................................. [gen-acls, no-auth]
</span><span class='line'>  |     o- acls .......................................................................................................... [ACLs: 0]
</span><span class='line'>  |     o- luns .......................................................................................................... [LUNs: 1]
</span><span class='line'>  |     | o- lun0 ............................................................... [fileio/disk2 (/var/lib/libvirt/images/disk2.img)]
</span><span class='line'>  |     o- portals .................................................................................................... [Portals: 1]
</span><span class='line'>  |       o- 0.0.0.0:3260 ..................................................................................................... [OK]
</span><span class='line'>  o- loopback ......................................................................................................... [Targets: 0]&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>enable CHAP and Reverse CHAP (mutual) for both discovery and login authentication&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>discovery authentication is enabled under the global iscsi node&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/> cd /iscsi
</span><span class='line'>/iscsi> set discovery_auth enable=1
</span><span class='line'>/iscsi> set discovery_auth userid=IncomingUser
</span><span class='line'>/iscsi> set discovery_auth password=SomePassword1
</span><span class='line'>/iscsi> set discovery_auth mutual_userid=OutgoingUser
</span><span class='line'>/iscsi> set discovery_auth mutual_password=AnotherPassword2&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>login authentication is enabled either under the TPG node or under ACLs&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/iscsi> cd iqn.2015-04.com.example:target1/tpg1
</span><span class='line'>/iscsi/iqn.20...:target1/tpg1> set attribute authentication=1
</span><span class='line'>/iscsi/iqn.20...:target1/tpg1> set auth userid=IncomingUser2
</span><span class='line'>/iscsi/iqn.20...:target1/tpg1> set auth password=SomePassword3
</span><span class='line'>/iscsi/iqn.20...:target1/tpg1> set auth mutual_userid=OutgoingUser2
</span><span class='line'>/iscsi/iqn.20...:target1/tpg1> set auth mutual_password=AnotherPassword4
</span><span class='line'>/iscsi/iqn.20...:target1/tpg1> exit&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Hints:</p>

<ul>
<li>activating targetcli service at boot is mandatory, otherwise your configuration won’t be read after a reboot</li>
<li>if you type <code>cd</code> <em>targetcli</em> will display an interactive node tree</li>
<li>after configuration is saved you don't need to restart anything</li>
<li>the old <em>scsi-target-utils</em> doesn't support discovery authentication</li>
<li><em>targetcli</em> allows kernel memory to be shared as a block SCSI device via the
ramdisk backstore. It also supports "nullio" mode, which discards all writes, and returns all-zeroes for reads.</li>
<li>I'm having troubles configuring portals to listen both on any IPv4 addresses and any IPv6 addresses
the system has. I've still not figured that out entirely.</li>
</ul>


<p>For more information please read Chapter 25 from Red Hat's
<a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Storage_Administration_Guide/ch25.html">Storage Administration Guide</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SNAKE is no Longer Needed to Run Installation Tests in Beaker]]></title>
    <link href="http://atodorov.org/blog/2014/07/18/snake-is-no-longer-needed-to-run-installation-tests-in-beaker/"/>
    <updated>2014-07-18T23:05:00+03:00</updated>
    <id>http://atodorov.org/blog/2014/07/18/snake-is-no-longer-needed-to-run-installation-tests-in-beaker</id>
    <content type="html"><![CDATA[<p>This is a quick status update for one of the pieces of
<a href="/blog/2013/11/19/open-source-quality-assurance-infrastructure-for-fedora-qa/">Fedora QA infrastructure</a>
and mostly a self-note.</p>

<p>Previously to control the kickstart configuration used during installation in Beaker one
had to either modify the job XML in Beaker or use SNAKE (<code>bkr workflow-snake</code>) to render
a kickstart configuration from a Python template.</p>

<p>SNAKE presented challenges when deploying and using
<a href="https://beaker.fedoraproject.org">beaker.fedoraproject.org</a> and is
virtually unmaintained.</p>

<p>I present the new <code>bkr workflow-installer-test</code> which uses Jinja2 templates to
generate a kickstart configuration when provisioning the system. This is already
available in beaker-client-0.17.1.</p>

<p>The templates make use of all Jinja2 features (as far as I can tell) so you can create
very complex ones. You can even include snippets from one template into another if required.
The standard context that is passed to the template is:</p>

<ul>
<li><strong>DISTRO</strong> - if specified, the distro name</li>
<li><strong>FAMILY</strong> - as returned by Beaker server, e.g. <em>RedHatEnterpriseLinux6</em></li>
<li><strong>OS_MAJOR</strong> and <strong>OS_MINOR</strong> - also taken from Beaker server. e.g. OS_MAJOR=6 and OS_MINOR=5 for RHEL 6.5</li>
<li><strong>VARIANT</strong> - if specified</li>
<li><strong>ARCH</strong> - CPU architecture like x86_64</li>
<li>any parameters passed to the test job with <code>--taskparam</code>. They are processed last and can override previous values.</li>
</ul>


<p>Installation related tests at <a href="https://bitbucket.org/fedoraqa/fedora-beaker-tests">fedora-beaker-tests</a>
have been updated with a <code>ks.cfg.tmpl</code> templates to use with this new workflow.</p>

<p>This workflow also has the ability to return boot arguments for the installer if needed.
If any, they should be defined in a {% block kernel_options %}{% endblock %}
block inside the template. A simpler variant is to define a comment line that stars with
<em>## kernel_options:</em></p>

<p>There are still a few issues which need to be fixed before beaker.fedoraproject.org
can be used by the general public though. I will be writing another post about that
so stay tuned.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Book Review - Last 3 Months]]></title>
    <link href="http://atodorov.org/blog/2014/05/13/book-review-last-3-months/"/>
    <updated>2014-05-13T23:57:00+03:00</updated>
    <id>http://atodorov.org/blog/2014/05/13/book-review-last-3-months</id>
    <content type="html"><![CDATA[<p>Hello folks, this is my book list for the past 3 months. It ranges from
tech and start-up related to Japanese and kid stories. Here's my quick review.</p>

<h2>Lean UX</h2>

<p><a href="http://www.amazon.com/gp/product/1449311652/ref=as_li_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=1449311652&linkCode=as2&tag=atodorovorg-20&linkId=JNQIKHJJXU3KJ33H">Lean UX: Applying Lean Principles to Improve User Experience</a><img src="http://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=1449311652" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
is the second book I read on the subject after first reading
<a href="/blog/2013/12/09/book-review-ux-for-lean-startups/">UX for Lean Startups</a>.</p>

<p>It is published before <em>UX for Lean Startups</em> and is much more about principles than
any practical methods. Honestly I'm not sure if I took any real value out of it.
Maybe if I had read these two books in reverse order it would have been better.</p>

<h2>The Hacienda - How Not to Run a Club</h2>

<p><a href="http://www.amazon.com/gp/product/B00DEKLESK/ref=as_li_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=B00DEKLESK&linkCode=as2&tag=atodorovorg-20&linkId=FOMGYFQW4BHGPPOL">The Hacienda: How Not to Run a Club</a><img src="http://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=B00DEKLESK" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
by Peter Hook is one of my favorites. It covers a great deal of music and clubland history,
depicts crazy parties and describes the adventure of owning one of the most
popular nightclubs in the world. All of that while struggling to make a buck and
pouring countless pounds into a black hole.</p>

<p>The irony is The Hacienda became a legendary place only after it had closed down
and later on being demolished.</p>

<p>A must read for anyone who is considering business in the entertainment industry
or wants to read a piece of history. My favorite quote of the book:</p>

<p><blockquote><p>Years after, Tony Wilson found himself sitting opposite Madonna at dinner.</p></p><p><p>‘I eventually plucked up the courage to look across the table to Madonna and ask,<br/>“Are you aware that the first place you appeared outside of New York was our club in Manchester?”</p></p><p><p>‘She gave me an ice-cold stare and said, “My memory seems to have wiped that.”’</p></blockquote></p>

<h2>Simple Science Experiments</h2>

<p><a href="http://www.amazon.com/gp/product/0713428945/ref=as_li_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0713428945&linkCode=as2&tag=atodorovorg-20&linkId=HU6TVCNR6DG67EFG">Simple Science Experiments</a><img src="http://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=0713428945" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
by Hans Jürgen Press is a very old book listing 200 experiments which you can
do at home using household materials. It is great for teaching basic science
to children. The book is very popular and is available in many languages
and editions - just search for it.</p>

<p>I used to have this as a kid and was able to purchase the 1987 Bulgarian edition
at an antique bookstore in Varna two months ago.</p>

<h2>Ronia, the Robber's Daughter</h2>

<p>Decided to experiment a little bit and found
<a href="http://www.amazon.com/gp/product/0140317201/ref=as_li_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0140317201&linkCode=as2&tag=atodorovorg-20&linkId=FDHOPXQCZPMYCAA2">Ronia, the Robber's Daughter</a><img src="http://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=0140317201" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />.
It's a child's book telling the story of two kids whose fathers are rival
robbers. The book is an easy read (2-3 hrs before bed time) with stories
of magic woods, dwarfs and scary creatures mixed with human emotions
and the good vs. bad theme.</p>

<h2>Japanese Short Stories</h2>

<p>I've managed to find a 1973 compilation of Japanese short stories
translated into Bulgarian. Also one of my favorite books.</p>

<p>If I'm not mistaken these are classic
Japanese authors, nothing modern or cutting edge. Most of the action happens
during the early 1900s as far as I can tell.
What impresses me most is the detailed description of nature and
surrounding details in all of the stories.</p>

<h2>The Singularity Is Near</h2>

<p>I've also started
<a href="http://www.amazon.com/gp/product/0143037889/ref=as_li_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0143037889&linkCode=as2&tag=atodorovorg-20&linkId=BKMQ47NQEXNTDDRR">The Singularity Is Near: When Humans Transcend Biology</a><img src="http://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=0143037889" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
by Ray Kurzweil.</p>

<p>It's a bit hard to read because the book is full of so many technical details
about genetics, nanotechnology, robotics and AI.</p>

<p>Ray depicts a bright future where humans will transcend our biological
limitations and essentially become pure intelligence. Definitely a good
read and I will tell you more about it when I finish it.</p>

<hr />

<p>What have you been reading since January ? I'd love to see your book list
or connect on
<a href="https://www.goodreads.com/user/show/16191345-alexander-todorov">Goodreads</a>.</p>
]]></content>
  </entry>
  
</feed>
