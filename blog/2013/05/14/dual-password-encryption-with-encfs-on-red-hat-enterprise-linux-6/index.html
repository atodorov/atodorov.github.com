
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dual Password Encryption With EncFS On Red Hat Enterprise Linux 6</title>
  <meta name="author" content="Alexander Todorov">

  
  <meta name="description" content="This article is a step-by-step guide to using two passwords with EncFS.
The primary password is required and may be used to secure all data;
the &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://atodorov.org/blog/2013/05/14/dual-password-encryption-with-encfs-on-red-hat-enterprise-linux-6/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/atodorov" rel="alternate" title="atodorov.org" type="application/atom+xml">
  <script type="text/javascript">
// (c) 2013 - Alexander Todorov, http://atodorov.org
// Published under GNU GPLv3
var uri = window.location.toString();
if (uri.indexOf("?") > 0) {
    var clean_uri = uri.substring(0, uri.indexOf("?"));
    window.history.replaceState({}, document.title, clean_uri);
}
</script>
<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=Russo+One" rel="stylesheet" type="text/css" />

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37979549-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
<div id="logo-container">
<div id="logo">atodorov.org</div>
<div id="logo-sub"><em></em></div>
</div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/atodorov" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:atodorov.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/give-away/">Give Away List</a></li>
  <li><a href="/projects/">Projects</a></li>
  <li><a href="/about/">About Me</a></li>
  <li><a href="http://amzn.to/11ep6dD">Now reading: The E-Myth Revisited: Why Most Small Businesses Don't Work ...</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Dual Password Encryption With EncFS on Red Hat Enterprise Linux 6</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-05-14T21:26:00+03:00" pubdate data-updated="true">May 14<span>th</span>, 2013</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>This article is a step-by-step guide to using two passwords with <a href="http://www.arg0.net/encfs">EncFS</a>.
The primary password is required and may be used to secure all data;
the secondary password is optional and may be stored on USB stick or
other removable media and used to secure more sensitive data.</p>

<p><img src="/images/encfs_raleigh.jpg" alt="Article in Raleigh" style="clear:both;display:block;"/>
The original article in Red Hat&#8217;s Raleigh HQ!</p>

<p>This article has been originally written for and published by
<a href="http://magazine.redhat.com/2007/06/13/dual-password-encryption-with-encfs/">Red Hat Magazine</a>.
Here is a shortened version with updated commands for Red Hat Enterprise Linux 6.</p>

<h2>Technical Information</h2>

<p>EncFS provides an encrypted filesystem in user-space. EncFS provides security
against offline attacks like a stolen notebook.
EncFS works on files and directories, not an entire block device.
It modifies file names and contents.
The data is stored on the underlying filesystem and meta-data is preserved.
File attributes such as ownership, modification date and permission bits are not encrypted
and are visible to anybody. EncFS is acting like a translator between the user and
the filesystem, encrypting and decrypting on the fly.</p>

<p>EncFS is easy to use and requires no special setup. A local user has to be in the ‘fuse’
group to use EncFS. It does not require ‘root’ privileges.
EncFS can be used with secondary passwords. This could be used to store a separate set of files on the same encrypted filesystem.
EncFS ignores files which do not decode properly, so files created with separate passwords will
only be visible when the filesystem is mounted with the associated password.
There is the option to read passwords from an external program or stdin (standard input).
This option combined with custom scripting makes EncFS very flexible.
By default, all FUSE based filesystems are visible only to the user who mounted them.
No other users (including root) can view the filesystem contents.</p>

<h2>Installing EncFS</h2>

<p>Install fuse-encfs from <a href="https://fedoraproject.org/wiki/EPEL">EPEL</a>:</p>

<pre><code># yum install fuse-encfs
</code></pre>

<p>Load the FUSE module:</p>

<pre><code># /sbin/modprobe fuse
</code></pre>

<p>And, finally, add any users that will use EncFS to group ‘fuse’:</p>

<pre><code># usermod -Gfuse jdoe
</code></pre>

<h2>Using EncFS</h2>

<p>Using EncFS does not differ from using any other filesystem.
The only thing you need to do is to mount it somewhere and start creating
files and directories under the mount point.</p>

<p><strong>Warning:</strong> Use only absolute path names with EncFS!</p>

<p>Create working directories:</p>

<pre><code>$ mkdir -p ~/encrypted ~/plain
</code></pre>

<ul>
<li><code>plain/</code> – looks like a normal directory. All files stored here look like normal
files for the user who mounted this directory with EncFS. This acts like a virtual
directory performing encryption and decryption.</li>
<li><code>encrypted/</code> – looks garbled. The actual data is stored here and is encrypted.</li>
</ul>


<p>Now you can mount the new EncFS volume for the first time. This assumes a default configuration:</p>

<pre><code>$ encfs /home/jdoe/encrypted /home/jdoe/plain
Creating new encrypted volume.
Please choose from one of the following options:
 enter "x" for expert configuration mode,
 enter "p" for pre-configured paranoia mode,
 anything else, or an empty line will select standard mode.
?&gt; 

Standard configuration selected.

Configuration finished.  The filesystem to be created has
the following properties:
Filesystem cipher: "ssl/aes", version 3:0:2
Filename encoding: "nameio/block", version 3:0:1
Key Size: 192 bits
Block Size: 1024 bytes
Each file contains 8 byte header with unique IV data.
Filenames encoded using IV chaining mode.
File holes passed through to ciphertext.

Now you will need to enter a password for your filesystem.
You will need to remember this password, as there is absolutely
no recovery mechanism.  However, the password can be changed
later using encfsctl.

New Encfs Password: **********
Verify Encfs Password: **********
</code></pre>

<p>Create a file:</p>

<pre><code>$ echo "some content" &gt; ~/plain/file.one
</code></pre>

<p>Check contents in <code>plain/</code>:</p>

<pre><code>$ ls -la ~/plain/
total 12
drwxrwxr-x. 2 jdoe jdoe 4096 May 14 21:31 .
drwx------. 6 jdoe jdoe 4096 May 14 21:29 ..
-rw-rw-r--. 1 jdoe jdoe   13 May 14 21:31 file.one

$ cat ~/plain/file.one 
some content
</code></pre>

<p>Check what’s in <code>encrypted/</code>:</p>

<pre><code>$ ls -la ~/encrypted/
total 16
drwxrwxr-x. 2 jdoe jdoe 4096 May 14 21:31 .
drwx------. 6 jdoe jdoe 4096 May 14 21:29 ..
-rw-rw-r--. 1 jdoe jdoe 1083 May 14 21:30 .encfs6.xml
-rw-rw-r--. 1 jdoe jdoe   21 May 14 21:31 Wq5NZ6q-yP-fYNWYsjzFhHf9
</code></pre>

<p><strong>Warning:</strong> <code>.encfs6.xml</code> is a special file. When performing backups or restoring data,
make sure to keep this file!</p>

<p>Inspect the contents of encrypted file:</p>

<pre><code>$ cat ~/encrypted/Wq5NZ6q-yP-fYNWYsjzFhHf9 
���r�N�M���"p��
</code></pre>

<p>Unmount the filesystem and mount it again with another password:</p>

<pre><code>$ fusermount -u ~/plain/
$ encfs --anykey /home/jdoe/encrypted /home/jdoe/plain
EncFS Password: *****
</code></pre>

<p><strong>Caution:</strong> We are using the &#8211;anykey option to allow secondary passwords.</p>

<p>Check <code>plain/</code> again. The directory is empty. Previous files were not decoded with the new password.</p>

<pre><code>$ ls -la ~/plain/
total 8
drwxrwxr-x. 2 jdoe jdoe 4096 May 14 21:31 .
drwx------. 6 jdoe jdoe 4096 May 14 21:29 ..
</code></pre>

<p>Now create another file that will be in “hidden” mode:</p>

<pre><code>$ echo "hidden contents" &gt; ~/plain/file.two
</code></pre>

<p>Check again what’s in <code>encrypted/</code>. Both files are stored in the same directory:</p>

<pre><code>$ ls -la ~/encrypted/
total 20
drwxrwxr-x. 2 jdoe jdoe 4096 May 14 21:35 .
drwx------. 6 jdoe jdoe 4096 May 14 21:29 ..
-rw-rw-r--. 1 jdoe jdoe 1083 May 14 21:30 .encfs6.xml
-rw-rw-r--. 1 jdoe jdoe   24 May 14 21:35 PfkZHs16YsKkznnTujaVsOuS
-rw-rw-r--. 1 jdoe jdoe   21 May 14 21:31 Wq5NZ6q-yP-fYNWYsjzFhHf9
</code></pre>

<p>Unmount and mount again using the first password:</p>

<pre><code>$ fusermount -u ~/plain/
$ encfs --anykey /home/jdoe/encrypted /home/jdoe/plain
EncFS Password: **********
</code></pre>

<p>Inspect the contents of <code>plain/</code> again. The second file was not decoded properly and is not shown:</p>

<pre><code>$ ls -la ~/plain/
total 12
drwxrwxr-x. 2 jdoe jdoe 4096 May 14 21:35 .
drwx------. 6 jdoe jdoe 4096 May 14 21:29 ..
-rw-rw-r--. 1 jdoe jdoe   13 May 14 21:31 file.one
</code></pre>

<h2>Summary</h2>

<p>You have learned how to use encryption to protect your data.
There is also a nice graphical application
for using EncFS with KDE called <a href="http://kde-apps.org/content/show.php?content=54078">K-EncFS</a>.
I&#8217;ll be happy to answer any questions or comments.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Alexander Todorov</span></span>

      








  


<time datetime="2013-05-14T21:26:00+03:00" pubdate data-updated="true">May 14<span>th</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/rhel/'>RHEL</a>
  
</span>


    </p>
    
      <div class="sharing">
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style addthis_32x32_style">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_preferred_5"></a>
<a class="addthis_button_preferred_6"></a>
<a class="addthis_button_preferred_7"></a>
<a class="addthis_button_preferred_8"></a>
<a class="addthis_button_preferred_9"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5103cc5a2bc6ba17"></script>
<!-- AddThis Button END -->
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/05/02/why-instagram-could-not-be-founded-in-europe/" title="Previous Post: Why Instagram Could Not Be Founded In Europe">&laquo; Why Instagram Could Not Be Founded In Europe</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/05/17/linux-and-python-tools-to-compare-images/" title="Next Post: Linux and Python Tools To Compare Images">Linux and Python Tools To Compare Images &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    
<section>
  
  <a href="https://github.com/atodorov">@atodorov</a> on GitHub
  
</section>


<section>
  
    <a href="http://twitter.com/atodorov_" class="twitter-follow-button" data-show-count="true">Follow @atodorov_</a>
  

  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("atodorov_", 5, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
</section>

<section>
    <h1>Trending Posts</h1>
<!-- AddThis Trending Content BEGIN -->
<div id="addthis_trendingcontent"></div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5103cc5a2bc6ba17"></script>
<script type="text/javascript">
addthis.box("#addthis_trendingcontent", {
    feed_title : "",
    feed_type : "trending",
    feed_period : "month",
    num_links : 5,
    height : "auto",
    width : "auto"});
</script>
<!-- AddThis Trending Content END -->
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/05/27/it-jobs-prediction-quality-engineering-devops-augmented-reality/">IT Jobs Prediction: Quality Engineering, DevOps, Augmented Reality</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/23/balkan-venture-forum-sofia-post-mortem/">Balkan Venture Forum Sofia Post-mortem</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/17/linux-and-python-tools-to-compare-images/">Linux and Python Tools To Compare Images</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/14/dual-password-encryption-with-encfs-on-red-hat-enterprise-linux-6/">Dual Password Encryption With EncFS On Red Hat Enterprise Linux 6</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/02/why-instagram-could-not-be-founded-in-europe/">Why Instagram Could Not Be Founded In Europe</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/27/the-best-it-school-in-bulgaria/">The Best IT School in Bulgaria</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/26/personal-experience-with-credit-card-fraud/">Personal Experience With Credit Card Fraud</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/24/how-to-deploy-python-hotfix-on-redhat-openshift-cloud/">How to Deploy Python Hotfix on RedHat OpenShift Cloud</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/23/what-runs-your-startup-deed/">What Runs Your Start-up - Deed</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/19/hackfmi-code-stats/">HackFMI Code Stats</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Disclaimer</h1>
  <p>
Some of the links contained within this site have my referral id (e.g., Amazon), which provides me with a small commission for each sale. Thank you for your support.
  </p>
</section>
<section>
<h1></h1>
<iframe width="260" height="420" scrolling="no" frameborder="no" allowtransparency="true" src="http://www.econt.com/voffice/en/240x400/?mediator=http%3A%2F%2Fatodorov.org"></iframe>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">CC-BY-SA</a>
  &amp;
  <a rel="license" href="http://opensource.org/licenses/MIT">MIT</a>
  2013 - Alexander Todorov
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'atodorov';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://atodorov.org/blog/2013/05/14/dual-password-encryption-with-encfs-on-red-hat-enterprise-linux-6/';
        var disqus_url = 'http://atodorov.org/blog/2013/05/14/dual-password-encryption-with-encfs-on-red-hat-enterprise-linux-6/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
