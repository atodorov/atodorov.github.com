<!DOCTYPE html>
<html lang="en">

<head>
            <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="">

            <meta name="google-site-verification" content="XynqZtldWNBbmsynVQZremIxaaO8Wgs6AGR8UZ7KIkM">

        <title> Dual Password Encryption With EncFS On Red Hat Enterprise Linux 6</title>

            <link href="http://feeds.feedburner.com/atodorov" type="application/atom+xml" rel="alternate" title="atodorov.org Full Atom Feed" />

        <!-- Bootstrap Core CSS -->
        <link href="http://atodorov.org/theme/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom CSS -->
        <link href="http://atodorov.org/theme/css/clean-blog.min.css" rel="stylesheet">
        <link href="http://atodorov.org/override.css" rel="stylesheet">

        <!-- Code highlight color scheme -->
            <link href="http://atodorov.org/theme/css/code_blocks/github.css" rel="stylesheet">

        <!-- Custom Fonts -->
        <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->




        <meta name="tags" content="RHEL" >


			<meta property="og:locale" content="en">
		<meta property="og:site_name" content="atodorov.org">

	<meta property="og:type" content="article">
	<meta property="article:author" content="">
	<meta property="og:url" content="http://atodorov.org/blog/2013/05/14/dual-password-encryption-with-encfs-on-red-hat-enterprise-linux-6/">
	<meta property="og:title" content="Dual Password Encryption With EncFS On Red Hat Enterprise Linux 6">
            <meta property="og:description" content="This article is a step-by-step guide to using two passwords with EncFS. The primary password is required and may be used to secure all ...">
	<meta property="article:published_time" content="2013-05-14 21:26:00+03:00">
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://atodorov.org/">atodorov.org</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">

                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
        <header class="intro-header" style="background-image: url('/images/header_02.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Dual Password Encryption With EncFS On Red Hat Enterprise Linux 6</h1>
                        <span class="meta">Posted by
                                <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                             on Tue 14 May 2013
                        </span>
                        
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
    <!-- Post Content -->
    <article>
        <p>This article is a step-by-step guide to using two passwords with <a href="http://www.arg0.net/encfs">EncFS</a>.
The primary password is required and may be used to secure all data;
the secondary password is optional and may be stored on USB stick or
other removable media and used to secure more sensitive data. </p>
<p><img src="/images/encfs_raleigh.jpg" alt="Article in Raleigh" style="clear:both;display:block;"/>
The original article in Red Hat's Raleigh HQ!</p>
<p>This article has been originally written for and published by
<a href="http://magazine.redhat.com/2007/06/13/dual-password-encryption-with-encfs/">Red Hat Magazine</a>.
Here is a shortened version with updated commands for Red Hat Enterprise Linux 6.</p>
<h2>Technical Information</h2>
<p>EncFS provides an encrypted filesystem in user-space. EncFS provides security
against offline attacks like a stolen notebook.
EncFS works on files and directories, not an entire block device.
It modifies file names and contents.
The data is stored on the underlying filesystem and meta-data is preserved.
File attributes such as ownership, modification date and permission bits are not encrypted
and are visible to anybody. EncFS is acting like a translator between the user and
the filesystem, encrypting and decrypting on the fly.</p>
<p>EncFS is easy to use and requires no special setup. A local user has to be in the ‘fuse’
group to use EncFS. It does not require ‘root’ privileges.
EncFS can be used with secondary passwords. This could be used to store a separate set of files on the same encrypted filesystem. 
EncFS ignores files which do not decode properly, so files created with separate passwords will 
only be visible when the filesystem is mounted with the associated password.
There is the option to read passwords from an external program or stdin (standard input). 
This option combined with custom scripting makes EncFS very flexible.
By default, all FUSE based filesystems are visible only to the user who mounted them. 
No other users (including root) can view the filesystem contents.</p>
<h2>Installing EncFS</h2>
<p>Install fuse-encfs from <a href="https://fedoraproject.org/wiki/EPEL">EPEL</a>:</p>
<div class="highlight"><pre># yum install fuse-encfs
</pre></div>


<p>Load the FUSE module:</p>
<div class="highlight"><pre># /sbin/modprobe fuse
</pre></div>


<p>And, finally, add any users that will use EncFS to group ‘fuse’:</p>
<div class="highlight"><pre># usermod -Gfuse jdoe
</pre></div>


<h2>Using EncFS</h2>
<p>Using EncFS does not differ from using any other filesystem.
The only thing you need to do is to mount it somewhere and start creating 
files and directories under the mount point.</p>
<p><strong>Warning:</strong> Use only absolute path names with EncFS!</p>
<p>Create working directories:</p>
<div class="highlight"><pre><span class="nv">$ </span>mkdir -p ~/encrypted ~/plain
</pre></div>


<ul>
<li><code>plain/</code> – looks like a normal directory. All files stored here look like normal
files for the user who mounted this directory with EncFS. This acts like a virtual
directory performing encryption and decryption.</li>
<li><code>encrypted/</code> – looks garbled. The actual data is stored here and is encrypted.</li>
</ul>
<p>Now you can mount the new EncFS volume for the first time. This assumes a default configuration:</p>
<div class="highlight"><pre><span class="nv">$ </span>encfs /home/jdoe/encrypted /home/jdoe/plain
Creating new encrypted volume.
Please choose from one of the following options:
 enter <span class="s2">&quot;x&quot;</span> <span class="k">for</span> expert configuration mode,
 enter <span class="s2">&quot;p&quot;</span> <span class="k">for</span> pre-configured paranoia mode,
 anything <span class="k">else</span>, or an empty line will <span class="k">select</span> standard mode.
?&gt; 

Standard configuration selected.

Configuration finished.  The filesystem to be created has
the following properties:
Filesystem cipher: <span class="s2">&quot;ssl/aes&quot;</span>, version 3:0:2
Filename encoding: <span class="s2">&quot;nameio/block&quot;</span>, version 3:0:1
Key Size: <span class="m">192</span> bits
Block Size: <span class="m">1024</span> bytes
Each file contains <span class="m">8</span> byte header with unique IV data.
Filenames encoded using IV chaining mode.
File holes passed through to ciphertext.

Now you will need to enter a password <span class="k">for</span> your filesystem.
You will need to remember this password, as there is absolutely
no recovery mechanism.  However, the password can be changed
later using encfsctl.

New Encfs Password: **********
Verify Encfs Password: **********
</pre></div>


<p>Create a file:</p>
<div class="highlight"><pre><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;some content&quot;</span> &gt; ~/plain/file.one
</pre></div>


<p>Check contents in <code>plain/</code>:</p>
<div class="highlight"><pre><span class="nv">$ </span>ls -la ~/plain/
total 12
drwxrwxr-x. <span class="m">2</span> jdoe jdoe <span class="m">4096</span> May <span class="m">14</span> 21:31 .
drwx------. <span class="m">6</span> jdoe jdoe <span class="m">4096</span> May <span class="m">14</span> 21:29 ..
-rw-rw-r--. <span class="m">1</span> jdoe jdoe   <span class="m">13</span> May <span class="m">14</span> 21:31 file.one

<span class="nv">$ </span>cat ~/plain/file.one 
some content
</pre></div>


<p>Check what’s in <code>encrypted/</code>:</p>
<div class="highlight"><pre><span class="nv">$ </span>ls -la ~/encrypted/
total 16
drwxrwxr-x. <span class="m">2</span> jdoe jdoe <span class="m">4096</span> May <span class="m">14</span> 21:31 .
drwx------. <span class="m">6</span> jdoe jdoe <span class="m">4096</span> May <span class="m">14</span> 21:29 ..
-rw-rw-r--. <span class="m">1</span> jdoe jdoe <span class="m">1083</span> May <span class="m">14</span> 21:30 .encfs6.xml
-rw-rw-r--. <span class="m">1</span> jdoe jdoe   <span class="m">21</span> May <span class="m">14</span> 21:31 Wq5NZ6q-yP-fYNWYsjzFhHf9
</pre></div>


<p><strong>Warning:</strong> <code>.encfs6.xml</code> is a special file. When performing backups or restoring data,
make sure to keep this file!</p>
<p>Inspect the contents of encrypted file:</p>
<div class="highlight"><pre><span class="nv">$ </span>cat ~/encrypted/Wq5NZ6q-yP-fYNWYsjzFhHf9 
���r�N�M���<span class="s2">&quot;p��</span>
</pre></div>


<p>Unmount the filesystem and mount it again with another password:</p>
<div class="highlight"><pre><span class="nv">$ </span>fusermount -u ~/plain/
<span class="nv">$ </span>encfs --anykey /home/jdoe/encrypted /home/jdoe/plain
EncFS Password: *****
</pre></div>


<p><strong>Caution:</strong> We are using the --anykey option to allow secondary passwords.</p>
<p>Check <code>plain/</code> again. The directory is empty. Previous files were not decoded with the new password.</p>
<div class="highlight"><pre><span class="nv">$ </span>ls -la ~/plain/
total 8
drwxrwxr-x. <span class="m">2</span> jdoe jdoe <span class="m">4096</span> May <span class="m">14</span> 21:31 .
drwx------. <span class="m">6</span> jdoe jdoe <span class="m">4096</span> May <span class="m">14</span> 21:29 ..
</pre></div>


<p>Now create another file that will be in “hidden” mode:</p>
<div class="highlight"><pre><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;hidden contents&quot;</span> &gt; ~/plain/file.two
</pre></div>


<p>Check again what’s in <code>encrypted/</code>. Both files are stored in the same directory:</p>
<div class="highlight"><pre><span class="nv">$ </span>ls -la ~/encrypted/
total 20
drwxrwxr-x. <span class="m">2</span> jdoe jdoe <span class="m">4096</span> May <span class="m">14</span> 21:35 .
drwx------. <span class="m">6</span> jdoe jdoe <span class="m">4096</span> May <span class="m">14</span> 21:29 ..
-rw-rw-r--. <span class="m">1</span> jdoe jdoe <span class="m">1083</span> May <span class="m">14</span> 21:30 .encfs6.xml
-rw-rw-r--. <span class="m">1</span> jdoe jdoe   <span class="m">24</span> May <span class="m">14</span> 21:35 PfkZHs16YsKkznnTujaVsOuS
-rw-rw-r--. <span class="m">1</span> jdoe jdoe   <span class="m">21</span> May <span class="m">14</span> 21:31 Wq5NZ6q-yP-fYNWYsjzFhHf9
</pre></div>


<p>Unmount and mount again using the first password:</p>
<div class="highlight"><pre><span class="nv">$ </span>fusermount -u ~/plain/
<span class="nv">$ </span>encfs --anykey /home/jdoe/encrypted /home/jdoe/plain
EncFS Password: **********
</pre></div>


<p>Inspect the contents of <code>plain/</code> again. The second file was not decoded properly and is not shown:</p>
<div class="highlight"><pre><span class="nv">$ </span>ls -la ~/plain/
total 12
drwxrwxr-x. <span class="m">2</span> jdoe jdoe <span class="m">4096</span> May <span class="m">14</span> 21:35 .
drwx------. <span class="m">6</span> jdoe jdoe <span class="m">4096</span> May <span class="m">14</span> 21:29 ..
-rw-rw-r--. <span class="m">1</span> jdoe jdoe   <span class="m">13</span> May <span class="m">14</span> 21:31 file.one
</pre></div>


<h2>Summary</h2>
<p>You have learned how to use encryption to protect your data.
There is also a nice graphical application 
for using EncFS with KDE called <a href="http://kde-apps.org/content/show.php?content=54078">K-EncFS</a>.
I'll be happy to answer any questions or comments.</p>
    </article>

        <div class="tags">
            <p>Tags: <a href="http://atodorov.org/blog/categories/rhel/">RHEL</a>, </p>
        </div>

    <div>
        <span>
            <small>
                <em>
                    Please support this blog by 
                    <a target="_blank" href="http://www.amazon.com/ref=as_li_ss_tl?_encoding=UTF8&camp=1789&creative=390957&linkCode=ur2&tag=atodorovorg-20&linkId=L6Q34XAXQS5RDMOY">
                    buying something from Amazon with my referral id
                    </a><img src="https://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=ur2&o=1" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
                    .
                </em>
            </small>
        </span>
    </div>

        <hr>
        <div class="sharing">
            <!-- AddThis Button BEGIN -->
            <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
                <a class="addthis_button_preferred_1"></a>
                <a class="addthis_button_preferred_2"></a>
                <a class="addthis_button_preferred_3"></a>
                <a class="addthis_button_preferred_4"></a>
                <a class="addthis_button_preferred_5"></a>
                <a class="addthis_button_preferred_6"></a>
                <a class="addthis_button_preferred_7"></a>
                <a class="addthis_button_preferred_8"></a>
                <a class="addthis_button_preferred_9"></a>
                <a class="addthis_button_compact"></a>
                <a class="addthis_counter addthis_bubble_style"></a>
            </div>
            <script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5103cc5a2bc6ba17"></script>
            <!-- AddThis Button END -->
        </div>

        <hr>
        <div class="comments">
            <h2>Comments !</h2>
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'atodorov';
                var disqus_identifier = 'blog/2013/05/14/dual-password-encryption-with-encfs-on-red-hat-enterprise-linux-6/';
                var disqus_url = 'http://atodorov.org/blog/2013/05/14/dual-password-encryption-with-encfs-on-red-hat-enterprise-linux-6/';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//atodorov.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
            </div>
        </div>
    </div>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                        <li>
                            <a href="https://twitter.com/atodorov_">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://github.com/atodorov">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>

                        <li>
                            <a href="https://bg.linkedin.com/in/alextodorov">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>


                    <section>
                        <p>
                            I am a QA contractor at Red Hat responsible for over
                            <a href="/blog/2014/02/19/7-years-1400-bugs-red-hat-qa/">1500 bugs</a>,
                            a general purpose open source developer, Red Hat Certified professional,
                            cloud hacker and an entrepreneur!
                        </p>

                        <p>
                            I am living in the <a href="http://planet.sofiavalley.com">Sofia Valley</a>
                            which is emerging as a busy place for start-up founders and tech enthusiasts
                            in Eastern Europe! You can find more about me <a href="/blog/2013/01/25/about-me/">here</a>.
                        </p>

                        <p>
                            <small>
                                <em>
                                    Some of the links contained within this site have my referral id (e.g.,
                                    <a target="_blank" href="http://www.amazon.com/ref=as_li_ss_tl?_encoding=UTF8&camp=1789&creative=390957&linkCode=ur2&tag=atodorovorg-20&linkId=L6Q34XAXQS5RDMOY">Amazon</a><img src="https://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=ur2&o=1" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />),
                                    which provides me with a small commission for each sale. Thank you for your support.
                                </em>
                            </small>
                        </p>
                    </section>

                    <form action="http://google.com/search" method="get" style="width:300px;margin:0 auto;">
                        <fieldset role="search">
                            <input type="hidden" name="sitesearch" value="http://atodorov.org" />
                            <input class="search" type="text" name="q" placeholder="Search" style="width:100%"/>
                        </fieldset>
                    </form>

                    <p class="copyright text-muted">
                        <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">CC-BY-SA</a> &amp;
                        <a rel="license" href="http://opensource.org/licenses/MIT">MIT</a>
                        2011-2015 &diams; Alexander Todorov &diams;
                        <a href="http://planet.sofiavalley.com">SofiaValley Blog</a>
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="http://atodorov.org/theme/js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="http://atodorov.org/theme/js/bootstrap.min.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37979549-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'atodorov';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>

</html>