<!DOCTYPE html>
<html lang="en">

<head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

            <meta name="google-site-verification" content="XynqZtldWNBbmsynVQZremIxaaO8Wgs6AGR8UZ7KIkM">

        <title>atodorov.org - Articles in the _posts category</title>

        <link href="http://feeds.feedburner.com/atodorov" type="application/atom+xml" rel="alternate" title="atodorov.org Full Atom Feed" />
        <!-- Bootstrap Core CSS -->
        <link href="http://atodorov.org/theme/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom CSS -->
        <link href="http://atodorov.org/theme/css/clean-blog.min.css" rel="stylesheet">

        <!-- Code highlight color scheme -->
            <link href="http://atodorov.org/theme/css/code_blocks/github.css" rel="stylesheet">

            <!-- CSS specified by the user -->
            <link href="http://atodorov.org/override.css" rel="stylesheet">

        <!-- Custom Fonts -->
        <link href="http://atodorov.org/theme/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

                <meta property="fb:admins" content="1616937247" >
                <meta property="og:locale" content="en_US">
		<meta property="og:site_name" content="atodorov.org">
            <meta name="twitter:card" content="summary_large_image">
            <meta name="twitter:site" content="@atodorov_">
            <meta name="twitter:title" content="atodorov.org">
            <meta name="twitter:description" content="you can logoff, but you can never leave">
                <meta name="twitter:image" content="http://atodorov.org//images/header_02.jpg">
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://atodorov.org/">atodorov.org</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                        <li><a href="http://mrsenko.com/?utm_source=atodorov.org&utm_medium=blog&utm_campaign=menu">Mr. Senko</a></li>

                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
        <header class="intro-header" style="background-image: url('/images/header_02.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Articles in the _posts category</h1>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/10/03/storytelling-for-test-professionals/" rel="bookmark" title="Permalink to Storytelling for test professionals">
                <h2 class="post-title">
                    Storytelling for test professionals
                </h2>
            </a>
                <p>This is a very condensed brief of an 8 hour workshop I visited
earlier this year held by Huib Schoots. You can find the
<a href="https://www.dropbox.com/s/b2si3swfthtwtpi/Workshop%20Storytelling%20-%20RTC%202017%20-%20Huib%20Schoots.pdf?dl=1">slides here</a>.</p>
<p>Storytelling is the form in which people naturally communicate.
Understanding the building blocks of a story will help us
understand other people's motivations, serve as map for actions and emotions,
help uncover unknown perspectives and serve as source for inspiration.</p>
<p>Stories stand on their own and have a beginning, middle and an end. There is a
main character and a storyline with development. Stories are authentic and
personal and often provocative and evoke emotions.</p>
<h2>7 basic story plots</h2>
<ol>
<li>Overcoming the Monster</li>
<li>Rags to Riches</li>
<li>The Quest</li>
<li>Voyage and return</li>
<li>Comedy</li>
<li>Tragedy</li>
<li>Rebirth</li>
</ol>
<p>From these we can derive the following
<a href="http://annettesimmons.com/the-six-kinds-of-stories/">types of stories</a>.</p>
<h2>6 types of stories</h2>
<ol>
<li>Who am I (identity stories)</li>
<li>Why am I here (motive and mission stories)</li>
<li>Vision stories (the big picture)</li>
<li>Future scenarios (imagining the future)</li>
<li>Product stories (branding)</li>
<li>Culture stories (a sum of other stories)</li>
</ol>
<h2>12 Common Archetypes</h2>
<p>Each story needs a hero and there are
<a href="http://www.soulcraft.co/essays/the_12_common_archetypes.html">12 common archetypes</a>
of heroes. More importantly you can also find these archetypes within your team and
organization. Read the link above to find out what their motto, core desire, goals,
fears and motives are. The 12 types are</p>
<ol>
<li>Innocent</li>
<li>Everyman</li>
<li>Hero</li>
<li>Caregiver</li>
<li>Explorer</li>
<li>Rebel</li>
<li>Lover</li>
<li>Creator</li>
<li>Jester</li>
<li>Sage</li>
<li>Magician</li>
<li>Ruler</li>
</ol>
<h2>6 key elements of a story</h2>
<ol>
<li>Who's the hero?</li>
<li>What is their desire?</li>
<li>What is stopping them?</li>
<li>What is the turning point?</li>
<li>What are their insights?</li>
<li>What is the solution?</li>
</ol>
<h2>Dramatic structure and Freytag's pyramid</h2>
<p><img alt="&quot;Freytag's pyramid&quot;" src="https://upload.wikimedia.org/wikipedia/commons/a/af/Freytags_pyramid.svg" title="Freytag's pyramid" /></p>
<p>One of the most commonly used storytelling structures is the Freytag's Pyramid.
According to it each story has an exposition, rising action, climax, falling action
and resolution. I think this can be applied directly when preparing presentations
even technical ones.</p>
<h2>The Hero's journey</h2>
<p>Successful stories follow the 12 steps of the hero's journey</p>
<ol>
<li>Ordinary world</li>
<li>Call to adventure</li>
<li>Refusal of the Call</li>
<li>Meeting the mentor</li>
<li>Crossing the threshold (after which the hero enters the Special world)</li>
<li>Tests, allies and enemies</li>
<li>Approach</li>
<li>Ordeal, death &amp; rebirth</li>
<li>Rewards, seizing the sword</li>
<li>The road back (to the ordinary world)</li>
<li>Resurrection</li>
<li>Return with elixir</li>
</ol>
<p>As part of the workshop we worked in groups and created a completely made up
story. Every person in the group was contributing couple of sentences from
their own experiences, trying to describe the particular step in the hero's journey.
At the end we told a story from the point of view of a single hero which was
a complete mash-up of moments that had nothing to do with each other. Still it
sounded very realistic and plausible.</p>
<h2>Storytelling techniques</h2>
<p><a href="https://booksinbusiness.wordpress.com/2013/04/30/make-your-story-sticky-using-6-principles-s-u-c-c-e-s/">SUCCESS</a>
means Simple, Unexpected, Concrete, Credible, Emotional, Stories. To use this
technique find the core of your idea, grab people's attention by
surprising them and make sure the idea can be understood and remembered later.
Find a way to make people believe in the idea so they can test it for themselves,
make them feel something to understand why this idea is important. Tell stories and
empower people to use an idea through narrative.</p>
<p><a href="https://tweakyourslides.wordpress.com/tag/something-theyll-always-remember/">STAR</a> means
Something They will Always Remember. A STAR Moment should be
Simple, Transferable, Audience-centered, Repeatable, and Meaningful.
There are
<a href="http://www.wiley.com/legacy/email_templates/images/resonate.pdf">5 types of STAR moments</a>:
memorable dramatization, repeatable sound bites, evocative visuals,
emotive storytelling, shocking statistics.</p>
<p>To enhance our stories and presentations we should appeal to senses
(smell, sounds, sight, touch, taste) and make it visual.</p>
<p>I will be using some of these techniques combined with others in my future
presentations and workshops. I'd love to be able to summarize all of them
into a short guide targeted at IT professionals but I don't know if this
is even possible.</p>
<p>Anyway if you do try some of these techniques in your public speaking please
let me know how it goes. I want to hear what works for you and your audience
and what doesn't.</p>
<p>Thanks for reading and happy testing!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Tue 03 October 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/10/03/storytelling-for-test-professionals/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/10/02/more-tests-for-login-forms/" rel="bookmark" title="Permalink to More tests for login forms">
                <h2 class="post-title">
                    More tests for login forms
                </h2>
            </a>
                <p><img alt="&quot;Telenor's login form&quot;" src="/images/telenor_login.png" title="Telenor's login form" /></p>
<p>By now I probably have documented more test cases for login forms than anyone
else. You can check out my previous posts on the topic
<a href="http://atodorov.org/blog/2016/04/12/how-to-hire-software-testers-pt-1/">here</a> and
<a href="http://atodorov.org/blog/2017/06/14/vmwares-favorite-login-form/">here</a>. I give you a few more
examples.</p>
<p>Test 01 and 02:
First of all let's start by saying that a "Remember me" checkbox should actually
remember the user and login them automatically on the next visit if checked. The
other way around if not checked. I don't think this has been mentioned previously!</p>
<p>Test 03:
When there is a "Remember me" checkbox it should be selectable both with the mouse
and the keyboard. On my.telenor.bg the checkbox changes its image only when
clicked with the mouse. Also clicking the login button with Space doesn't work!</p>
<p>Interestingly enough when I don't select "Remember me" at all and close then
revisit the page I am still able to access the internal pages of my account!
At this point I'm not quite sure what this checkbox does!</p>
<p>Test 04:
Testing two factor authentication. I had the case where GitHub SMS didn't
arrive for over 24 hrs and I wasn't able to login. After requesting a new code
you can see the UI updating but I didn't receive another message. In this particular
case I received only one message with an already invalid code. So test for:</p>
<ul>
<li>how long does it take for the codes to expire</li>
<li>is there a visual feedback indicating how many codes have been requested</li>
<li>do latest code invalidates all the previous ones or all that have been unused
  still work</li>
<li>what happens if I'm already logged in and somebody tries to access my account
  requesting additional codes which may or may not invalidate my login session?</li>
</ul>
<p>Test 05:
Check that confirmation codes, links, etc will actually expire after their
configured time. Kiwi TCMS had this problem which has been fixed in
<a href="https://github.com/kiwitcms/Kiwi/commit/92162112bf2214b8eacf37ba3a796414b129a700#diff-353aa238f7ee459b1236e2a21f1142ba">version 3.32</a>.</p>
<p>Test 06:
Is this a social-network-login only site? Then which of my profiles did I use?
Check that there is a working
<a href="http://atodorov.org/blog/2013/03/14/django-social-auth-tip-reminder-of-login-provider/">social auth provider reminder</a>.</p>
<p>Test 07:
Check that there is an error message visible (e.g. wrong login credentials).
After the redesign Kiwi TCMS had stopped displaying this message and instead
presents the user with the login form again!</p>
<p>Also checkout these
<a href="http://testingchallenges.thetestingmap.org/index.php">testing challenges</a>
by Claudiu Draghia where you can see many cases related to input field
validation! For example empty field, value too long, special characters in field, etc.
All of these can lead to issues depending on how login is implemented.</p>
<p>Thanks for reading and happy testing!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Mon 02 October 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/10/02/more-tests-for-login-forms/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/09/08/xiaomis-selfie-bug/" rel="bookmark" title="Permalink to Xiaomi's selfie bug">
                <h2 class="post-title">
                    Xiaomi's selfie bug
                </h2>
            </a>
                <p>Recently I've been exploring the user interface of a Xiaomi Redmi Note 4X
phone and noticed a peculiar bug, adding to my collection of
<a href="http://atodorov.org/blog/2013/03/19/bug-in-nokia-software-shows-wrong-caller-id/">obscure phone bugs</a>.
Sometimes when taking selfies the images
will not be saved in the correct orientation. Instead they will be saved as
if looking in the mirror and this is a bug!</p>
<p><img alt="&quot;Samsung S5 front screen&quot;" src="/images/samsung_s5_front_screen.jpg" title="Samsung S5 front screen" /></p>
<p>While taking the selfie the display correctly acts as a mirror, see my personal
Samsung S5 (black) and the Xiaomi device (white).</p>
<p><img alt="&quot;Xiaomi front screen&quot;" src="/images/xiaomi_front_screen.jpg" title="Xiaomi front screen" /></p>
<p>However when the image is saved and then viewed through the gallery application
there is a difference. The image below is taken with the Xiaomi device and there
have been no effects added to it except scaling and cropping. As you can see
the letters on the cereal box are mirrored!</p>
<p><img alt="&quot;Xiaomi mirrored image&quot;" src="/images/xiaomi_adi_mirrored.jpeg" title="Xiaomi mirrored image" /></p>
<p>The symptoms of the bug are not quite clear as of yet. I've managed to reproduce at
around 50% rate so far. I've tried taking pictures during the day in direct sunlight
and in the shade, also in the evening under bad artificial lighting.
Taking photo of a child's face and then child plus varying number of adults.
Then photo of only 1 or more adults, heck I even made a picture of myself. I though that
lighting or the number of faces and their age have something to do with this bug
but so far I'm not getting consistent results. Sometimes the images turn out OK
and other times they don't regardless of what I take a picture of.</p>
<p>I also took a picture of the same cereal box, under the same conditions as above but
not capturing the child's face and the image came out not mirrored. The only clue
that seems to hold true so far is that you need to have people's faces in the picture
for this bug to reproduce but that isn't an edge case when taking selfies, right?</p>
<p>I've also compared the results with my Samsung S5 (Android version 6.0.1) and BlackBerry Z10 devices
and both work as expected: while taking the picture the display acts as a mirror
but when viewing the saved image it appears in normal orientation. On S5 there is
also a clearly visible "Processing" progress bar while the picture is being saved!</p>
<p>For reference the system information is below:</p>
<div class="highlight"><pre>Model number: Redmi Note 4X
Android version: 6.0 MRA58K
Android security patch level: 2017-03-01
Kernel version: 3.18.22+
</pre></div>


<p>I'd love if somebody
from Xiaomi's engineering department looks into this and sends me a root cause analysis
of the problem.</p>
<p>Thanks for reading and happy testing! Oh and btw this is my breakfast, not hers!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Fri 08 September 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/09/08/xiaomis-selfie-bug/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/08/30/speeding-up-rust-builds-inside-docker/" rel="bookmark" title="Permalink to Speeding up Rust builds inside Docker">
                <h2 class="post-title">
                    Speeding up Rust builds inside Docker
                </h2>
            </a>
                <p>Currently <a href="https://github.com/rust-lang/cargo/pull/3567">it is not possible</a>
to instruct <code>cargo</code>, the Rust package manager, to build only the dependencies
of the software you are compiling! This means you can't easily pre-install
build dependencies. Luckily you can workaround this with <code>cargo build -p</code>!
I've been using this Python script to parse <code>Cargo.toml</code>:</p>
<div class="highlight"><span class="filename">parse-cargo-toml.py</span><pre><span class="c">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">toml</span>

<span class="n">_pwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>
<span class="n">cargo</span> <span class="o">=</span> <span class="n">toml</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_pwd</span><span class="p">,</span> <span class="s">&#39;Cargo.toml&#39;</span><span class="p">),</span> <span class="s">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;dependencies&#39;</span><span class="p">,</span> <span class="s">&#39;dev-dependencies&#39;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">dep</span><span class="p">,</span> <span class="n">version</span> <span class="ow">in</span> <span class="n">cargo</span><span class="p">[</span><span class="n">section</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;cargo build -p </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">dep</span><span class="p">)</span>
</pre></div>


<p>and then inside my <code>Dockerfile</code>:</p>
<div class="highlight"><pre><span class="x">RUN mkdir /bdcs-api-rs/</span>
<span class="x">COPY parse-cargo-toml.py /bdcs-api-rs/</span>

<span class="err">#</span><span class="x"> Manually install cargo dependencies before building</span>
<span class="err">#</span><span class="x"> so we can have a reusable intermediate container.</span>
<span class="err">#</span><span class="x"> This workaround is needed until cargo can do this by itself:</span>
<span class="err">#</span><span class="x"> https://github.com/rust-lang/cargo/issues/2644</span>
<span class="err">#</span><span class="x"> https://github.com/rust-lang/cargo/pull/3567</span>
<span class="x">COPY Cargo.toml /bdcs-api-rs/</span>
<span class="x">WORKDIR /bdcs-api-rs/</span>
<span class="x">RUN python ./parse-cargo-toml.py | while read cmd; do \</span>
<span class="x">        </span><span class="p">$</span><span class="nv">cmd</span><span class="x">;                                    \</span>
<span class="x">    done</span>
</pre></div>


<p>It doesn't take into account the version constraints specified in <code>Cargo.toml</code> but
is still able to produce an intermediate docker layer which I can use to
<a href="http://atodorov.org/blog/2017/08/07/faster-travis-ci-tests-with-docker-cache/">speed-up my tests by caching the dependency compilation part</a>.</p>
<p>As seen in the <a href="https://travis-ci.org/weldr/bdcs-api-rs/builds/268489460#L1173">build log</a>,
lines 1173-1182, when doing <code>cargo build</code> it downloads and compiles <code>chrono v0.3.0</code> and
<code>toml v0.3.2</code>. The rest of the dependencies are already available. The logs also show
that after Job #285 the build times dropped from 16 minutes down to 3-4 minutes due to
Docker caching. This would be even less if the cache is kept locally!</p>
<p>Thanks for reading and happy testing!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Wed 30 August 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/08/30/speeding-up-rust-builds-inside-docker/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/08/12/code-coverage-from-nightmarejs-tests/" rel="bookmark" title="Permalink to Code coverage from Nightmare.js tests">
                <h2 class="post-title">
                    Code coverage from Nightmare.js tests
                </h2>
            </a>
                <p>In this article I'm going to walk you through the steps required
to collect code coverage when running an end-to-end test suite
against a React.js application.</p>
<p>The application under test looks like this</p>
<div class="highlight"><pre><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">&quot;en-us&quot;</span> <span class="na">class=</span><span class="s">&quot;layout-pf layout-pf-fixed&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="c">&lt;!-- js dependencies skipped --&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;main&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;./dist/main.js?0ca4cedf3884d3943762&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>


<p>It is served as an <code>index.html</code> file and a <code>main.js</code> file which intercepts
all interactions from the user and sends requests to the backend API when
needed.</p>
<p>There is an existing unit-test suite which loads the individual components
and tests them in isolation.
<a href="https://twitter.com/atodorov_/status/886881560754102272">Apparently people do this</a>!</p>
<p>There is also an end-to-end test suite which does the majority of the testing.
It fires up a browser instance and interacts with the application. Everything
runs inside Docker containers providing a full-blown production-like environment.
They look like this</p>
<div class="highlight"><pre><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;should switch to Edit Recipe page - recipe creation success&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">nightmare</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Nightmare</span><span class="p">();</span>
  <span class="nx">nightmare</span>
    <span class="p">.</span><span class="kr">goto</span><span class="p">(</span><span class="nx">recipesPage</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">wait</span><span class="p">(</span><span class="nx">recipesPage</span><span class="p">.</span><span class="nx">btnCreateRecipe</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="nx">recipesPage</span><span class="p">.</span><span class="nx">btnCreateRecipe</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">wait</span><span class="p">(</span><span class="nx">page</span> <span class="o">=&gt;</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="nx">page</span><span class="p">.</span><span class="nx">dialogRootElement</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">===</span> <span class="s1">&#39;block&#39;</span>
      <span class="p">,</span> <span class="nx">createRecipePage</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">createRecipePage</span><span class="p">.</span><span class="nx">inputName</span><span class="p">,</span> <span class="nx">createRecipePage</span><span class="p">.</span><span class="nx">varRecName</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">createRecipePage</span><span class="p">.</span><span class="nx">inputDescription</span><span class="p">,</span> <span class="nx">createRecipePage</span><span class="p">.</span><span class="nx">varRecDesc</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="nx">createRecipePage</span><span class="p">.</span><span class="nx">btnSave</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">wait</span><span class="p">(</span><span class="nx">editRecipePage</span><span class="p">.</span><span class="nx">componentListItemRootElement</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">exists</span><span class="p">(</span><span class="nx">editRecipePage</span><span class="p">.</span><span class="nx">componentListItemRootElement</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">end</span><span class="p">()</span> <span class="c1">// remove this!</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">element</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">expect</span><span class="p">(</span><span class="nx">element</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
      <span class="c1">// here goes coverage collection helper</span>
      <span class="nx">done</span><span class="p">();</span> <span class="c1">// remove this!</span>
    <span class="p">});</span>
<span class="p">},</span> <span class="nx">timeout</span><span class="p">);</span>
</pre></div>


<p>The browser interaction is handled by Nightmare.js (sort of like Selenium) and
the test runner is Jest.</p>
<h2>Code instrumentation</h2>
<p>The first thing we need is to instrument the application code to provide coverage
statistics. This is done via <code>babel-plugin-istanbul</code>. Because unit-tests are
executed a bit differently we want to enable conditional instrumentation. In reality
for unit tests we use <code>jest --coverage</code> which enables istanbul on the fly and having
the code already instrumented breaks this. So I have the following in <code>webpack.config.js</code></p>
<div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;--with-coverage&#39;</span><span class="p">))</span> <span class="p">{</span>
  <span class="nx">babelConfig</span><span class="p">.</span><span class="nx">plugins</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;istanbul&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<p>and then build my application with <code>node run build --with-coverage</code>.</p>
<p>You can execute <code>node run start --with-coverage</code>, open the JavaScript console
in your browser and inspect the <code>window.__coverage__</code> variable. If this is defined
then the application is instrumented correctly.</p>
<h2>Fetching coverage information from within the tests</h2>
<p>Remember that <code>main.js</code> from the beginning of this post? It lives inside <code>index.html</code>
which means everything gets downloaded to the client side and executed there.
When running the end-to-end test suite that is the browser instance which is controlled
via Nightmare. <strong>You have to pass <code>window.__coverage__</code> from the browser scope back to
nodejs scope via <code>nightmare.evaluate()</code></strong>! I opted to directly save the coverage data
on the file system and make it available to coverage reporting tools later!</p>
<p>My coverage collecting snippet looks like this</p>
<div class="highlight"><pre><span class="nx">nightmare</span>
  <span class="p">.</span><span class="nx">evaluate</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">__coverage__</span><span class="p">)</span> <span class="c1">// this executes in browser scope</span>
  <span class="p">.</span><span class="nx">end</span><span class="p">()</span> <span class="c1">// terminate the Electron (browser) process</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">cov</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// this executes in Node scope</span>
    <span class="c1">// handle the data passed back to us from browser scope</span>
    <span class="kr">const</span> <span class="nx">strCoverage</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">cov</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">hash</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;crypto&#39;</span><span class="p">).</span><span class="nx">createHmac</span><span class="p">(</span><span class="s1">&#39;sha256&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">strCoverage</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">digest</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">fileName</span> <span class="o">=</span> <span class="err">`</span><span class="o">/</span><span class="nx">tmp</span><span class="o">/</span><span class="nx">coverage</span><span class="o">-</span><span class="nx">$</span><span class="p">{</span><span class="nx">hash</span><span class="p">}.</span><span class="nx">json</span><span class="err">`</span><span class="p">;</span>
    <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">).</span><span class="nx">writeFileSync</span><span class="p">(</span><span class="nx">fileName</span><span class="p">,</span> <span class="nx">strCoverage</span><span class="p">);</span>

    <span class="nx">done</span><span class="p">();</span> <span class="c1">// the callback from the test</span>
  <span class="p">})</span>
<span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">));</span>
</pre></div>


<p>Nightmare returns <code>window.__coverage__</code> from browser scope back to nodejs scope
and we save it under <code>/tmp</code> using a hash value of the coverage data as the file
name.</p>
<p><em>Side note:</em> I do have about 40% less coverage files than number of test cases.
This means some test scenarios exercise the same code paths. Storing the individual
coverage reports under a hashed file name makes this very easy to see!</p>
<p>Note that in my coverage handling code I also call <code>.end()</code> which will terminate
the browser instance and also execute the <code>done()</code> callback which is being passed
as parameter to the test above! This is important because it means we had to update
the way tests were written. In particular the Nightmare method sequence doesn't
have to call <code>.end()</code> and <code>done()</code> except in the coverage handling code. The
coverage helper must be the last code executed inside the body of the last
<code>.then()</code> method. This is usually after all assertions (expectations) have been met!</p>
<p>Now this coverage helper needs to be part of every single test case so I
wanted it to be a one line function, easy to copy&amp;paste! All my attempts to
move this code inside a module have been futile. I can get the module loaded
but it kept failing with
<code>Unhandled promise rejection (rejection id: 1): cov_23rlop1885 is not defined</code>;`</p>
<p>At the end I've resorted to this simple hack</p>
<div class="highlight"><pre><span class="nb">eval</span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">&#39;utils/coverage.js&#39;</span><span class="p">).</span><span class="nx">toString</span><span class="p">());</span>
</pre></div>


<p>Shout-out to <a href="http://krasimirtsonev.com/">Krasimir Tsonev</a> who joined me on a two
days pairing session to figure this stuff out. Too bad we couldn't quite figure it
out. If you do please send me a pull request!</p>
<h2>Reporting the results</h2>
<p>All of these <code>coverage-*.json</code> files are directly consumable by <code>nyc</code> - the
coverage reporting tool that comes with the Istanbul suite! I mounted
<code>.nyc_output/</code> directly under <code>/tmp</code> inside my Docker container so I could</p>
<div class="highlight"><pre>nyc report
nyc report --reporter=lcov | codecov
</pre></div>


<p>We can also modify the unit-test command to
<code>jest --coverage --coverageReporters json --coverageDirectory .nyc_output</code> so it
produces a <code>coverage-final.json</code> file for <code>nyc</code>. Use this if you want to combine
the coverage reports from both test suites.</p>
<p>Because I'm using Travis CI the two test suites are executed independently and
there is no easy way to share information between them. Instead I've switched
from Coveralls to CodeCov which is smart enough to merge coverage submissions
coming from multiple jobs on the same git commits. You can compare the commit
<a href="https://codecov.io/gh/atodorov/welder-web/commit/46556808e42a21f48d008ced2d53ffe176c01b6d">submitting only unit-test results</a>
with the one
<a href="https://codecov.io/gh/atodorov/welder-web/commit/15f437477c17b63797cdb2455f1371336d7dc0e5">submitting coverage from both test suites</a>.</p>
<p>All of the above steps are put into practice in
<a href="https://github.com/weldr/welder-web/pull/136">PR #136</a> if you want to check them out!</p>
<p>Thanks for reading and happy testing!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Sat 12 August 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/08/12/code-coverage-from-nightmarejs-tests/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/08/07/faster-travis-ci-tests-with-docker-cache/" rel="bookmark" title="Permalink to Faster Travis CI tests with Docker cache">
                <h2 class="post-title">
                    Faster Travis CI tests with Docker cache
                </h2>
            </a>
                <p>For a while now I've been running tests on Travis CI using Docker
containers to build the project and execute the tests inside. In this
post I will explain how to speed up execution times.</p>
<p>A Docker image is a filesystem snapshot similar to a virtual machine
image. From these images we build containers (e.g. we run the container X
from the image Y). The construction of Docker images is controlled via
<code>Dockerfile</code> which contains a set of instructions how to build the image.
For example:</p>
<div class="highlight"><pre>FROM welder/web-nodejs:latest
MAINTAINER Brian C. Lane &lt;bcl@redhat.com&gt;
RUN dnf install -y nginx

CMD nginx -g &quot;daemon off;&quot;
EXPOSE 3000

## Do the things more likely to change below here. ##

COPY ./docker/nginx.conf /etc/nginx/

# Update node dependencies only if they have changed
COPY ./package.json /welder/package.json
RUN cd /welder/ &amp;&amp; npm install

# Copy the rest of the UI files over and compile them
COPY . /welder/
RUN cd /welder/ &amp;&amp; node run build

COPY entrypoint.sh /usr/local/bin/entrypoint.sh
ENTRYPOINT [&quot;/usr/local/bin/entrypoint.sh&quot;]
</pre></div>


<p><code>docker build</code> is smart enough to actually build intermediate layers for each
command and store them on your computer. Each command is hashed and it is rebuilt
only if it has been changed. Thus the stuff which doesn't change often goes first
(like setting up a web server or a DB) and the stuff that changes (like the project source code)
goes at the end. All of this is beautifully explained by <a href="https://www.youtube.com/watch?v=3a0gVrfmWC8">Stefan Kanev in
this video</a> (in Bulgarian).</p>
<h2>Travis and Docker</h2>
<p>While intermediate layer caching is a standard feature for Docker it is disabled
by default in Travis CI and any other CI service I was able to find. To be frank
Circles CI offer this as a premium feature but their pricing plans on that aren't
clear at all.</p>
<p>However you can enable the use of caching following a few simple steps:</p>
<ol>
<li>Make your Docker images publicly available (e.g. Docker Hub or Amazon EC2 Container Service)</li>
<li>Before starting the test job do a <code>docker pull my/image:latest</code></li>
<li>When building your Docker images in Travis add <code>--cache-from my/image:latest</code> to <code>docker build</code></li>
<li>After successful execution <code>docker tag</code> the latest image with the build job number and
   <code>docker push</code> it again to the hub!</li>
</ol>
<p><strong>NOTES:</strong></p>
<ul>
<li>Everything you do will become public so take care not to expose internal code.
  Alternatively you may configure a private docker registry (e.g. Amazon EC2 CS)
  and use encrypted passwords for Travis to access your images;</li>
<li><code>docker pull</code> will download all layers that it needs. If your hosting is slow
  this will negatively impact execution times;</li>
<li><code>docker push</code> will upload only the layers that have been changed;</li>
<li>I only push images coming from the master branch which are not from a pull request
  build job. This prevents me from accidentally messing something up.</li>
</ul>
<p>If you examine the logs of <a href="https://travis-ci.org/weldr/welder-web/jobs/260970675">Job #247.4</a>
and <a href="https://travis-ci.org/weldr/welder-web/jobs/261732264">Job #254.4</a> you will notice
that almost all intermediate layers were re-used from cache:</p>
<div class="highlight"><pre>Step 3/12 : RUN dnf install -y nginx
 ---&gt; Using cache
 ---&gt; 25311f052381
Step 4/12 : CMD nginx -g &quot;daemon off;&quot;
 ---&gt; Using cache
 ---&gt; 858606811c85
Step 5/12 : EXPOSE 3000
 ---&gt; Using cache
 ---&gt; d778cbbe0758
Step 6/12 : COPY ./docker/nginx.conf /etc/nginx/
 ---&gt; Using cache
 ---&gt; 56bfa3fa4741
Step 7/12 : COPY ./package.json /welder/package.json
 ---&gt; Using cache
 ---&gt; 929f20da0fc1
Step 8/12 : RUN cd /welder/ &amp;&amp; npm install
 ---&gt; Using cache
 ---&gt; 68a30a4aa5c6
</pre></div>


<p>Here the slowest operations are <code>dnf install</code> and <code>npm install</code> which on normal execution
will take around 5 minutes.</p>
<p>You can check-out my
<a href="https://github.com/weldr/welder-web/blob/master/.travis.yml">.travis.yml</a> for more info.</p>
<h2>First time cache</h2>
<p>It is important to note that you need to have your docker images available in the
registry before you execute the first <code>docker pull</code> from CI. I do this by manually building
the images on my computer and uploading them before configuring CI integration. Afterwards
the CI system takes care of updating the images for me.</p>
<p>Initially you may not notice a significant improvement as seen in
<a href="https://travis-ci.org/weldr/bdcs-api-rs/builds/261510313">Job #262</a>, Step 18/22.
The initial image available on Docker Hub has all the build dependencies installed
and the code has not been changed when job #262 was executed.</p>
<p>The <code>COPY</code> command copies the entire contents of the directory, including filesystem metadata!
Things like uid/gid (file ownership), timestamps (not sure if taken into account)
and/or extended attributes (e.g. SELinux)
will cause the intermediate layers checksums to differ even though the actual
source code didn't change. This will resolve itself once your CI system starts automatically
pushing the latest images to the registry.</p>
<p>Thanks for reading and happy testing!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Mon 07 August 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/08/07/faster-travis-ci-tests-with-docker-cache/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/08/04/transactionmanagementerror-during-testing-with-django-110/" rel="bookmark" title="Permalink to TransactionManagementError during testing with Django 1.10">
                <h2 class="post-title">
                    TransactionManagementError during testing with Django 1.10
                </h2>
            </a>
                <p>During the past 3 weeks I've been debugging a weird error which
started happening after I migrated <a href="http://MrSenko.com/kiwi/">KiwiTestPad</a> to
Django 1.10.7. Here is the reason why this happened.</p>
<h2>Symptoms</h2>
<p>After migrating to Django 1.10 all tests appeared to be working locally
on SQLite however they
<a href="https://travis-ci.org/MrSenko/Kiwi/jobs/258309883">failed on MySQL</a> with</p>
<div class="highlight"><pre><span class="n">TransactionManagementError</span><span class="o">:</span> <span class="n">An</span> <span class="n">error</span> <span class="n">occurred</span> <span class="k">in</span> <span class="n">the</span> <span class="n">current</span> <span class="n">transaction</span><span class="o">.</span> <span class="n">You</span> <span class="n">can</span><span class="s1">&#39;t execute queries until the end of the &#39;</span><span class="n">atomic</span><span class="err">&#39;</span> <span class="n">block</span><span class="o">.</span>
</pre></div>


<p>The exact same test cases
<a href="https://travis-ci.org/MrSenko/Kiwi/jobs/258309884">failed on PostgreSQL</a> with:</p>
<div class="highlight"><pre><span class="n">InterfaceError</span><span class="o">:</span> <span class="n">connection</span> <span class="n">already</span> <span class="n">closed</span>
</pre></div>


<p>Since version 1.10 Django executes all tests inside transactions so my first
thoughts were related to the auto-commit mode. However upon closer inspection
we can see that the line which triggers the failure is</p>
<div class="highlight"><pre>self.assertTrue(users.exists())
</pre></div>


<p>which is essentially a <code>SELECT</code> query aka
<code>User.objects.filter(username=username).exists()</code>!</p>
<p><strong>My tests were failing on a SELECT query!</strong></p>
<p>Reading the numerous posts about <code>TransactionManagementError</code> I discovered it may
be caused by a run-away cursor. The application did use raw SQL statements which
I've converted promptly to ORM queries, that took me some time. Then I also fixed
a couple of places where it used <code>transaction.atomic()</code> as well. No luck!</p>
<p>Then, after numerous experiments and tons of logging inside Django's own code I was
able to figure out when the failure occurred and what events were in place. The test
code looked like this:</p>
<div class="highlight"><pre><span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;/confirm/&#39;</span><span class="p">)</span>

<span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">new_user</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">is_active</span><span class="p">)</span>
</pre></div>


<p><strong>The failure was happening after the view had been rendered upon the
first time I do a SELECT against the database!</strong></p>
<p><strong>The problem was that the connection to the database had been closed
midway during the transaction!</strong></p>
<p>In particular (after more debugging of course) the sequence of events was:</p>
<ol>
<li>execute <code>django/test/client.py::Client::get()</code></li>
<li>execute <code>django/test/client.py::ClientHandler::__call__()</code>, which takes
   care to disconnect/connect <code>signals.request_started</code> and <code>signals.request_finished</code>
   which are responsible for tearing down the DB connection, so problem not here</li>
<li>execute <code>django/core/handlers/base.py::BaseHandler::get_response()</code></li>
<li>execute <code>django/core/handlers/base.py::BaseHandler::_get_response()</code> which goes through
   the middleware (needless to say I did inspect all of it as well since there
   have been some changes in Django 1.10)</li>
<li>execute <code>response = wrapped_callback()</code> while still inside <code>BaseHandler._get_response()</code></li>
<li>
<p>execute <code>django/http/response.py::HttpResponseBase::close()</code> which looks like</p>
<div class="highlight"><pre><span class="c"># These methods partially implement the file-like object interface.</span>
<span class="c"># See https://docs.python.org/3/library/io.html#io.IOBase</span>
 
<span class="c"># The WSGI server must call this method upon completion of the request.</span>
<span class="c"># See http://blog.dscpl.com.au/2012/10/obligations-for-calling-close-on.html</span>
<span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">closable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_closable_objects</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">closable</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">signals</span><span class="o">.</span><span class="n">request_finished</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">sender</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handler_class</span><span class="p">)</span>
</pre></div>


</li>
<li>
<p><code>signals.request_finished</code> is fired</p>
</li>
<li><code>django/db/__init__.py::close_old_connections()</code> closes the connection!</li>
</ol>
<p><strong>IMPORTANT:</strong> On MySQL setting <code>AUTO_COMMIT=False</code> and <code>CONN_MAX_AGE=None</code> helps
workaround this problem but is not the solution for me because it didn't help on
PostgreSQL.</p>
<p>Going back to <code>HttpResponseBase::close()</code> I started wondering who calls this method.
The answer was it was getting called by the <code>@content.setter</code> method at
<code>django/http/response.py::HttpResponse::content()</code> which is even more weird because
we assign to <code>self.content</code> inside <code>HttpResponse::__init__()</code></p>
<h2>Root cause</h2>
<p>The root cause of my problem was precisely this <code>HttpResponse::__init__()</code> method
or rather the way we arrive at it inside the application. </p>
<p>The offending view last line was</p>
<div class="highlight"><pre><span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">Prompt</span><span class="o">.</span><span class="n">render</span><span class="p">(</span>
     <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span>
     <span class="n">info_type</span><span class="o">=</span><span class="n">Prompt</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span>
     <span class="n">info</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span>
     <span class="nb">next</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;next&#39;</span><span class="p">,</span> <span class="n">reverse</span><span class="p">(</span><span class="s">&#39;core-views-index&#39;</span><span class="p">))</span>
<span class="p">))</span>
</pre></div>


<p>and the Prompt class looks like this</p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>

<span class="k">class</span> <span class="nc">Prompt</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">info_type</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="nb">next</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">&#39;prompt.html&#39;</span><span class="p">,</span> <span class="p">{</span>
            <span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="n">info_type</span><span class="p">,</span>
            <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="n">info</span><span class="p">,</span>
            <span class="s">&#39;next&#39;</span><span class="p">:</span> <span class="nb">next</span>
        <span class="p">})</span>
</pre></div>


<p>Looking back at the internals of <code>HttpResponse</code> we see that</p>
<ul>
<li>if content is a string we call <code>self.make_bytes()</code></li>
<li>if the content is an iterator then we assign it and if the object has a close method
  then it is executed.</li>
</ul>
<p><code>HttpResponse</code> itself is an iterator, inherits from <code>six.Iterator</code> so when we initialize
<code>HttpResponse</code> with another <code>HttpResponse</code> object (aka the content) we execute <code>content.close()</code>
which unfortunately happens to close the database connection as well.</p>
<p><strong>IMPORTANT:</strong> note that from the point of view of a person using the application the
HTML content is exactly the same regardless of whether we have nested <code>HttpResponse</code> objects
or not.
Also during normal execution the code doesn't run inside a transaction so we never notice
the problem in production.</p>
<p>The fix of course is very simple, just <code>return Prompt.render()</code>!</p>
<p>Thanks for reading and happy testing!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Fri 04 August 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/08/04/transactionmanagementerror-during-testing-with-django-110/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/06/27/producing-coverage-report-for-haskell-binaries/" rel="bookmark" title="Permalink to Producing coverage report for Haskell binaries">
                <h2 class="post-title">
                    Producing coverage report for Haskell binaries
                </h2>
            </a>
                <p>Recently I've started testing a Haskell application and a question I find
unanswered (or at least very poorly documented) is how to produce coverage
reports for binaries ?</p>
<h2>Understanding HPC &amp; cabal</h2>
<p><code>hpc</code> is the Haskell code coverage tool. It produces the following files:</p>
<ul>
<li>.mix - module index file, contains information about <em>tick boxes</em> - their type
  and location in the source code;</li>
<li>.tix - tick index file aka coverage report;</li>
<li>.pix - program index file, used only by <code>hpc trans</code>.</li>
</ul>
<p>The invocation to <code>hpc report</code> needs to know where to find the .mix files in order
to be able to translate the coverage information back to source and it needs to
know the location (full path or relative from pwd) to the tix file we want to
report.</p>
<p><code>cabal</code> is the package management tool for Haskell. Among other thing it can be used
to build your code, execute the test suite and produce the coverage report for you.
<code>cabal build</code> will produce module information in <code>dist/hpc/vanilla/mix</code> and
<code>cabal test</code> will store coverage information in <code>dist/hpc/vanilla/tix</code>!</p>
<p>A particular thing about Haskell is that you can only test code which can be
<code>import</code>ed, e.g. it is a library module. You can't test (via Hspec or Hunit) code which
lives inside a file that produces a binary (e.g. Main.hs). However you can still
execute these binaries (e.g. invoke them from the shell) and they will produce a
coverage report in the current directory (e.g. main.tix).</p>
<h2>Putting everything together</h2>
<ol>
<li>Using <code>cabal build</code> and <code>cabal test</code> build the project and execute your unit tests.
   This will create the necessary .mix files (including ones for binaries) and .tix
   files coming from unit testing;</li>
<li>Invoke your binaries passing appropriate data and examining the results (e.g. compare
   the output to a known value). A simple shell or Python script could do the job;</li>
<li>Copy the <code>binary.tix</code> file under <code>dist/hpc/vanilla/binary/binary.tix</code>!</li>
</ol>
<p>Produce coverage report with hpc:</p>
<div class="highlight"><pre>hpc markup --hpcdir=dist/hpc/vanilla/mix/lib --hpcdir=dist/hpc/vanilla/mix/binary  dist/hpc/vanilla/tix/binary/binary.tix
</pre></div>


<p>Convert the coverage report to JSON and send it to Coveralls.io:</p>
<div class="highlight"><pre>cabal install hpc-coveralls
~/.cabal/bin/hpc-coveralls --display-report tests binary
</pre></div>


<h2>Example</h2>
<p>Check out the <a href="https://github.com/weldr/haskell-rpm/pull/18">haskell-rpm</a> repository
for an example. See <a href="https://coveralls.io/builds/12131112">job #45</a> where there is now
coverage for the <code>inspect.hs</code>, <code>unrpm.hs</code> and <code>rpm2json.hs</code> files, producing binary executables.
Also notice that in
<a href="https://coveralls.io/builds/12131112/source?filename=.%2FRPM%2FParse.hs">RPM/Parse.hs</a>
the function <code>parseRPMC</code> is now covered, while it was not covered in the
<a href="https://coveralls.io/builds/12102486/source?filename=.%2FRPM%2FParse.hs">previous job #42</a>!</p>
<div class="highlight"><span class="filename">.travis.yml snippet</span><pre><span class="l-Scalar-Plain">script</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">~/.cabal/bin/hlint .</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">cabal install --dependencies-only --enable-tests</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">cabal configure --enable-tests --enable-coverage --ghc-option=-DTEST</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">cabal build</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">cabal test --show-details=always</span>

  <span class="c1"># tests to produce coverage for binaries</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">wget https://s3.amazonaws.com/atodorov/rpms/macbook/el7/x86_64/efivar-0.14-1.el7.x86_64.rpm</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">./tests/test_binaries.sh ./efivar-0.14-1.el7.x86_64.rpm</span>

  <span class="c1"># move .tix files in appropriate directories</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">mkdir ./dist/hpc/vanilla/tix/inspect/ ./dist/hpc/vanilla/tix/unrpm/ ./dist/hpc/vanilla/tix/rpm2json/</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">mv inspect.tix ./dist/hpc/vanilla/tix/inspect/</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">mv rpm2json.tix ./dist/hpc/vanilla/tix/rpm2json/</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">mv unrpm.tix ./dist/hpc/vanilla/tix/unrpm/</span>

<span class="l-Scalar-Plain">after_success</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">cabal install hpc-coveralls</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">~/.cabal/bin/hpc-coveralls --display-report tests inspect rpm2json unrpm</span>
</pre></div>


<p>Thanks for reading and happy testing!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Tue 27 June 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/06/27/producing-coverage-report-for-haskell-binaries/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/06/26/whats-the-bug-in-this-pseudo-code/" rel="bookmark" title="Permalink to What's the bug in this pseudo-code">
                <h2 class="post-title">
                    What's the bug in this pseudo-code
                </h2>
            </a>
                <p><img alt="Rails Girls Vratsa sticker" src="/images/bug_rails_girls_vratsa.jpg" title="Rails Girls Vratsa sticker" /></p>
<p>This is one of the stickers for the second edition of Rails Girls Vratsa which
was held yesterday. Let's explore some of the bug proposals submitted by the Bulgarian QA group:</p>
<blockquote>
<ol>
<li>sad() == true is ugly</li>
<li>sad() is not very nice, better make it if(isSad())</li>
<li>use sadStop(), and even better - stopSad()</li>
<li>there is an extra space character in beAwesome( )</li>
<li>the last curly bracket needs to be on a new line</li>
</ol>
<p>Lyudmil Latinov</p>
</blockquote>
<p>My friend Lu describes what I would call style issues. The style he refers to
is mostly Java oriented, especially with naming things. In Ruby we would probably
go with <code>sad?</code> instead of <code>isSad</code>. Style is important and there are many tools
to help us with that this will not cause a functional problem! While I'm at it let me say
the curly brackets are not the problem either. They are not valid in Ruby this is
a pseudo-code and they also fall in the style category.</p>
<p>The next interesting proposal comes from Tsveta Krasteva. She examines the possibility
of <code>sad()</code> returning an object or nil instead of boolean value. Her first question was
will the if statement still work, and the answer is yes. In Ruby everything is an object
and every object can be compared to <code>true</code> and <code>false</code>. See
<a href="http://www.skorks.com/2009/09/true-false-and-nil-objects-in-ruby/">Alan Skorkin's</a> blog
post on the subject.</p>
<p>Then Tsveta says the answer is to use <code>sad().stop()</code> with the warning that it may return
nil. In this context the <code>sad()</code> method returns on object indicating that the person
is feeling sad. If the method returns nil then the person is feeling OK.</p>
<div class="highlight"><span class="filename">example by Tsveta</span><pre><span class="k">class</span> <span class="nc">Csad</span>
  <span class="k">def</span> <span class="nf">stop</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;stop</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">sad</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sad</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="no">Csad</span><span class="o">.</span><span class="n">new</span><span class="p">();</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">beAwesome</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;beAwesome</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="k">end</span>

<span class="c1"># notice == true was removed</span>
<span class="k">if</span><span class="p">(</span><span class="n">sad</span><span class="p">())</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yes, I am sad</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">sad</span><span class="o">.</span><span class="n">stop</span><span class="p">();</span>
  <span class="n">beAwesome</span><span class="p">(</span> <span class="p">);</span>
<span class="k">end</span>
</pre></div>


<p>While this is coming closer to a functioning solution something about it is bugging me.
In the if statement the developer has typed more characters than required (<code>== true</code>).
This sounds to me unlikely but is possible with less experienced developers.
The other issue is that we are using an object (of <code>class Csad</code>) to represent an internal
state in the system under test. There is one method to return the state (<code>sad()</code>) and
another one to alter the state (<code>Csad.stop()</code>). The two methods don't operate on
the same object! Not a very strong OOP design. On top of that we have to call the
method twice, first time in the if statement, the second time in the body of the
if statement, which may have unwanted side effects. It is best to assign the return
value to some variable instead.</p>
<p>IMO if we are to use this OOP approach the code should look something like:</p>
<div class="highlight"><pre><span class="k">class</span> <span class="n">Person</span>
  <span class="n">def</span> <span class="n">sad</span>?()
  <span class="nb">end</span>

  <span class="n">def</span> <span class="n">stopBeingSad</span>()
  <span class="nb">end</span>

  <span class="n">def</span> <span class="n">beAwesome</span>()
  <span class="nb">end</span>
<span class="nb">end</span>

<span class="n">p</span> = <span class="n">Person</span>.<span class="nb">new</span>
<span class="k">if</span> <span class="n">p</span>.<span class="n">sad</span>?
    <span class="n">p</span>.<span class="n">stopBeingSad</span>
    <span class="n">p</span>.<span class="n">beAwesome</span>
<span class="nb">end</span>
</pre></div>


<p>Let me return back to assuming we don't use classes here.
The first <em>obvious</em> mistake is the space in <code>sad stop();</code> first spotted by Peter Sabev*.
His proposal, backed by others is to use <code>sad.stop()</code>. However they
didn't use my hint asking what is the return value of <code>sad()</code> ?</p>
<p>If <code>sad()</code> returns boolean then we'll get
<code>undefined method 'stop' for true:TrueClass (NoMethodError)</code>!
Same thing if <code>sad()</code> returns nil, although we skip the if block in this case.</p>
<p>In Ruby we are allowed to skip parentheses when calling a method, like I've shown
above. If we ignore this fact for a second, then <code>sad?.stop()</code> will mean execute the
method named <code>stop()</code> which is a member of the <code>sad?</code> variable, which is of type method!
Again, methods don't have an attribute named <code>stop</code>!</p>
<p>The last two paragraphs are the semantic/functional mistake I see in this code. The only way
for it to work is to use an OOP variant which is further away from what the existing
clues give us.</p>
<p><strong>Note:</strong> The variant <code>sad? stop()</code> is syntactically correct. This means call the function <code>sad?</code>
with parameter the result of calling the method <code>stop()</code>, which depending on the outer scope of this program may or may not
be correct (e.g. <code>stop</code> is defined, <code>sad?</code> accepts optional parameters, <code>sad?</code> maintains
global state).</p>
<p>Thanks for reading and happy testing!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Mon 26 June 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/06/26/whats-the-bug-in-this-pseudo-code/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/06/15/design-for-developers-in-5-steps/" rel="bookmark" title="Permalink to Design for developers in 5 steps">
                <h2 class="post-title">
                    Design for developers in 5 steps
                </h2>
            </a>
                <p>Design is a method! Design can be taught! Developers can do good design!
If this sounds outrageous then I present you
<a href="http://sugarenia.com/">Zaharenia Atzitzikaki</a> who is a developer by
education, not a graphics designer and she thinks otherwise. This
blog post will summarize her workshop held at the DEVit conference last month.</p>
<p>We are going to build a site called DevMatch, which is like Tinder for
developers. The initial version doesn't look bad but we can do better:
<img alt="initial version of DevMatch" src="/images/design4devs/step0.png" title="initial version of DevMatch" /></p>
<h2>Step 1: Layout</h2>
<p>Layout is grids and the most popular designs use grids with 12, 16 or 24 columns. The
idea is to make everything align to the grid which allows the eyes to follow a straight
line and makes the content easier to perceive. You don't want to break the story line.
Don't fear the white space but don't leave it random. </p>
<p>Make everything align to the grid ... but not so much (checkout this
<a href="https://www.youtube.com/watch?v=LadUft_ly50">TEDx talk</a> about
predictability and variability in music).</p>
<p>Make sure not to use centered alignment, nor justified alignment because they
don't provide a single line for the eyes to follow. Align to the left,
buttons align at the bottom.</p>
<p>To make an element more prominent (like the recommended plan) then make it
double width!</p>
<p>Finally we remove the stock images because they are distracting!</p>
<p>Here's how everything looks now:
<img alt="DevMatch after aligning" src="/images/design4devs/step1.png" title="DevMatch after aligning" /></p>
<h2>Step 2: Typography</h2>
<p>The web is 95% typography. Serif fonts are good for reading long passages of text
because they allow the eyes to follow. Sans-serif fonts look great on screens,
especially for smaller sizes (&lt; 12px). Monospaced fonts are only for code!
Script fonts are fun but use them with caution.</p>
<p>The fonts we select need to improve readability, not hinder it. Minimum
font size should be 16px or even 18px.</p>
<p>Use a typographic scale which tells you how big certain text should be,
e.g. h1 vs h2 vs h3 vs paragraph!</p>
<p>Find a font pair which works (e.g. Oxygen + Source Sans). Also compile
a list of fallback fonts, e.g. Futura, Trebuchet MS, Arial, Sans-serif.
This makes sure that your fonts work well together and that visitors
on your site will use fonts which are as close as possible to what you intended.</p>
<p>Increase line height to improve readability of paragraphs. The minimum is 1.4em.
Keep line length short, between 45 and 75 characters.</p>
<p>Layout and Typography are the two most important design steps and you will
achieve very good results if you apply only the two of them.
Here's how everything looks now:
<img alt="DevMatch after typography changes" src="/images/design4devs/step2.png" title="DevMatch after typography changes" /></p>
<h2>Step 3: Color</h2>
<p>Find a color palette generator and use it. For new projects start with
competitor analysis, a logo or a picture you like or something that conveys
a known meaning to the customer. Zaharenia's tips include:</p>
<ul>
<li>Avoid clear black and clear white because they are not easy to read. Use a gray-scale
  shade or change the transparency channel to get a new color;</li>
<li>Success is GREEN;</li>
<li>Error is RED. Don't use red color for normal text;</li>
<li>Don't rely on color alone because some people may be color blind,
  others may be using a gray scale (or a bad quality) screen, etc.;</li>
<li>For links use underlines;</li>
<li>For background use the brand color - this is the most visible color;</li>
<li>Use an accent color. This is the most striking color (purple in
  this example) but use it sparingly, only for buttons or important items;</li>
<li>We need a light background color as well;</li>
<li>Need dark text color, but not black;</li>
<li>Need link color;</li>
</ul>
<p>Here's how everything looks now:
<img alt="DevMatch after applying color" src="/images/design4devs/step3.png" title="DevMatch after applying color" /></p>
<h2>Step 4: Visual elements</h2>
<p>Here we talk about icons and images which are to be used only as
visual aid, not alone (especially for navigation). The best thing you can do
is find a good icon set (with lots of sizes) or even better an SVG set. Then
combine several icons together if need be, instead of using stock photos.</p>
<p>It is best to use SVG for all icons because we can use CSS to modify the colors
inside the SVG. For example the features icons below are all gray and some SVG paths
have been styled with the accent color. Here's how it looks now:
<img alt="DevMatch after applying icons" src="/images/design4devs/step4.png" title="DevMatch after applying icons" /></p>
<p>Other tips include</p>
<ul>
<li>Use logo and header images for the headers;</li>
<li>To make element pop add border, add header, add accent color in the middle
  (e.g. the pricing section).</li>
</ul>
<h2>Step 5: Copyright</h2>
<p>This is about what text we provide on the screen. The rules of thumb are:</p>
<ul>
<li>People scan, they don't read;</li>
<li>Aim for clarity;</li>
<li>Avoid industry/technical slang;</li>
<li>Keep lines short: 45 to 75 characters;</li>
<li>Write clear error messages and clear call to actions.
  Repeat the actual verb in the call to action and be more verbose.
  E.g. <em>Yes, delete this</em> or <em>No, I changed my mind</em>.
  Instead of <em>Submit</em> use <em>Create account</em>;</li>
<li>Truncate your text: cut in half and then again;</li>
<li>Design your text to be roughly even which helps with alignment
  but don't over do it;</li>
<li>Keep forms very short</li>
</ul>
<p>And this is the final version of our website (note: the header logo mishap
is probably from my side, not intentional):
<img alt="DevMatch after copyright changes" src="/images/design4devs/step5.png" title="DevMatch after copyright changes" /></p>
<p>These are the 5 basic design steps. You don't need to be a trained designer to be
able to apply them. Now that you know what the steps are simply search for fonts,
scales, color palettes and icon sets and apply them. This is what Zaharenia does
(in her own words). You can find all HTML, CSS and images for this workshop at the
<a href="https://github.com/sugarenia/design4devs-devit">design4devs-devit</a> repository.</p>
<p>Thanks for reading and happy designing!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Thu 15 June 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/06/15/design-for-developers-in-5-steps/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/06/14/vmwares-favorite-login-form/" rel="bookmark" title="Permalink to VMware's favorite login form">
                <h2 class="post-title">
                    VMware's favorite login form
                </h2>
            </a>
                <p><em>How do you test a login form?</em> is one of my favorite questions when
screening candidates for QA positions and also a good brain exercise
even for experienced testers. I've written about it
<a href="http://atodorov.org/blog/2016/04/12/how-to-hire-software-testers-pt-1/">last year</a>. In this
blog post I'd like to share a different perspective on this same question,
this time courtesy of my friend Rayna Stankova.</p>
<p><img alt="Login form" src="/images/login_form_vmware.png" title="Login form" /></p>
<h2>What bugs do you see above</h2>
<p>The series of images above is from a
<a href="https://www.meetup.com/Women-Who-Code-Sofia/events/239480974/">Women Who Code Sofia</a>
workshop where the participants were given printed copies and asked to find
as much defects as possible. Here they are (counting clock-wise from the top-left corner):</p>
<ol>
<li>Typo in "Registr" link at the bottom;</li>
<li>UI components are not aligned;</li>
<li>Missing "Forgot your password?" link</li>
<li>Backend credentials validation with empty password;
   plain text password field; Too specific information about incorrect credentials;</li>
<li>Too specific information about incorrect credentials with visual hint
   as to what exactly is not correct. In this case it looks like the password
   is OK, maybe it was one of
   <a href="https://www.youtube.com/watch?v=0Jx8Eay5fWQ">the 4 most commonly used passwords</a>,
   but the username is wrong which we can easily figure out;</li>
<li>In this case the error handling appears to be correct, not disclosing what
   exactly is wrong. The placement is somewhat wrong, it looks like an error
   message for one of the fields instead for the entire form. I'd move that to the top
   and even slightly update the wording to be more like <em>Login failed, bad credentials,
   try again</em>.</li>
</ol>
<h2>How do you test this</h2>
<p>Here is a list of possible test scenarios, proposed by Rayna. Notes are mine.</p>
<p><strong>UI Layer</strong></p>
<ul>
<li>Test 1: Verify Email (User ID) field has focus on page load</li>
<li>Test 2: Verify Empty Email (User ID) field and Password field</li>
<li>Test 3: Verify Empty Email (User ID) field</li>
<li>Test 4: Verify Empty Password field</li>
<li>Test 5: Verify Correct sign in</li>
<li>Test 6: Verify Incorrect sign in</li>
<li>Test 7: Verify Password Reset - working link</li>
<li>Test 8: Verify Password Reset - invalid emails</li>
<li>Test 9: Verify Password Reset - valid email</li>
<li>Test 10: Verify Password Reset - using new password</li>
<li>Test 11: Verify Password Reset - using old password</li>
<li>Test 12: Verify whether password text is hidden</li>
<li>Test 13: Verify text field limits - whether the browser accepts more than the allowed database limits</li>
<li>Test 14: Verify that validation message is displayed in case user exceeds the character limit of the username and password fields</li>
<li>Test 15: Verify if there is checkbox with label "remember password" in the login page</li>
<li>Test 16: Verify if its allowed the username to contain non printable characters? If not, this is invalid on the 'create user' section.</li>
<li>Test 17: Verify if the user must be logged in to access any other area of the site.</li>
</ul>
<p>Tests 10 and 11 are particularly relevant for Fedora Account System where
you need a really strong password and (at least in the past) had to change it more often
and couldn't reuse any of your old passwords. As a user I really hate this b/c I can't remember
my own password but it makes for a good test scenario.</p>
<p>13 and 14 are also something I rarely see and could make a nice case for
property based testing.</p>
<p>16 would have been the bread and butter of testing Emoj.li (the first emoji-only
social network).</p>
<p><strong>Keyboard Specific</strong></p>
<ul>
<li>Test 18: Verify Navigate to all fields</li>
<li>Test 19: Verify Enter submits on password focus</li>
<li>Test 20: Verify Space submits on login focus</li>
<li>Test 21: Verify Enter submits</li>
</ul>
<p>These are all so relevant with beautifully styled websites nowadays. The one I hate the most
is when space key doesn't trigger select/unselect for checkboxes which are actually
images!</p>
<p><strong>Security:</strong></p>
<ul>
<li>Test 22: Verify SQL Injections testing - password field</li>
<li>Test 23: Verify SQL Injections testing - username field</li>
<li>Test 24: Verify SQL Injections testing - reset password</li>
<li>Test 25: Verify Password/username not visible from URL login</li>
<li>Test 26: Verify For security point of view, in case of incorrect credentials user is displayed the message like
  "incorrect username or password" instead of exact message pointing at the field that is incorrect.
  As message like "incorrect username" will aid hacker in brute-forcing the fields one by one</li>
<li>Test 27: Verify the timeout of the login session</li>
<li>Test 28: Verify if the password can be copy-pasted or not</li>
<li>Test 29: Verify that once logged in, clicking back button doesn't logout user</li>
</ul>
<p>22, 23 and 24 are a bit generic and I guess can be collapsed into one. Better yet make
them more specific instead.</p>
<p>Test 28 may sound like nonsense but is not. I remember back in the days that
it was possible to copy and paste the password out of Windows dial-up credentials screen.
With heavily styled form fields it is possible to have this problem again so it is
a valid check IMO.</p>
<p><strong>Others:</strong></p>
<ul>
<li>Test 30: Verify that the password is in encrypted form when entered</li>
<li>Test 31: Verify the user must be logged in to call any web services.</li>
<li>Test 32: Verify if the username is allowed to contain non printable characters,
  the code handling login can deal with them and no error is thrown.</li>
</ul>
<p>I think Test 30 means to validate that the backend doesn't store passwords in plain text
but rather stores their hashes.</p>
<p>32 is a duplicate of 16. I also say why only the username? Password field is also
a good candidate for this.</p>
<p>If you check how I
<a href="http://atodorov.org/blog/2016/04/12/how-to-hire-software-testers-pt-1/">would test a login form</a> you will find
some similarities but there are also scenarios which are different. I'm interested to
see what other scenarios we've both missed, especially ones which have manifested themselves
as bugs in actual applications.</p>
<p>Thanks for reading and happy testing!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Wed 14 June 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/06/14/vmwares-favorite-login-form/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/06/12/monitoring-behavior-via-automated-tests/" rel="bookmark" title="Permalink to Monitoring behavior via automated tests">
                <h2 class="post-title">
                    Monitoring behavior via automated tests
                </h2>
            </a>
                <p>In my last several presentations I briefly talked about
using your tests as a monitoring tool. I've not been eating my own
dog food and stuff failed in production!</p>
<h2>What is monitoring via testing</h2>
<p>This is a technique I coined 6 months ago while working with Tradeo's team.
I'm not the first one to figure this out so if you know the proper
name for it please let me know in the comments.
So why not take a subset of your automated tests and run them regularly against
production? Let's say every hour?</p>
<p>In my particular case we
started with integration tests which interact with the product (a web app)
in a way that a living person would do. E.g. login, update their settings,
follow another user, chat with another user, try to deposit money, etc.
The results from these tests are logged into a database and then charted
(using Grafana). This way we can bring lots of data points together and easily
analyze them.</p>
<p>This technique has the added bonus that we can cover the most critical
test paths in a couple of minutes and do so regularly without human intervention.
Perusing the existing monitoring infrastructure of the devops team we can configure
alerts if need be. This makes it sort of early detection/warning system plus
it gives a degree of possibility to spot correlations between data points or
patterns.</p>
<p>As simple as it sounds I've heard about a handfull of companies doing this
sort of continuous testing against production. Maybe you can implement something
similar in your organization and we can talk more about the results?</p>
<h2>Why does it matter</h2>
<p>Anyway, everyone knows
<a href="http://atodorov.org/blog/2017/05/27/learn-python-selenium-automation-in-8-weeks/">how to write Selenium tests</a>
so I'm not going to bother you with the details. Why does this kind of
testing matter?</p>
<p>Do you remember a recent announcement by GitHub about Travis CI leaking some
authentication tokens into their public log files? I did receive an email about
this but didn't pay attention to it because I don't use GitHub tokens for
anything I do in Travis. However as a safety measure GitHub had went ahead and
wiped out my security tokens.</p>
<p>The result from this is that my
<a href="http://mrsenko.com/blog/mr-senko/2016/05/18/triggering-automatic-dependency-testing/">automated upstream testing infrastructure</a>
had stopped working! In particular my requests to the GitHub API stopped
working. And I didn't even know about it!</p>
<p>This means that since May 24th there have been at least 4 new
versions of libraries and frameworks on which some of my software depends
and I failed to test them! One of them was <em>Django 1.11.2</em>.</p>
<p>I have supplied a new GitHub token for my infra but if I had monitoring
I would have known about this problem well in advance. Next I'm off to write
some monitoring tests and also implement better failure detection in
<a href="https://github.com/MrSenko/strazar">Strazar</a> itself!</p>
<p>Thanks for reading and happy testing (in production)!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Mon 12 June 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/06/12/monitoring-behavior-via-automated-tests/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/06/11/can-a-nested-function-assign-to-variables-from-the-parent-function/" rel="bookmark" title="Permalink to Can a nested function assign to variables from the parent function">
                <h2 class="post-title">
                    Can a nested function assign to variables from the parent function
                </h2>
            </a>
                <p>While working on a
<a href="https://github.com/getpelican/pelican/pull/1909">new feature for Pelican</a>
I've put myself in a situation where I have two functions, one nested inside
the other and I want the nested function to assign to variable from the
parent function. Turns out this isn't so easy in Python!</p>
<div class="highlight"><span class="filename">hello.py</span><pre><span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">who</span><span class="p">):</span>
    <span class="n">greeting</span> <span class="o">=</span> <span class="s">&#39;Hello&#39;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">do_print</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">print</span> <span class="n">i</span><span class="p">,</span> <span class="n">greeting</span><span class="p">,</span> <span class="n">who</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">do_print</span><span class="p">()</span>

    <span class="n">do_print</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">hello</span><span class="p">(</span><span class="s">&#39;World&#39;</span><span class="p">)</span>
</pre></div>


<p>The example above is a recursive <em>Hello World</em>. Notice the <code>i += 1</code> line!
This line causes <code>i</code> to be considered local to <code>do_print()</code> and the result
is that we get the following failure on Python 2.7:</p>
<div class="highlight"><pre><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s">&quot;./test.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">16</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">hello</span><span class="p">(</span><span class="s">&#39;World&#39;</span><span class="p">)</span>
  <span class="n">File</span> <span class="s">&quot;./test.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">13</span><span class="p">,</span> <span class="ow">in</span> <span class="n">hello</span>
    <span class="n">do_print</span><span class="p">()</span>
  <span class="n">File</span> <span class="s">&quot;./test.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">6</span><span class="p">,</span> <span class="ow">in</span> <span class="n">do_print</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
<span class="ne">UnboundLocalError</span><span class="p">:</span> <span class="n">local</span> <span class="n">variable</span> <span class="s">&#39;i&#39;</span> <span class="n">referenced</span> <span class="n">before</span> <span class="n">assignment</span>
</pre></div>


<p>We can workaround by using a global variable like so:</p>
<div class="highlight"><span class="filename">hello.py using global variable</span><pre><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">who</span><span class="p">):</span>
    <span class="n">greeting</span> <span class="o">=</span> <span class="s">&#39;Hello&#39;</span>

    <span class="k">def</span> <span class="nf">do_print</span><span class="p">():</span>
        <span class="k">global</span> <span class="n">i</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">print</span> <span class="n">i</span><span class="p">,</span> <span class="n">greeting</span><span class="p">,</span> <span class="n">who</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">do_print</span><span class="p">()</span>

    <span class="n">do_print</span><span class="p">()</span>
</pre></div>


<p>However I prefer not to expose internal state outside the <code>hello()</code>
function. Only if there was a keyword similar to <strong>global</strong>. In Python 3
there is <strong>nonlocal</strong>!</p>
<div class="highlight"><span class="filename">hello.py using nonlocal, Python 3</span><pre><span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">who</span><span class="p">):</span>
    <span class="n">greeting</span> <span class="o">=</span> <span class="s">&#39;Hello&#39;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">do_print</span><span class="p">():</span>
        <span class="n">nonlocal</span> <span class="n">i</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">greeting</span><span class="p">,</span> <span class="n">who</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">do_print</span><span class="p">()</span>

    <span class="n">do_print</span><span class="p">()</span>
</pre></div>


<p><strong>nonlocal</strong> is nice but it doesn't exist in Python 2! The workaround is to
not assign state to the variable itself, but instead use a mutable container.
That is instead of a scalar use a list or a dictionary like so:</p>
<div class="highlight"><span class="filename">hello.py where i is a list, Python 2</span><pre><span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">who</span><span class="p">):</span>
    <span class="n">greeting</span> <span class="o">=</span> <span class="s">&#39;Hello&#39;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">do_print</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">print</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">greeting</span><span class="p">,</span> <span class="n">who</span>
        <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">do_print</span><span class="p">()</span>

    <span class="n">do_print</span><span class="p">()</span>
</pre></div>


<p>Thanks for reading and happy coding!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Sun 11 June 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/06/11/can-a-nested-function-assign-to-variables-from-the-parent-function/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/06/10/semantically-invalid-input/" rel="bookmark" title="Permalink to Semantically Invalid Input">
                <h2 class="post-title">
                    Semantically Invalid Input
                </h2>
            </a>
                <div class="highlight"><span class="filename">Unsolvable Square example</span><pre><span class="o">.</span> <span class="o">.</span> <span class="mi">9</span> <span class="o">|</span> <span class="o">.</span> <span class="mi">2</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">7</span> <span class="o">.</span> <span class="o">.</span>
<span class="mi">8</span> <span class="o">.</span> <span class="mi">6</span> <span class="o">|</span> <span class="o">.</span> <span class="o">.</span> <span class="mi">4</span> <span class="o">|</span> <span class="o">.</span> <span class="o">.</span> <span class="mi">5</span>
<span class="o">.</span> <span class="o">.</span> <span class="mi">3</span> <span class="o">|</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">|</span> <span class="o">.</span> <span class="o">.</span> <span class="mi">4</span>
<span class="o">------+-------+------</span>
<span class="mi">6</span> <span class="o">.</span> <span class="o">.</span> <span class="o">|</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">|</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
<span class="err">?</span> <span class="mi">2</span> <span class="o">.</span> <span class="o">|</span> <span class="mi">7</span> <span class="mi">1</span> <span class="mi">3</span> <span class="o">|</span> <span class="mi">4</span> <span class="mi">5</span> <span class="o">.</span>
<span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">|</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">|</span> <span class="o">.</span> <span class="o">.</span> <span class="mi">2</span>
<span class="o">------+-------+------</span>
<span class="mi">3</span> <span class="o">.</span> <span class="o">.</span> <span class="o">|</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">|</span> <span class="mi">5</span> <span class="o">.</span> <span class="o">.</span>
<span class="mi">9</span> <span class="o">.</span> <span class="o">.</span> <span class="o">|</span> <span class="mi">4</span> <span class="o">.</span> <span class="o">.</span> <span class="o">|</span> <span class="mi">8</span> <span class="o">.</span> <span class="mi">7</span>
<span class="o">.</span> <span class="o">.</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">2</span> <span class="mi">5</span> <span class="o">.</span> <span class="o">|</span> <span class="mi">3</span> <span class="o">.</span> <span class="o">.</span>
</pre></div>


<p>In a comment to a
<a href="http://atodorov.org/blog/2016/04/16/how-to-hire-software-testers-pt-2/">previous post</a>
<em>Flavio Poletti</em> proposed a very interesting test case for a function which solves
the Sudoku game - <em>semantically invalid input, i.e. an input that passes intermediate
validation checks (no duplicates in any row/col/9-square) but that cannot possibly
have a solution</em>.</p>
<p>Until then I thought that Sudoku was a completely deterministic game and if input
followed all validation checks then we always have a solution. Apparently I was wrong!
Reading more on the topic I discovered these
<a href="http://sudopedia.enjoysudoku.com/Test_Cases.html">Sudoku test cases from Sudopedia</a>.
Their <a href="http://sudopedia.enjoysudoku.com/Invalid_Test_Cases.html">Invalid Test Cases</a>
section lists several examples of semantically invalid input in Sudoku:</p>
<ul>
<li>Unsolvable Square;</li>
<li>Unsolvable Box;</li>
<li>Unsolvable Column;</li>
<li>Unsolvable Row;</li>
<li>Not Unique with examples having 2, 3, 4, 10 and 125 solutions</li>
</ul>
<p>The example above cannot be solved because the left-most
square of the middle row (r5c1) has no possible candidates.</p>
<p>Following the rule <em>non-repeating numbers from 1 to 9 in each row</em> for row 5 we're
left with numbers: 6, 8 and 9. For (r5c1) 6 is a no-go because it is already present
in the same square. Then 9 is a no-go because it is present in column 1. Which leaves
us with 8, which is also present in column 1! Pretty awesome, isn't it?</p>
<p>Also check the
<a href="http://sudopedia.enjoysudoku.com/Valid_Test_Cases.html">Valid Test Cases</a> section
which includes other interesting examples and definitely not ones which I have considered
previously when <a href="http://atodorov.org/blog/2016/04/16/how-to-hire-software-testers-pt-2/">testing Sudoku</a>.</p>
<p>On a more practical note I have been trying to remember a case from my QA practice
where we had input data that matched all conditions but is semantically invalid. I
can't remember of such a case. If you do have examples about semantically invalid
data in real software please let me know in the comments below!</p>
<p>Thanks for reading and happy testing!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Sat 10 June 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/06/10/semantically-invalid-input/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/05/28/top-7-lessons-from-134-books/" rel="bookmark" title="Permalink to Top 7 Lessons From 134 Books">
                <h2 class="post-title">
                    Top 7 Lessons From 134 Books
                </h2>
            </a>
                <p>This post is a quick summary of the
<a href="https://www.youtube.com/watch?v=Pr5e9b9ZjvA&amp;list=PLFjlI7p-h1hxBP3cIjEqePSeoBDHud5Db&amp;index=4">Top 7 Lessons From 134 Books</a>
video by the OnePercentBetter YouTube channel. I am posting it as self
reference and because I'm interested to know what works for my readers.</p>
<h2>Lesson 1: Boost your happy chemicals</h2>
<p>The essence of this is to get your 8 hours of sleep, exercise regularly and
eat healthy.</p>
<p>Couple of years ago I was a sugar addict and stopped cold turkey.
Then I tried fasting for a year,
strictly following the religious calendar every day (wasn't that hard). Then
I started doing some moderate exercise.</p>
<p>As boring as it may sound it does actually work. I still have my urges but
I am feeling much more energetic right now. I am able to maintain concentration
for longer periods and I am actually more productive.</p>
<h2>Lesson 2: Forget self-help, be kind</h2>
<p>Just be kind!</p>
<h2>Lesson 3: Value your time</h2>
<p>One of the lessons which very much resonates with me.
I hate people who don't value their time, mostly because when I
have to interact with such people they are also wasting my own time.</p>
<p>Not caring what others think about you also falls into this category.</p>
<h2>Lesson 4: The 80/20 principle</h2>
<p>80% of the returns come from 20% of the causes. Again one of my favorites
which I learned from <a href="http://amzn.to/2rK6VmT">The 4-Hour workweek</a> by Tim Ferris.</p>
<p>This principle can be applied to every aspect of our lives to maximize the
returns. I still not very good at applying it (I think) but I'm trying to
figure it out.</p>
<h2>Lesson 5: Learn how to win friends and influence people</h2>
<p>This is from another favorite book of mine.
<a href="http://amzn.to/2qqlckD">How to Win Friends and Influence People</a> by Dale Carnegie.
Just read the book!</p>
<h2>Lesson 6: Create, don't consume</h2>
<p>It is only when we start creating that opportunities start coming our way!
I can confirm this from experience. It is because of this blog, my open source work
on GitHub, my teaching work and my speaking engagements that people contact me
every day with opportunities and work related proposals.</p>
<p>Sure you need the skills to back those up, but the strange thing about creating is
that it actually improves these very same skills (plus teaches you a few other)
and that helps you deliver on the new opportunities that just came up. It's like
an enchanted circle but a good one!</p>
<h2>Lesson 7: Mind over matter</h2>
<p>No drama, please. There are events in our lives which we can't control. Why then bother
worrying about them and spending energy? The only thing we can do is choose how
to react when these events happen. I'm not saying don't care about anything but
rather care more selectively and spend more energy on the things that matter.</p>
<h2>Bonus: 7 more lessons</h2>
<p>OnePercentBetter made a new video called
<a href="https://www.youtube.com/watch?v=8lLesO2FEHg">7 Unconventional Lessons From 179 Books (NOT Taught At SCHOOL)</a>
which adds the following lessons:</p>
<ol>
<li>Future blindness - people sucks at predicting the future. If you want to
   know what it is really like to be in somebody's position just ask them.</li>
<li>The 1% rule - small improvements applied continuously over a period of time
   have drastic effects.</li>
<li>University is a scam - this one is controversial but the idea is that
   information is everywhere and accessible for free and opportunities are ripe.
   You don't (always) need to go to university to become successful.</li>
<li>Don't give a fuck - what people think about you</li>
<li>Mentorship is the fast-track to success - find a mentor to speed up your
   learning, your success rate, etc, learn from other people's mistakes instead
   of committing them on your own. I will also add learn how to and become a
   mentor yourself.</li>
<li>Direct your efforts - set a goal and work towards it every single day.
   This gives meaning to everything you do.</li>
<li>Pseudoscience can be beneficial - sometimes we don't have strong scientific
   proof that something is beneficial but experience tells us it probably is.
   Don't rush to decisions, analyze the risks and potential benefits before jumping in
   but do keep an eye on new methods and techniques. If they seem to work why not
   reap the benefits before the masses ?</li>
</ol>
<p>Thanks for reading and don't forget to comment and give me your feedback!</p>
<p><em>Social media image source: https://elearningindustry.com/top-10-psychology-books-elearning-professional-read</em></p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Sun 28 May 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/05/28/top-7-lessons-from-134-books/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/05/27/learn-python-selenium-automation-in-8-weeks/" rel="bookmark" title="Permalink to Learn Python & Selenium Automation in 8 weeks">
                <h2 class="post-title">
                    Learn Python &amp; Selenium Automation in 8 weeks
                </h2>
            </a>
                <p>Couple of months ago I conducted a practical,
instructor lead training in Python and Selenium automation for
manual testers. You can find the materials at
<a href="https://github.com/atodorov/qa-automation-python-selenium-101">GitHub</a>.</p>
<p>The training consists of several basic modules and practical homework
assignments. The modules explain</p>
<ol>
<li>The basic structure of a Python program and functions</li>
<li>Commonly used data types</li>
<li>If statements and (for) loops</li>
<li>Classes and objects</li>
<li>The Python unit testing framework and its assertions</li>
<li>High-level introduction to Selenium with Python</li>
<li>High-level introduction to the Page Objects design pattern</li>
<li>Writing automated tests for real world scenarios
   without any help from the instructor.</li>
</ol>
<p>Every module is intended to be taken in the course of 1 week and begins with
links to preparatory materials and lots of reading. Then I help the students
understand the basics and explain with more examples, often writing code as
we go along. At the end there is the homework assignment for which I expect
a solution presented by the end of the week so I can comment and code-review it.</p>
<p>All assignments which require the student to implement functionality, not tests,
are paired with a test suite, which the student should use to validate their
solution.</p>
<h2>What worked well</h2>
<p>Despite everything I've written below I had 2 students (from a group of 8)
which showed very good progress. One of them was the absolute star, taking
active participation in every class and doing almost all homework assignments
on time, pretty much without errors. I think she'd had some previous training
or experience though.
She was in the USA, training was done remotely via Google Hangouts.</p>
<p>The other student was in Sofia, training was done in person. He is not on the
same level as the US student but is the best from the Bulgarian team. IMO he
lacks a little bit of motivation. He "cheated" a bit on some tasks providing
non-standard, easier solutions and made most of his assignments. After the first
Selenium session he started creating small scripts to extract results from
football sites or as helpers to be applied in the daily job.
The interesting
fact for me was that he created his programs as <code>unittest.TestCase</code> classes.
I guess because this was the way he knew how to run them!?!</p>
<p>There were another few students which had had some prior experience with
programming but weren't very active in class so I can't tell how their
careers will progress. If they put some more effort into it I'm sure they
can turn out to have decent programming skills.</p>
<h2>What didn't work well</h2>
<p>Starting from the beginning most students failed to read the preparatory
materials. Some of the students did read a little bit, others didn't read at all.
At the times when they came prepared I had the feeling the sessions progressed
more smoothly. I also had students joining late in the process, which for the
most part didn't participate at all in the training. I'd like to avoid that in
the future if possible.</p>
<p>Sometimes students complained about lack of example code, although
<em>Dive into Python</em> includes tons of examples. I've resorted to sending them
the example.py files which I produced during class.</p>
<p>The practical part of the training was mostly myself programming on a big
TV screen in front of everyone else. Several times someone from the students
took my place. There wasn't much active participation on their part and
unfortunately they didn't want to bring personal laptops to the training
(or maybe weren't allowed)! We did have a company provided laptop though.</p>
<p>When practicing functions and arithmetic operations the students struggled
with basic maths like breaking down a number into its digits or vice versa,
working with Fibonacci sequences and the like. In some cases they cheated
by converting to/from strings and then iterating over them. Also some
hard-coded the first few numbers of the Fibonacci sequence and returned
it directly. Maybe an in-place
explanation of the underlying maths would have been helpful but honestly
I was surprised by this. Somebody please explain or give me an advise here!</p>
<p>I am completely missing examples of the <code>datetime</code> and <code>timedelta</code> classes
which tuned out to be very handy in the practical Selenium tasks and we had
to go over them on the fly.</p>
<p>The OOP assignments went mostly undone, not to mention one of them had
bonus tasks which are easily solved using recursion. I think we could
skip some of the OOP practice (not sure how safe that is) because I really
need classes only for constructing the tests and we don't do anything fancy
there.</p>
<p>Page Object design pattern is also OOP based and I think that went somewhat
well granted that we are only passing values around and performing some actions.
I didn't put constraints nor provided guidance on what the classes should
look like and which methods go where. Maybe I should have made it easier.</p>
<p>Anyway, given that Page Objects is being replaced by Screenplay pattern,
I think we can safely stick to the all-in-one functional based Selenium
tests. Maybe utilize helper functions for repeated tasks (like login).
Indeed this is what I was using last year with Rspec &amp; Capybara!</p>
<h2>What students didn't understand</h2>
<p>Right until the end I had people who had troubles understanding function
signatures, function instances and calling/executing a function. Also
returning a value from a function vs. printing the (same) value on screen
or assigning to the same global variable (e.g. FIB_NUMBERS).</p>
<p>In the same category falls using method parameters vs. using global variables
(which happened to have the same value), using the parameters as arguments to
another function inside the body of the current function, using class attributes
(e.g. <code>self.name</code>) to store and pass values around vs. local variables in methods
vs. method parameters which have the same names.</p>
<p>I think there was some confusion about lists, dictionaries and tuples but
we did practice mostly with list structures so I don't have enough information.</p>
<p>I have the impression that object oriented programming (classes and instances,
we didn't go into inheritance) are generally confusing to beginners with zero
programming experience. The classical way to explain them is by using some
abstractions like animal -&gt; dog -&gt; a particular dog breed -&gt; a particular pet.
OOP was explained to me in a similar way back in school so these kinds of
abstractions are very natural for me. I have no idea if my explanation sucks or students are having hard time
wrapping their heads around the abstraction. I'd love to hear some feedback
from other instructors on this one.</p>
<p>I think there is some misunderstanding between a class (a definition of behavior)
and an instance/object of this class (something which exists into memory). This
may also explain the difficulty remembering or figuring out what <code>self</code> points to
and why do we need to use it inside method bodies.</p>
<p>For <code>unittest.TestCase</code> we didn't do lots of practice which is my fault.
The homework assignments request the students to go back to solutions
of previous modules and implement more tests for them. Next time I should
provide a module (possibly with non-obvious bugs) and request to write
a comprehensive test suite for it.</p>
<p>Because of the missing practice there was some confusion/misunderstanding
about the <code>setUpClass/tearDownClass</code> and the <code>setUp/tearDown</code> methods.
Also add to the mix that the first are <code>@classmethod</code> while the later
are not. "To be safe" students always defined both as class methods!</p>
<p>I have since corrected the training materials but we didn't have
good examples (nor practiced) explaining the difference between
<code>setUpClass</code> (executed once aka before suite) and <code>setUp</code>
(possibly executed multiple times aka before test method).</p>
<p>On the Selenium side I think it is mostly practice which students lack,
not understanding. The entire Selenium framework (any web test framework
for that matter) boils down to</p>
<ul>
<li>Load a page</li>
<li>Find element(s)</li>
<li>Click or hover (that one was tricky) element</li>
<li>Get element's attribute value or text</li>
<li>Wait for the proper page to load (or worst case AJAX calls)</li>
</ul>
<p>IMO finding the correct element on the page is on-par with waiting
(which also relies on locating elements) and took 80% of the time we spent
working with Selenium.</p>
<p>Thanks for reading and don't forget to comment and give me your feedback!</p>
<p><em>Image source: https://www.udemy.com/selenium-webdriver-with-python/</em></p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Sat 27 May 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/05/27/learn-python-selenium-automation-in-8-weeks/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/04/20/quality-assurance-according-2-einstein/" rel="bookmark" title="Permalink to Quality Assurance According 2 Einstein">
                <h2 class="post-title">
                    Quality Assurance According 2 Einstein
                </h2>
            </a>
                <p><img alt="logo" src="/images/qa_einstein.png" title="logo" /></p>
<p><a href="https://www.facebook.com/events/1887550261534408/">Quality Assurance According 2 Einstein</a>
is a talk which introduces several different ideas about how we need to think
and approach software testing. It touches on subjects like mutation testing,
pairwise testing, automatic test execution, smart test non-execution, using tests
as monitoring tools and team/process organization.</p>
<p>Because testing is more thinking than writing I have chosen a different format
for this presentation. It contains only slides with famous quotes from one
of the greatest thinkers of our time - Albert Einstein!</p>
<p>This blog post includes the accompanying links and references only! It is my first
iteration on the topic so expect it to be unclear and incomplete, use your imagination!
I will continue 
working and presenting on the same topic in the next few months
so you can expect updates from time to time. In the mean time I am happy to discuss
with you down in the comments.</p>
<blockquote>
<p>IMAGINATION
IS MORE
IMPORTANT
THAN KNOWLEDGE.</p>
</blockquote>
<ul>
<li><a href="http://atodorov.org/blog/2016/03/25/hello-world-qa-challenge/">Hello World bug challenge</a></li>
<li><a href="http://atodorov.org/blog/2016/04/16/how-to-hire-software-testers-pt-2/#disqus_thread">Testing a Sudoku</a></li>
<li><a href="https://github.com/weldr/welder-web/pull/56">https://github.com/weldr/welder-web/pull/56</a></li>
<li><a href="https://github.com/weldr/welder-web/pull/59">https://github.com/weldr/welder-web/pull/59</a></li>
</ul>
<blockquote>
<p>THE FASTER YOU GO,
THE SHORTER
YOU ARE.</p>
</blockquote>
<ul>
<li><a href="http://bit.ly/GTAC2016Unity3D">Using Statistics to Predict Which Tests to Run</a></li>
<li><a href="http://bit.ly/ISTA2016ExMachina">The framework that knows its bugs</a></li>
<li><a href="http://atodorov.org/blog/2017/04/14/testing-red-hat-enterprise-linux-the-microsoft-way/">Testing Red Hat Enterprise Linux the Microsoft way</a></li>
<li><a href="http://mrsenko.com/blog/mr-senko/2016/05/18/triggering-automatic-dependency-testing/">Automatic dependency testing with Strazar</a></li>
<li><a href="http://atodorov.org/blog/2017/04/15/automatic-cargo-update-pull-requests-for-rust-projects/">Automatic cargo update, test and pull request</a></li>
</ul>
<blockquote>
<p>IF THE FACTS
DON'T FIT
THE THEORY,
CHANGE THE FACTS.</p>
</blockquote>
<ul>
<li><a href="https://www.youtube.com/watch?v=sAfROROGujU&amp;list=PLFjlI7p-h1hxBP3cIjEqePSeoBDHud5Db&amp;index=47">Coverage is Not Strongly Correlated with Test Suite Effectiveness</a></li>
<li><a href="https://www.youtube.com/watch?v=NKEptA3KP08&amp;list=PLFjlI7p-h1hxBP3cIjEqePSeoBDHud5Db&amp;index=1">Code Coverage is a Strong Predictor of Test Suite Effectiveness</a></li>
<li><a href="http://atodorov.org/blog/2016/12/27/mutation-testing-vs-coverage/">Mutation testing vs. coverage, Pt. 1</a></li>
<li><a href="http://atodorov.org/blog/2017/04/05/mutation-testing-vs-coverage-pt-2/">Mutation testing vs. coverage, Pt. 2</a></li>
<li>There are 101 coverage metrics according to <a href="http://www.badsoftware.com/coverage.htm">Cem Kaner</a>.
  Which ones are you measuring and what conclusions are you making out of these metrics?</li>
</ul>
<blockquote>
<p>THE WHOLE OF
SCIENCE
IS NOTHING MORE
THAN A REFINEMENT
OF EVERYDAY
THINKING.</p>
</blockquote>
<ul>
<li><a href="https://github.com/HackBulgaria/QA-and-Automation-101/tree/master/lesson12">How to find 1000 bugs in 30 minutes</a></li>
<li><a href="https://www.youtube.com/watch?v=m5NfgXP76Vw&amp;index=1&amp;list=PLFjlI7p-h1hxBP3cIjEqePSeoBDHud5Db&amp;t=103s">How we found a million style and grammar errors in the English Wikipedia</a></li>
<li><a href="https://www.youtube.com/watch?v=56oNQf5oITw&amp;list=PLFjlI7p-h1hxBP3cIjEqePSeoBDHud5Db&amp;t=1300s&amp;index=47">Simple Testing Can Prevent Most Critical Failures</a></li>
<li><a href="https://www.youtube.com/watch?v=nCGBgI1MNwE&amp;list=PLFjlI7p-h1hxBP3cIjEqePSeoBDHud5Db&amp;index=60">Need it robust, make it fragile</a><ul>
<li>btw its me who asks the first question at the end :)</li>
</ul>
</li>
</ul>
<blockquote>
<p>INSANITY -
DOING THE SAME THING
OVER AND OVER
AND EXPECTING
DIFFERENT RESULTS.</p>
</blockquote>
<ul>
<li><a href="http://atodorov.org/blog/2016/12/28/4-quick-wins-to-manage-the-cost-of-software-testing/">4 Quick Wins to Manage the Cost of Software Testing</a></li>
</ul>
<p>This principle can be applied to any team/process within the organization.
The above link is reference to a nice book which was recommended to me but the
gist of it is that we always need to analyze, ask questions and change is we want
to achieve great results. A practicle example of what is possible if you follow
this principle is this talk
<a href="https://www.youtube.com/watch?v=khSsjjg2eSQ&amp;index=1&amp;list=PLFjlI7p-h1hxBP3cIjEqePSeoBDHud5Db">Accelerate Automation Tests From 3 Hours to 3 Minutes</a>.</p>
<blockquote>
<p>THE ONLY
REASON FOR TIME
IS SO THAT
EVERYTHING DOESN'T
HAPPEN AT ONCE.</p>
</blockquote>
<p>The topic here is "using tests as a monitoring tool".
This is something I started a while back ago, helping a prominent startup with their
production testing but my involvement ended very soon after the framework was
deployed live so I don't have lots of insight.</p>
<p>As the first few days this technique identified some unexpected behaviors,
for example a 3rd party service was updating very often. Once even they were
broken for a few hours - something nobody had information about.</p>
<p>Since then I've heard about 2 more companies using similar techniques to continuously
validate that production software continues to work without having a physical
person to verify it. In the event of failures there are alerts which are
delath with accordingly.</p>
<blockquote>
<p>NO PROBLEM
CAN BE SOLVED FROM
THE SAME LEVEL
OF CONSIOUSNESS
THAT CREATED IT.</p>
</blockquote>
<p>That much must be obvious to us quality engineers. What about the future however?</p>
<ul>
<li><a href="https://www.quora.com/How-do-I-implement-AI-in-test-automation">How do I implement AI in test automation</a></li>
<li><a href="http://sourced.tech/">source{d} - Building the first AI that understands code</a></li>
</ul>
<p>I don't have anything more concrete here. Just looking towards what is coming next!</p>
<blockquote>
<p>DO NOT WORRY ABOUT
YOUR DIFFICULTIES
IN MATHEMATICS.
I CAN ASSURE
YOU MINE ARE STILL
GREATER.</p>
</blockquote>
<p>Thanks for reading and happy testing!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Thu 20 April 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/04/20/quality-assurance-according-2-einstein/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/04/15/automatic-cargo-update-pull-requests-for-rust-projects/" rel="bookmark" title="Permalink to Automatic cargo update & pull requests for Rust projects">
                <h2 class="post-title">
                    Automatic cargo update & pull requests for Rust projects
                </h2>
            </a>
                <p>If you follow my blog you are aware that I use automated tools to do some
boring tasks instead of me. For example they can detect when new versions of
dependencies I'm using are available and then schedule testing against them on the fly.</p>
<p>One of these tools is
<a href="http://mrsenko.com/blog/mr-senko/2016/05/18/triggering-automatic-dependency-testing/">Strazar</a>
which I use heavily for my Django based packages.
Example: <a href="https://travis-ci.org/atodorov/django-s3-cache/builds/218758538">django-s3-cache build job</a>.</p>
<p>Recently I've made a slightly different proof-of-concept for a Rust project.
Because rustc and various dependencies (called crates) are updated very often
we didn't want to expand the test matrix like Strazar does. Instead we wanted to
always build &amp; test against the latest crates versions and if that passes
create a pull request for the update (in <code>Cargo.lock</code>). All of this unattended
of course!</p>
<p>To start create a cron job in Travis CI which will execute once per day and call your
test script. The script looks like this:</p>
<div class="highlight"><span class="filename">cargo-update-and-pr</span><pre><span class="c">#!/bin/bash</span>

<span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$GITHUB_TOKEN</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;GITHUB_TOKEN is not defined&quot;</span>
    <span class="nb">exit </span>1
<span class="k">fi</span>

<span class="nv">BRANCH_NAME</span><span class="o">=</span><span class="s2">&quot;automated_cargo_update&quot;</span>

git checkout -b <span class="nv">$BRANCH_NAME</span>
cargo update <span class="o">&amp;&amp;</span> cargo <span class="nb">test</span>

<span class="nv">DIFF</span><span class="o">=</span><span class="sb">`</span>git diff<span class="sb">`</span>
<span class="c"># NOTE: we don&#39;t really check the result from testing here. Only that</span>
<span class="c"># something has been changed, e.g. Cargo.lock</span>
<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&quot;</span><span class="nv">$DIFF</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="c"># configure git authorship</span>
    git config --global user.email <span class="s2">&quot;atodorov@MrSenko.com&quot;</span>
    git config --global user.name <span class="s2">&quot;Alexander Todorov&quot;</span>

    <span class="c"># add a remote with read/write permissions!</span>
    <span class="c"># use token authentication instead of password</span>
    git remote add authenticated https://atodorov:<span class="nv">$GITHUB_TOKEN</span>@github.com/atodorov/bdcs-api-rs.git

    <span class="c"># commit the changes to Cargo.lock</span>
    git commit -a -m <span class="s2">&quot;Auto-update cargo crates&quot;</span>

    <span class="c"># push the changes so that PR API has something to compare against</span>
    git push authenticated <span class="nv">$BRANCH_NAME</span>

    <span class="c"># finally create the PR</span>
    curl -X POST -H <span class="s2">&quot;Content-Type: application/json&quot;</span> -H <span class="s2">&quot;Authorization: token </span><span class="nv">$GITHUB_TOKEN</span><span class="s2">&quot;</span> <span class="se">\</span>
         --data <span class="s1">&#39;{&quot;title&quot;:&quot;Auto-update cargo crates&quot;,&quot;head&quot;:&quot;automated_cargo_update&quot;,&quot;base&quot;:&quot;master&quot;, &quot;body&quot;:&quot;@atodorov review&quot;}&#39;</span> <span class="se">\</span>
         https://api.github.com/repos/atodorov/bdcs-api-rs/pulls
<span class="k">fi</span>
</pre></div>


<p>A few notes here:</p>
<ul>
<li>You need to define a secret <code>GITHUB_TOKEN</code> variable for authentication;</li>
<li>The script doesn't force push, but in practice that may be useful (e.g. updating the PR);</li>
<li>The script doesn't have any error handling;</li>
<li>If PR is still open GitHub will tell us about it but we ignore the result here;</li>
<li><strong>DON'T</strong> paste this into your <code>Makefile</code> because the <code>GITHUB_TOKEN</code> variable will be
  expanded into the logs and your secrets go away! Always call the script from your
  <code>Makefile</code> to avoid revealing secrets.</li>
<li>I am using topic branches because this is a POC. Switch to <em>master</em> and maybe move
  all URLs as variables at the top of the script!</li>
<li>I run this cron build against a fork of the project because the team doesn't feel
  comfortable having automated commits/pushes. I also create the pull requests against
  my own fork. You will have to adjust the targets if you want your PR to go to the
  original repository.</li>
</ul>
<p>Here is the PR which was created by this script:
<a href="https://github.com/atodorov/bdcs-api-rs/pull/5">https://github.com/atodorov/bdcs-api-rs/pull/5</a></p>
<p>Notice that it includes previous commits b/c they have not been merged to the master branch!</p>
<p>Here's the test job (#77) which generated this PR:
<a href="https://travis-ci.org/atodorov/bdcs-api-rs/builds/219274916">https://travis-ci.org/atodorov/bdcs-api-rs/builds/219274916</a></p>
<p>Here's a test job (#87) which bails out miserably because the PR already exists:
<a href="https://travis-ci.org/atodorov/bdcs-api-rs/builds/220954269">https://travis-ci.org/atodorov/bdcs-api-rs/builds/220954269</a></p>
<p>This post is part of my <em>Quality Assurance According to Einstein</em> series - a detailed description
of useful techniques I will be presenting very soon.</p>
<p>Thanks for reading and happy testing!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Sat 15 April 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/04/15/automatic-cargo-update-pull-requests-for-rust-projects/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/04/14/testing-red-hat-enterprise-linux-the-microsoft-way/" rel="bookmark" title="Permalink to Testing Red Hat Enterprise Linux the Microsoft way">
                <h2 class="post-title">
                    Testing Red Hat Enterprise Linux the Microsoft way
                </h2>
            </a>
                <p><img alt="Microsoft and Red Hat logos" src="/images/microsoft-redhat-puzzle.jpg" title="Microsoft and Red Hat logos" /></p>
<p>Pairwise (a.k.a. all-pairs) testing is an effective test case generation
technique that is based on the observation that most faults are caused by
interactions of at most two factors! Pairwise-generated test suites cover
all combinations of two therefore are much smaller than exhaustive ones yet
still very effective in finding defects. This technique has been pioneered by
Microsoft in testing their products. For an example please see
<a href="https://github.com//microsoft/pict">their GitHub repo</a>!</p>
<p>I heard about pairwise testing by
<a href="https://www.linkedin.com/in/niels-sander-christensen-a2639b1/">Niels Sander Christensen</a>
last year at
<a href="http://qachallengeaccepted.com/2016.html#agenda2016">QA Challenge Accepted 2.0</a> and
I immediately knew where it would fit into my test matrix.</p>
<p>This article describes an experiment made during Red Hat Enterprise Linux 6.9
installation testing campaign. The experiment covers generating a
test plan (referred to Pairwise Test Plan) based on the pairwise test strategy and
some heuristics. The goal was to reduce the number of test cases which needed to be
executed and still maintain good test coverage (in terms of breadth of testing) and
also maintain low risk for the product.</p>
<h1>Product background</h1>
<p>For RHEL 6.9 there are 9 different product variants each comprising of particular
package set and CPU architecture:</p>
<ul>
<li>Server i386</li>
<li>Server x86_64</li>
<li>Server ppc64 (IBM Power)</li>
<li>Server s390x (IBM mainframe)</li>
<li>Workstation i386</li>
<li>Workstation x86_64</li>
<li>Client i386</li>
<li>Client x86_64</li>
<li>ComputeNode x86_64</li>
</ul>
<p>Traditional testing activities are classified as Tier #1, Tier #2 and Tier #3</p>
<ul>
<li>Tier #1 - basic form of installation testing. Executed for all arch/variants on all builds,
  including nightly builds. This group includes the most common installation methods and configurations.
  If Tier #1 fails the product is considered unfit for customers and further testing blocking the release!</li>
<li>Tier #2 and #3 - includes additional installation configurations and/or functionality which is deemed important.
  These are still fairly common scenarios but not the most frequently used ones.
  If some of the Tier#2 and #3 test cases fail they will not block the release.</li>
</ul>
<p>This experiment focuses only on Tier #2 and #3 test cases because they generate the
largest test matrix! This experiment is related only to installation testing of RHEL.
This broadly means <em>"Can the customer install RHEL via the Anaconda installer and boot
into the installed system"</em>.
I do not test functionality of the system after reboot!</p>
<p><strong>I have theorized that from the point of view of installation testing RHEL is mostly a
platform independent product!</strong></p>
<p>Individual product variants rarely exhibit differences in their functional behavior
because they are compiled from the same code base! If a feature is present it should work
the same on all variants. The main differences between variants are:</p>
<ul>
<li>What software has been packaged as part of the variant (e.g. base package set and add-on repos);</li>
<li>Whether or not a particular feature is officially supported, e.g. iBFT on Client variants.
  Support is usually provided via including the respective packages in the variant package set
  and declaring SLA for it.</li>
</ul>
<p>These differences may lead to problems with resolving dependencies and missing packages
but historically haven't shown significant tendency to cause functional failures
e.g. using NFS as installation source working on Server but not on Client.</p>
<p>The main component being tested, Anaconda - the installer, is also mostly platform independent.
In a previous experiment I had collected code coverage data from Anaconda while
performing installation with the same kickstart (or same manual options) on various architectures.
The coverage report supports the claim that Anaconda is platform independent!
See
<a href="http://atodorov.org/blog/2015/10/27/anaconda-coverage.py-coverage-diff/">Anaconda &amp; coverage.py - Pt.3 - coverage-diff, section Kickstart vs. Kickstart</a>!</p>
<h1>Testing approach</h1>
<p>The traditional pairwise approach focuses on features whose functionality is
controlled via parameters. For example: RAID level, encryption cipher, etc.
<strong>I have taken this definition one level up and applied it to the entire product!
Now functionality is also controlled by variant and CPU architecture!</strong>
This allows me to reduce the number of total test cases in the test matrix but still
execute all of them at least once!</p>
<p>The initial implementation used a simple script, built with
<a href="https://github.com/josephwilk/pairwise">the Ruby pairwise gem</a>, that:</p>
<ul>
<li>
<p>Copies verbatim all test cases which are applicable for a single product variant,
    for example s390x Server or ppc64 Server! There's nothing we can do to reduce these
    from combinatorial point of view!</p>
</li>
<li>
<p>Then we have the group of test cases with input parameters. For example:</p>
<div class="highlight"><pre>storage / iBFT / No authentication / Network init script
storage / iBFT / CHAP authentication / Network Manager
storage / iBFT / Reverse CHAP authentication / Network Manager
</pre></div>


<p>In this example the test is <code>storage / iBFT</code> and the parameters are</p>
<ul>
<li>Authentication type<ul>
<li>None</li>
<li>CHAP</li>
<li>Reverse CHAP</li>
</ul>
</li>
<li>Network management type<ul>
<li>SysV init</li>
<li>NetworkManager</li>
</ul>
</li>
</ul>
<p>For test cases in this group I also consider the CPU architecture and OS variant
as part of the input parameters and combine them using pairwise. Usually this results
in around 50% reduction of test efforts compared to testing against all product variants!</p>
</li>
<li>
<p>Last we have the group of test cases which don't depend on any input parameters,
    for example <code>partitioning / swap on LVM</code>. They are grouped together (wrt their applicable variants)
    and each test case is executed only once against a randomly chosen product variant!
    This is my own heuristic based on the fact that the product is platform
    independent!</p>
<p><strong>NOTE:</strong> You may think that for these test cases the product variant is their input parameter.
If we consider this to be the case then we'll not get any reduction because of
how pairwise generation works (the 2 parameters with the largest number of possible values determine
the maximum size of the test matrix). In this case the 9 product variants is the largest set of values!</p>
</li>
</ul>
<p>For this experiment
<a href="https://gist.github.com/atodorov/8f44022e209f749c7121f91281aa641e">pairwise_spec.rb</a>
only produced the list of test scenarios (test cases) to be executed! It doesn't
schedule test execution and it doesn't update the
<a href="http://atodorov.org/blog/2017/04/04/article-about-nitrate-in-methods-tools/">test case management system</a>
with actual results. It just tells you what to do! Obviously this script
will need to integrate with other systems and processes as defined by the organization!</p>
<p>Example results:</p>
<div class="highlight"><pre>RHEL 6.9 Tier #2 and #3 testing
  Test case w/o parameters can&#39;t be reduced via pairwise
    x86_64 Server - partitioning / swap on LVM
    x86_64 Workstation - partitioning / swap on LVM
    x86_64 Client - partitioning / swap on LVM
    x86_64 ComputeNode - partitioning / swap on LVM
    i386 Server - partitioning / swap on LVM
    i386 Workstation - partitioning / swap on LVM
    i386 Client - partitioning / swap on LVM
    ppc64 Server - partitioning / swap on LVM
    s390x Server - partitioning / swap on LVM
  Test case(s) with parameters can be reduced by pairwise
    x86_64 Server - rescue mode / LVM / plain
    x86_64 ComputeNode - rescue mode / RAID / encrypted
    x86_64 Client - rescue mode / RAID / plain
    x86_64 Workstation - rescue mode / LVM / encrypted
    x86_64 Server - rescue mode / RAID / encrypted
    x86_64 Workstation - rescue mode / RAID / plain
    x86_64 Client - rescue mode / LVM / encrypted
    x86_64 ComputeNode - rescue mode / LVM / plain
    i386 Server - rescue mode / LVM / plain
    i386 Client - rescue mode / RAID / encrypted
    i386 Workstation - rescue mode / RAID / plain
    i386 Workstation - rescue mode / LVM / encrypted
    i386 Server - rescue mode / RAID / encrypted
    i386 Workstation - rescue mode / RAID / encrypted
    i386 Client - rescue mode / LVM / plain
    ppc64 Server - rescue mode / LVM / plain
    s390x Server - rescue mode / RAID / encrypted
    s390x Server - rescue mode / RAID / plain
    s390x Server - rescue mode / LVM / encrypted
    ppc64 Server - rescue mode / RAID / encrypted

Finished in 0.00602 seconds (files took 0.10734 seconds to load)
29 examples, 0 failures
</pre></div>


<p>In this example there are 9 (variants) * 2 (partitioning type) * 2 (encryption type) == 32
total combinations! As you can see pairwise reduced them to 20! Also notice that
if you don't take CPU arch and variant into account you are left with
2 (partitioning type) * 2 (encryption type) == 4 combinations for each product variant
and they can't be reduced on their own!</p>
<h1>Acceptance criteria</h1>
<p>I did evaluate all bugs which were found by executing the test cases from the
pairwise test plan and compared them to the list of all bugs found by the team.
This will tell me how good my pairwise test plan was compared to the regular one.
"good" meaning:</p>
<ul>
<li>How many bugs would I find if I don't execute the full test matrix</li>
<li>How many critical bugs would I miss if I don't execute the full test matrix</li>
</ul>
<p>Results:</p>
<ul>
<li>Pairwise found <strong>14 new bugs</strong>;</li>
<li><strong>23 bugs were first found by regular test plan</strong><ul>
<li>some by test cases not included in this experiment;</li>
<li>pairwise totally <strong>missed 4 bugs</strong>!</li>
</ul>
</li>
</ul>
<p>Pairwise test plan <strong>missed 3 critical regressions</strong> due to:</p>
<ul>
<li>Poor planning of pairwise test activity. There was a regression in
  one of the latest builds and that particular test was simply not executed!</li>
<li>Human factor aka me not being careful enough and not following the process diligently.
  I waived a test due to infrastructure issues while there was a bug which stayed undiscovered!
  I should have tried harder to retest this scenario after fixing my infrastructure!</li>
<li>Architecture and networking specific regression which wasn't tested on multiple levels and
  is very narrow corner case.
  Can be mitigated with more testing upstream, more automation and better understanding of the hidden test
  requirements (e.g. IPv4 vs IPv6) for all of which pairwise can help (analysis and more available resources).</li>
</ul>
<p>All of the missed regressions could have been missed by regular test plan as well, however the risk of missing
them in pairwise is higher b/c of the reduced test matrix and the fact that
you may not execute exactly the same test scenario for quite a long time.
OTOH the risk can be mitigated with more automation b/c we now have more free resources.</p>
<p>IMO pairwise test plan did a good job and didn't introduce "dramatic" changes in risk level for the product!</p>
<h1>Summary</h1>
<ul>
<li>65 % reduction in test matrix;</li>
<li>Only 1/3rd of team engineers needed;<ul>
<li>keep arch experts around though;</li>
</ul>
</li>
<li>2/3rd of team engineers could be free for automation and to create even more test cases;</li>
<li>Test run execution completion rate is comparable to regular test plan<ul>
<li>average execution completion for pairwise test plan was 76%!</li>
<li>average execution completion for regular test plan was 85%!</li>
</ul>
</li>
<li>New bugs found:<ul>
<li>30% by Pairwise Test Plan</li>
<li>30% by Tier #1 test cases (good job here)</li>
<li>30% by exploratory testing</li>
</ul>
</li>
<li>Risk of missing regressions or critical bugs exists (I did miss 3) but can be mitigated;</li>
<li>Clearly exposes the need of constant review, analysis and improvement of existing test cases;</li>
<li>Exposes hidden parameters in test scenarios and some hidden relationships;</li>
<li>Patterns and other optimization techniques observed</li>
</ul>
<p>Patterns observed:</p>
<ul>
<li>Many new test case combinations found, which I had to describe into
  <a href="http://atodorov.org/blog/2017/04/04/article-about-nitrate-in-methods-tools/">Nitrate</a>; The longer you use
  pairwise the less new combinations are discovered (aka undocumented scenarios).
  The first 3 initial test runs discovered the most of the missing combinations!</li>
<li>Found quite a few test cases with hidden parameters, for example <code>swap / recommended</code>
  which calculates the recommended size of swap partition based on 4 different
  ranges in which the actual RAM size fits! These ranges became parameters
  to the test case;</li>
<li>Can combine (2, 3, etc) independent test cases together and consider them as parameters
  so we can apply pairwise against the combination. This will create new scenarios, broaden
  the test matrix but not result in significant increase in execution time. I didn't try this
  because it was not the focus of the experiment;</li>
<li>Found some redundant/duplicate test cases - test plans need to be constantly analyzed and
  maintained you know;</li>
<li>Automated scheduling and tools integration is critical. This needs to be working perfectly
  in order to capitalize on the newly freed resources;</li>
<li>Testing on s390x was sub-optimal (mostly my own inexperience with the platform) so for
  specialized environments we still want to keep the experts around;</li>
<li>1 engineer (me) was able to largely keep up with schedule with the rest of the team!<ul>
<li>experiment was conducted during the course of several months</li>
<li>I have tried to adhere to all milestones and deadlines and mostly succeeded</li>
</ul>
</li>
</ul>
<p>I have also discovered ideas for new test execution optimization techniques
which need to be evaluated and measured further:</p>
<ul>
<li>Use a common set-up step for multiple test cases across variants, e.g.<ul>
<li>install a RAID system then;</li>
<li>perform 3 rescue mode tests (same test case, different variants)</li>
</ul>
</li>
<li>Pipeline test cases so that the result of one case is the setup for the next, e.g.<ul>
<li>install a RAID system and test for correctness of the installation;</li>
<li>perform rescue mode test;</li>
<li>damage one of the RAID partitions while still in rescue mode;</li>
<li>test installation with damaged disks - it should not crash!</li>
</ul>
</li>
</ul>
<p>These techniques can be used stand-alone or in combination with
other optimization techniques and tooling available to the team. They are
specific to my particular kind of testing so beware of your surroundings
before you try them out!</p>
<p>Thanks for reading and happy testing!</p>
<p><em>Cover image copyright: cio-today.com</em></p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Fri 14 April 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/04/14/testing-red-hat-enterprise-linux-the-microsoft-way/#disqus_thread">comments</a>.</p>        </div>
        <div class="post-preview">
            <a href="http://atodorov.org/blog/2017/04/05/mutation-testing-vs-coverage-pt-2/" rel="bookmark" title="Permalink to Mutation Testing vs. Coverage, Pt. 2">
                <h2 class="post-title">
                    Mutation Testing vs. Coverage, Pt. 2
                </h2>
            </a>
                <p>In a <a href="http://atodorov.org/blog/2016/12/27/mutation-testing-vs-coverage/">previous post</a> I
have shown an example of real world bugs which we were not able to detect
despite having 100% mutation and test coverage. I am going to show you another
example here.</p>
<p>This example comes from one of my training courses. The task is to write a
class which represents a bank account with methods to deposit, withdraw and
transfer money. The solution looks like this</p>
<div class="highlight"><span class="filename">bank.py</span><pre><span class="k">class</span> <span class="nc">BankAccount</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">balance</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_balance</span> <span class="o">=</span> <span class="n">balance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">deposit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">amount</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Deposit amount must be positive!&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_balance</span> <span class="o">+=</span> <span class="n">amount</span>

    <span class="k">def</span> <span class="nf">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">amount</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Withdraw amount must be positive!&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">amount</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_balance</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_balance</span> <span class="o">-=</span> <span class="n">amount</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;Withdraw for </span><span class="si">%d</span><span class="s"> failed&quot;</span> <span class="o">%</span> <span class="n">amount</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">transfer_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_account</span><span class="p">,</span> <span class="n">how_much</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="n">how_much</span><span class="p">)</span>
        <span class="n">other_account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="n">how_much</span><span class="p">)</span>
</pre></div>


<p>Notice that if withdrawal is not possible then the function returns <code>False</code>. The tests
look like this</p>
<div class="highlight"><span class="filename">test.py</span><pre><span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">from</span> <span class="nn">solution</span> <span class="kn">import</span> <span class="n">BankAccount</span>


<span class="k">class</span> <span class="nc">TestBankAccount</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">account</span> <span class="o">=</span> <span class="n">BankAccount</span><span class="p">(</span><span class="s">&quot;Rado&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_deposit_positive_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">_balance</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_deposit_negative_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_deposit_zero_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_withdraw_positive_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">_balance</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_withdraw_maximum_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">_balance</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_withdraw_from_empty_account</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNotNone</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">assert</span> <span class="s">&quot;Withdraw for 50 failed&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">_history</span>

    <span class="k">def</span> <span class="nf">test_withdraw_non_positive_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_transfer_negative_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">account_1</span> <span class="o">=</span> <span class="n">BankAccount</span><span class="p">(</span><span class="s">&#39;For testing&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">account_2</span> <span class="o">=</span> <span class="n">BankAccount</span><span class="p">(</span><span class="s">&#39;In dollars&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
            <span class="n">account_1</span><span class="o">.</span><span class="n">transfer_to</span><span class="p">(</span><span class="n">account_2</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">account_1</span><span class="o">.</span><span class="n">_balance</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">account_2</span><span class="o">.</span><span class="n">_balance</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">test_transfer_positive_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">account_1</span> <span class="o">=</span> <span class="n">BankAccount</span><span class="p">(</span><span class="s">&#39;For testing&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">account_2</span> <span class="o">=</span> <span class="n">BankAccount</span><span class="p">(</span><span class="s">&#39;In dollars&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

        <span class="n">account_1</span><span class="o">.</span><span class="n">transfer_to</span><span class="p">(</span><span class="n">account_2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">account_1</span><span class="o">.</span><span class="n">_balance</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">account_2</span><span class="o">.</span><span class="n">_balance</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>


<p>Try the following commands to verify that you have 100% coverage</p>
<div class="highlight"><pre>coverage run test.py
coverage report

cosmic-ray run --test-runner nose --baseline 10 example.json bank.py -- test.py`
cosmic-ray report example.json
</pre></div>


<p>Can you tell where the bug is ? How about I try to transfer more money than is
available from one account to the other</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">test_transfer_more_than_available_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">account_1</span> <span class="o">=</span> <span class="n">BankAccount</span><span class="p">(</span><span class="s">&#39;For testing&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">account_2</span> <span class="o">=</span> <span class="n">BankAccount</span><span class="p">(</span><span class="s">&#39;In dollars&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="c"># transfer more than available</span>
    <span class="n">account_1</span><span class="o">.</span><span class="n">transfer_to</span><span class="p">(</span><span class="n">account_2</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">account_1</span><span class="o">.</span><span class="n">_balance</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">account_2</span><span class="o">.</span><span class="n">_balance</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>


<p>If you execute the above test it will fail</p>
<div class="highlight"><pre><span class="n">FAIL</span><span class="o">:</span> <span class="n">test_transfer_more_than_available_balance</span> <span class="o">(</span><span class="n">__main__</span><span class="o">.</span><span class="na">TestBankAccount</span><span class="o">)</span>
<span class="o">----------------------------------------------------------------------</span>
<span class="n">Traceback</span> <span class="o">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="o">):</span>
  <span class="n">File</span> <span class="s2">&quot;./test.py&quot;</span><span class="o">,</span> <span class="n">line</span> <span class="mi">79</span><span class="o">,</span> <span class="k">in</span> <span class="n">test_transfer_more_than_available_balance</span>
    <span class="n">self</span><span class="o">.</span><span class="na">assertEqual</span><span class="o">(</span><span class="n">account_2</span><span class="o">.</span><span class="na">_balance</span><span class="o">,</span> <span class="mi">10</span><span class="o">)</span>
<span class="n">AssertionError</span><span class="o">:</span> <span class="mi">160</span> <span class="o">!=</span> <span class="mi">10</span>

<span class="o">----------------------------------------------------------------------</span>
</pre></div>


<p>The problem is that when <code>self.withdraw(how_much)</code> fails <code>transfer_to()</code> ignores
the result and tries to deposit the money into the other account! A better
implementation would be</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">transfer_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_account</span><span class="p">,</span> <span class="n">how_much</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="n">how_much</span><span class="p">):</span>
        <span class="n">other_account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="n">how_much</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;Transfer failed!&#39;</span><span class="p">)</span>
</pre></div>


<p>In my earlier article the bugs were caused by external environment
and tools/metrics like code coverage and mutation score are not affected by it.
In fact the jinja-ab example falls into the category of data coverage testing.</p>
<p>The current example on the other hand is ignoring the return value of the <code>withdraw()</code>
function and that's why it fails when we add the appropriate test.</p>
<p><strong>NOTE:</strong> some mutation test tools support the <em>removing/modifying return value</em>
mutation. Cosmic Ray doesn't support this at the moment (I should add it). Even if it did
that would not help us find the bug because we would kill the mutation using
the <code>test_withdraw...()</code> test methods, which already assert on the return value!</p>
<p>Thanks for reading and happy testing!</p>
            <p class="post-meta">Posted by
                    <a href="http://atodorov.org/author/alexander-todorov.html">Alexander Todorov</a>
                 on Wed 05 April 2017
            </p>
<p>There are <a href="http://atodorov.org/blog/2017/04/05/mutation-testing-vs-coverage-pt-2/#disqus_thread">comments</a>.</p>        </div>

    <hr>
    <!-- Pager -->
    <ul class="pager">
        <li class="next">
                <a href="http://atodorov.org/category/_posts2.html">Older Posts &rarr;</a>
        </li>
    </ul>
    Page 1 / 15
    <hr>
            </div>
        </div>
    </div>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                            <li>
                                <a href="https://twitter.com/atodorov_">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/atodorov">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://bg.linkedin.com/in/alextodorov">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="http://feeds.feedburner.com/atodorov">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://www.youtube.com/playlist?list=PLFjlI7p-h1hxBP3cIjEqePSeoBDHud5Db">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-youtube fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="http://amzn.to/1ivu2q4">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-amazon fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="http://mrsenko.com/?utm_source=atodorov.org&utm_medium=blog&utm_campaign=social_icon">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-user-secret fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                    </ul>
<section>
    <p>
        I am a Senior QA contractor at Red Hat responsible for finding over
        <a href="/blog/2014/02/19/7-years-1400-bugs-red-hat-qa/">1600 bugs</a>,
        Red Hat Certified professional, cloud hacker and a general purpose
        open source developer! I am the maintainer of
        <a href="http://kiwitcms.org/?utm_source=atodorov.org&utm_medium=blog&utm_campaign=footer">Kiwi TCMS</a>!
    </p>
    <p>
        I am living in the <a href="http://planet.sofiavalley.com">Sofia Valley</a>
        which is emerging as a busy place for start-up founders and tech enthusiasts
        in Eastern Europe! You can find more about me <a href="/blog/2013/01/25/about-me/">here</a>.
    </p>
    <p>
        <small>
            <em>
                Some of the links contained within this site have my referral id (e.g.,
                <a target="_blank" href="http://www.amazon.com/ref=as_li_ss_tl?_encoding=UTF8&camp=1789&creative=390957&linkCode=ur2&tag=atodorovorg-20&linkId=L6Q34XAXQS5RDMOY">Amazon</a><img src="https://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=ur2&o=1" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />),
                which provides me with a small commission for each sale. Thank you for your support.
            </em>
        </small>
    </p>
</section>

<form action="http://google.com/search" method="get" style="width:300px;margin:0 auto;">
    <fieldset role="search">
        <input type="hidden" name="sitesearch" value="http://atodorov.org" />
        <input class="search" type="text" name="q" placeholder="Search" style="width:100%"/>
    </fieldset>
</form>

<p class="copyright text-muted">
    <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">CC-BY-SA</a> &amp;
    <a rel="license" href="http://opensource.org/licenses/MIT">MIT</a>
    2011-2016 &diams; Alexander Todorov &diams;
    <a href="http://planet.sofiavalley.com">SofiaValley Blog</a>
</p>

<script type='text/javascript'>
window.__lo_site_id = 55936;
    (function() {
        var wa = document.createElement('script'); wa.type = 'text/javascript'; wa.async = true;
        wa.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://cdn') + '.luckyorange.com/w.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(wa, s);
      })();
</script>
                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="http://atodorov.org/theme/js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="http://atodorov.org/theme/js/bootstrap.min.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37979549-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'atodorov';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>

</html>