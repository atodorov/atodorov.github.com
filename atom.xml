<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[atodorov.org - you can logoff, but you can never leave]]></title>
  <link href="http://atodorov.org/atom.xml" rel="self"/>
  <link href="http://atodorov.org/"/>
  <updated>2015-09-25T11:53:16+03:00</updated>
  <id>http://atodorov.org/</id>
  <author>
    <name><![CDATA[Alexander Todorov]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Unit Testing Example - Bad Stub Design in DNF]]></title>
    <link href="http://atodorov.org/blog/2015/09/25/unit-testing-bad-stub-design-in-dnf/"/>
    <updated>2015-09-25T11:20:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/09/25/unit-testing-bad-stub-design-in-dnf</id>
    <content type="html"><![CDATA[<p>In software testing, usually unit testing, test stubs are programs that simulate
the behaviors of external dependencies that a module undergoing the test depends
on. Test stubs provide canned answers to calls made during the test.</p>

<p>I&#8217;ve discovered an improperly written stub method in one of
<a href="http://dnf.baseurl.org/">DNF</a>&#8217;s tests:</p>

<figure class='code'><figcaption><span>tests/test_download.py </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">class</span> <span class="nc">DownloadCommandTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class='line'>        <span class="k">def</span> <span class="nf">stub_fn</span><span class="p">(</span><span class="n">pkg_spec</span><span class="p">):</span>
</span><span class='line'>            <span class="k">if</span> <span class="s">&#39;.src.rpm&#39;</span> <span class="ow">in</span> <span class="n">pkg_spec</span><span class="p">:</span>
</span><span class='line'>                <span class="k">return</span> <span class="n">Query</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">sourcerpm</span><span class="o">=</span><span class="n">pkg_spec</span><span class="p">)</span>
</span><span class='line'>            <span class="k">else</span><span class="p">:</span>
</span><span class='line'>                <span class="n">q</span> <span class="o">=</span> <span class="n">Query</span><span class="o">.</span><span class="n">latest</span><span class="p">()</span>
</span><span class='line'>                <span class="k">return</span> <span class="p">[</span><span class="n">pkg</span> <span class="k">for</span> <span class="n">pkg</span> <span class="ow">in</span> <span class="n">q</span> <span class="k">if</span> <span class="n">pkg_spec</span> <span class="o">==</span> <span class="n">pkg</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">cli</span> <span class="o">=</span> <span class="n">mock</span><span class="o">.</span><span class="n">MagicMock</span><span class="p">()</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">cmd</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">DownloadCommand</span><span class="p">(</span><span class="n">cli</span><span class="p">)</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">cli</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">repos</span> <span class="o">=</span> <span class="n">dnf</span><span class="o">.</span><span class="n">repodict</span><span class="o">.</span><span class="n">RepoDict</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">_get_query</span> <span class="o">=</span> <span class="n">stub_fn</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">_get_query_source</span> <span class="o">=</span> <span class="n">stub_fn</span>
</span></code></pre></td></tr></table></div></figure>


<p>The replaced methods look like this:</p>

<figure class='code'><figcaption><span>plugins/download.py </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'>    <span class="k">def</span> <span class="nf">_get_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pkg_spec</span><span class="p">):</span>
</span><span class='line'>        <span class="sd">&quot;&quot;&quot;Return a query to match a pkg_spec.&quot;&quot;&quot;</span>
</span><span class='line'>        <span class="n">subj</span> <span class="o">=</span> <span class="n">dnf</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">Subject</span><span class="p">(</span><span class="n">pkg_spec</span><span class="p">)</span>
</span><span class='line'>        <span class="n">q</span> <span class="o">=</span> <span class="n">subj</span><span class="o">.</span><span class="n">get_best_query</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">sack</span><span class="p">)</span>
</span><span class='line'>        <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">available</span><span class="p">()</span>
</span><span class='line'>        <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">latest</span><span class="p">()</span>
</span><span class='line'>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">run</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span class='line'>            <span class="n">msg</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;No package &quot;</span> <span class="o">+</span> <span class="n">pkg_spec</span> <span class="o">+</span> <span class="s">&quot; available.&quot;</span><span class="p">)</span>
</span><span class='line'>            <span class="k">raise</span> <span class="n">dnf</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">PackageNotFoundError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">q</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">_get_query_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pkg_spec</span><span class="p">):</span>
</span><span class='line'>        <span class="sd">&quot;&quot;&quot;&quot;Return a query to match a source rpm file name.&quot;&quot;&quot;</span>
</span><span class='line'>        <span class="n">pkg_spec</span> <span class="o">=</span> <span class="n">pkg_spec</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>  <span class="c"># skip the .rpm</span>
</span><span class='line'>        <span class="n">nevra</span> <span class="o">=</span> <span class="n">hawkey</span><span class="o">.</span><span class="n">split_nevra</span><span class="p">(</span><span class="n">pkg_spec</span><span class="p">)</span>
</span><span class='line'>        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">sack</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>
</span><span class='line'>        <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">available</span><span class="p">()</span>
</span><span class='line'>        <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">latest</span><span class="p">()</span>
</span><span class='line'>        <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">nevra</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">nevra</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
</span><span class='line'>                     <span class="n">release</span><span class="o">=</span><span class="n">nevra</span><span class="o">.</span><span class="n">release</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="n">nevra</span><span class="o">.</span><span class="n">arch</span><span class="p">)</span>
</span><span class='line'>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">run</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span class='line'>            <span class="n">msg</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;No package &quot;</span> <span class="o">+</span> <span class="n">pkg_spec</span> <span class="o">+</span> <span class="s">&quot; available.&quot;</span><span class="p">)</span>
</span><span class='line'>            <span class="k">raise</span> <span class="n">dnf</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">PackageNotFoundError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">q</span>
</span></code></pre></td></tr></table></div></figure>


<p>As seen here <em>stub_fn</em> replaces the <em>_get_query</em> methods from the class under
test. At the time of writing this has probably seemed like a good idea to
speed up writing the tests.</p>

<p>The trouble is we should be replacing the external dependencies of <em>_get_query</em>
(other parts of DNF essentially) and not methods from <em>DownloadCommand</em>. To
understand why this is a bad idea check
<a href="https://github.com/rpm-software-management/dnf-plugins-core/pull/113">PR #113</a>,
which directly modifies <em>_get_query</em>. There&#8217;s no way to test this patch
with the current state of the test.</p>

<p>So I took a few days to experiment and update the current test stubs. The
result is
<a href="https://github.com/rpm-software-management/dnf-plugins-core/pull/118">PR #118</a>.
The important bits are the <em>SackStub</em> and <em>SubjectStub</em> classes which hold
information about the available RPM packages on the system. The rest are cosmetics
to fit around the way the query objects are used (q.available(), q.latest(), q.filter()).
The proposed design correctly overrides the external dependencies on
<em>dnf.subject.Subject</em> and <em>self.base.sack</em> which are initialized before our
plugin is loaded by DNF.</p>

<p>I must say this is the first error of this kind I&#8217;ve seen in my QA practice so far.
I have no idea if this was a minor oversight or something which happens more frequently
in open source projects but it&#8217;s a great example nevertheless.</p>

<p>For those of you who&#8217;d like to get started on unit testing I can recommend the book
<a href="http://www.amazon.com/gp/product/1933988274/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=1933988274&linkCode=as2&tag=atodorovorg-20">The Art of Unit Testing: With Examples in .Net</a><img src="http://www.assoc-amazon.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=1933988274" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
by Roy Osherove!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[4000+ bugs in Fedora - checksec failures]]></title>
    <link href="http://atodorov.org/blog/2015/09/16/4000-bugs-in-fedora-checksec-failures/"/>
    <updated>2015-09-16T17:03:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/09/16/4000-bugs-in-fedora-checksec-failures</id>
    <content type="html"><![CDATA[<p>In the last week I&#8217;ve been trying to figure out how many packages
conform to the new
<a href="https://fedoraproject.org/wiki/Changes/Harden_All_Packages">Harden All Packages</a>
policy in Fedora!</p>

<p>From 46884 RPMs, 17385 are &#8216;x86_64&#8217; meaning they may contain ELF objects.
From them 4489 are reported as failed <code>checksec</code>.</p>

<p>What you should see as the output from <code>checksec is</code></p>

<pre><code>Full RELRO      Canary found      NX enabled    PIE enabled     No RPATH   No RUNPATH
Full RELRO      Canary found      NX enabled    DSO             No RPATH   No RUNPATH
</code></pre>

<p>The first line is for binaries, the second one for libraries b/c
DSOs on x86_64 are always position-independent. Some RPATHs are acceptable,
e.g. <code>%{_libdir}/foo/</code> and I&#8217;ve tried to exclude them unless
other offenses are found. The script which does this is
<a href="https://github.com/atodorov/fedora-scripts/blob/master/checksec-collect">checksec-collect</a>.</p>

<p>Most often I&#8217;m seeing <em>Partial RELRO</em>, <em>No canary found</em> and <em>No PIE</em> errors.
Since all packages potentially process untrusted input, it makes sense for all of them
to be hardened and enhance the security of Fedora. That&#8217;s why all of these errors
should be considered valid bugs.</p>

<h2>Attn package maintainers</h2>

<p>Please see if your package is in the list and try to fix it or let me know
why it should be excluded, for example it&#8217;s a boot loader and doesn&#8217;t function
properly with hardening enabled. The full list is available at
<a href="https://github.com/atodorov/fedora-scripts/blob/master/checksec.log">GitHub</a>.</p>

<p>For more information about the different protection mechanisms see the following
links:</p>

<ul>
<li><a href="http://tk-blog.blogspot.bg/2009/02/relro-not-so-well-known-memory.html">Partial vs Full RELRO</a></li>
<li><a href="https://en.wikipedia.org/wiki/Buffer_overflow_protection#Canaries">Stack canaries</a></li>
<li><a href="https://en.wikipedia.org/wiki/NX_bit#Linux">NX memory protection</a></li>
<li><a href="https://securityblog.redhat.com/2012/11/28/position-independent-executables-pie/">Position Independent Executables</a></li>
<li><a href="https://fedoraproject.org/wiki/Packaging:Guidelines#Beware_of_Rpath">RPATH</a></li>
<li><a href="http://blog.tremily.us/posts/rpath/">RUNPATH</a></li>
</ul>


<p><strong>UPDATE 2015-09-17</strong></p>

<p>I&#8217;ve posted my findings on
<a href="https://lists.fedoraproject.org/pipermail/devel/2015-September/thread.html">fedora-devel</a>
and the comments are more than interesting even revealing an old bug in libtool.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Minor Typo Bug in Messenger for bg_BG.UTF-8]]></title>
    <link href="http://atodorov.org/blog/2015/08/20/minor-typo-bug-in-messenger/"/>
    <updated>2015-08-20T16:34:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/08/20/minor-typo-bug-in-messenger</id>
    <content type="html"><![CDATA[<p><img src="http://atodorov.org/images/messenger_typo.png" title="Messenger typo" alt="Messenger typo" /></p>

<p>There&#8217;s a typo in the Bulgarian translation of Messenger.com.
It is highlighted by the red dot on the picture.</p>

<p><em>hunspell</em> easily catches it so either Facebook doesn&#8217;t run their
translations through a spell checker or their spell checker is
borked.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Pedometer Bug in Samsung S Health]]></title>
    <link href="http://atodorov.org/blog/2015/08/17/pedometer-bug-in-samsung-s-health/"/>
    <updated>2015-08-17T16:43:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/08/17/pedometer-bug-in-samsung-s-health</id>
    <content type="html"><![CDATA[<p>Do you remember the
<a href="http://atodorov.org/blog/2015/01/09/pedometer-bug-in-samsung-gear-fit-smartwatch/">pedometer bug in Samsung Gear Fit</a>
I&#8217;ve discovered earlier ? It turns out that Samsung is a fan of this one
and has the exact same bug in their <em>S Health</em> application.</p>

<p>The application doesn&#8217;t block pedometer(e.g. steps counting) while
performing other activities such as cycling for example. So in reallity it
reports incorrect value for burned callories. At this time I call it
bad software development practice/architecture on Samsung&#8217;s part which leads
to this bug being present.</p>

<p>Btw for more interesting bugs see
<a href="http://gearfitbugs.tumblr.com/">Samsung Gear Fit Bug-of-the-Day</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Tip: Try F10 When Editing grub2 Menu in EFI Mode]]></title>
    <link href="http://atodorov.org/blog/2015/08/14/tip-try-f10-when-editing-grub2-menu-in-efi-mode/"/>
    <updated>2015-08-14T14:06:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/08/14/tip-try-f10-when-editing-grub2-menu-in-efi-mode</id>
    <content type="html"><![CDATA[<p>When editing the grub2 menu (especially in EFI mode) it tells you to
press Ctrl-x to save your changes and continue the boot process.
However this doesn&#8217;t work on Apple hardware
(<a href="https://bugzilla.redhat.com/show_bug.cgi?id=1253637">rhbz#1253637</a>)
and maybe some other platforms. If this is the case try pressing <strong>F10</strong>
instead. It works for me!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Call for Ideas: Graphical Test Coverage Reports]]></title>
    <link href="http://atodorov.org/blog/2015/07/27/call-for-ideas-graphical-test-coverage-reports/"/>
    <updated>2015-07-27T13:04:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/07/27/call-for-ideas-graphical-test-coverage-reports</id>
    <content type="html"><![CDATA[<p>If you are working with Python and writing unit tests chances are you are
familiar with the <a href="http://nedbatchelder.com/code/coverage/">coverage</a> reporting
tool. However there are testing scenarios in which we either don&#8217;t use unit tests
or maybe execute different code paths(test cases) independent of each other.</p>

<p>For example, this is the case with installation testing in Fedora. Because anaconda
- the installer is very complex the easiest way is to test it live, not with unit tests.
Even though we can get a coverage report (anaconda is written in Python) it reflects
only the test case it was collected from.</p>

<p><code>coverage combine</code> can be used to combine several data files and produce an aggregate
report. This can tell you how much test coverage you have across all your tests.</p>

<p>As far as I can tell Python&#8217;s coverage doesn&#8217;t tell you how many times a particular
line of code has been executed. It also doesn&#8217;t tell you which test cases executed
a particular line
(see <a href="https://bitbucket.org/ned/coveragepy/pull-request/59">PR #59</a>).
In the Fedora example, I have the feeling many of our tests are touching the same
code base and not contributing that much to the overall test coverage.
So I started working on these items.</p>

<p>I imagine a script which will read coverage data from several test executions
(preferably in JSON format,
<a href="https://bitbucket.org/ned/coveragepy/pull-request/60">PR #60</a>) and produce a
graphical report similar to what GitHub does for your commit activity.</p>

<p>See an example <a href="https://s3.amazonaws.com/atodorov/blog/pykickstart_report.html">here</a>!</p>

<p>The example uses darker colors to indicate more line executions, lighter for less
executions. Check the HTML for the actual numbers b/c there are no hints yet.
The input JSON files are
<a href="https://s3.amazonaws.com/atodorov/blog/coverage_json_reports.tar.gz">here</a> and
the script to generate the above HTML is at
<a href="https://github.com/atodorov/fedora-scripts/blob/master/coverage-tool">GitHub</a>.</p>

<p>Now I need your ideas and comments!</p>

<p>What kinds of coverage reports are you using in your job ? How do you generate them ?
How do they look like ?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Open Data Event Coming to Sofia]]></title>
    <link href="http://atodorov.org/blog/2015/07/01/open-data-event-coming-to-sofia/"/>
    <updated>2015-07-01T11:58:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/07/01/open-data-event-coming-to-sofia</id>
    <content type="html"><![CDATA[<p><a href="https://www.eventbrite.co.uk/e/17565601186">Open Data and Intelligent Government</a>
is the name of upcoming event organized by <a href="http://sofiatech.bg/en/">Sofia Tech Park</a>
on July 14th.</p>

<p>The (preliminary) topics for this event are:</p>

<ul>
<li>Government vision for opening data;</li>
<li>Presentation of national platform for open data;</li>
<li>Legal aspects of open data;</li>
<li>Presentation of <a href="http://opendata.government.bg/">Bulgarian open data portal</a>;</li>
<li>Europe and open data;</li>
<li>Open, coordinated e-government for citizens and business;</li>
<li>What has already been done by municipalities in Bulgaria;</li>
<li>Strategy of Sofia municipality for open data;</li>
<li>Upcoming open data programming contest organized by Sofia municipality.</li>
</ul>


<p>I will also be participating in this event by covering two topics I&#8217;m close to:</p>

<ul>
<li>Entrepreneurship and open data - sharing my limited experience with Difio
and processing open data;</li>
<li>Technical tips for successful open data hackathon - sharing my observations as
a mentor at <a href="http://hackfmi.com">HackFMI</a> and giving some recommendations which will
help the alleged open data contest make a difference not being just another dull event
organized by governmental agencies.</li>
</ul>


<p>So far other confirmed speakers are Rado from <a href="http://hackbulgaria.com">HackBulgaria</a>/
<a href="http://hackfmi.com">HackFMI</a> and <a href="https://www.obshtestvo.bg/">Obshtestvo.bg</a> which are
working in the field of open government and open data.</p>

<p>I&#8217;m also in touch with the event organizers and helping a little bit with the program.
If you&#8217;re interested in speaking please get in touch with me ASAP.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[DEVit Conf 2015 Impressions]]></title>
    <link href="http://atodorov.org/blog/2015/05/22/devit-conf-2015-impressions/"/>
    <updated>2015-05-22T12:01:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/05/22/devit-conf-2015-impressions</id>
    <content type="html"><![CDATA[<p>It&#8217;s been a busy week after <a href="http://devitconf.org/">DEVit conf</a> took place in
Thessaloniki. Here are my impressions.</p>

<p><img src="http://atodorov.org/images/devit2015.jpg" title="Crack, Train, Fix, Release" alt="Crack, Train, Fix, Release" /></p>

<h2>Sessions</h2>

<p>I&#8217;ve started the day with the session called &#8220;Crack, Train, Fix, Release&#8221; by
Chris Heilmann. While it was very interesting for some unknown reason I
was expecting a talk more closely related to software testing. Unfortunately at the
same time in the other room was a talk called &#8220;Integration Testing from the Trenches&#8221;
by Nicolas Frankel which I missed.</p>

<p>At the end Chris answered the question &#8220;What to do about old versions of IE ?&#8221;.
And the answer pretty much was &#8220;Don&#8217;t try to support everything, leave them with
basic functionality so that users can achieve what they came for on your website.
Don&#8217;t put nice buttons b/c IE 6 users are not used to nice things and they get confused.&#8221;</p>

<p>If you remember I had a similar question to Jeremy Keith at
<a href="http://atodorov.org/blog/2015/04/20/videos-from-bulgaria-web-summit-2015/">Bulgaria Web Summit</a> last month
and the answer was similar:</p>

<blockquote><p>Q: Which one is Jeremy&#8217;s favorite device/browser to develop for. <br/>A: Your approach is wrong and instead we should be thinking in terms of what features are <br/>essential or non-essential for our websites and develop around features<br/>(if supported, if not supported) not around browsers!</p></blockquote>


<p>Btw I did ask Chris if he knows Jeremy and he does.</p>

<p>After the coffee break there was &#8220;JavaScript ♥ Unicode&#8221; by Mathias Bynens which
I saw last year at <a href="http://how.camp/">How Camp</a> in Veliko Tarnovo so I just stopped by
to say hi and went to listen to
&#8220;The future of responsive web design: web component queries&#8221; by Nikos Zinas.
As far as I understood Nikos is a local rock-star developer. I&#8217;m not much into web
development but the opportunity to create your own HTML components (tags) looks
very promising. I guess there will be more business coming for
<a href="http://telerik.com">Telerik</a> :).</p>

<p>I wanted to listen to &#8220;Live Productive Coder&#8221; by Heinz Kabutz but that one started
in Greek so I switched the room for
&#8220;iOS real time content modifications using websockets&#8221; by  Benny Weingarten-Gabbay.</p>

<p>After lunch I went straight for
&#8220;Introduction to Docker: What is it and why should I care?&#8221; by Ian Miell
which IMO was the most interesting talk of the day. It wasn&#8217;t very technical but
managed to clear some of the mysticism around Docker and what it actually is.
I tried to grab a few minutes of Ian&#8217;s time and we found topics of common interest
to talk about (<a href="http://www.projectatomic.io/">Project Atomic</a> anyone?) but later
failed to find him and continue the talk. I guess I&#8217;ll have to follow online.</p>

<p>Tim Perry with &#8220;Your Web Stack Would Betray You In An Instant&#8221; made a great show.
The room was packed, I myself was actually standing the whole time. He described a series
of failures across the entire web development stack which gave developers hard times
patching and upgrading their services. The lesson: everything fails, be prepared!</p>

<p>The last talk I visited was &#8220;GitHub Automation&#8221; by Forbes Lindesay. It was more of an
inspirational talk, rather than technical one. GitHub provides cool API so why not use it?</p>

<h2>Organization</h2>

<p><img src="http://atodorov.org/images/devit2015team.jpg" title="DEVit team" alt="DEVit team" /></p>

<p>From what I know this is the first year of DEVit. For a first timer the team did great!
I particularly liked the two coffee breaks before lunch and in the early afternoon and the
sponsors pitches in between the main talks.</p>

<p>All talks were recorded but I have no idea what&#8217;s happening with the videos!</p>

<p>I will definitely make a point of visiting Thessaloniki more often and follow the local
IT and start-up scenes there. And tonight is Silicon Drinkabout which will be the official
after party of <a href="http://digitalk.bg/">DigitalK</a> in Sofia.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Bug in VMware Open House Website]]></title>
    <link href="http://atodorov.org/blog/2015/05/21/bug-in-vmware-open-house-website/"/>
    <updated>2015-05-21T14:55:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/05/21/bug-in-vmware-open-house-website</id>
    <content type="html"><![CDATA[<p><img src="http://atodorov.org/images/vmware_bug.png" title="Bug in VMware Open House website" alt="&quot;Open House website bug&quot;" /></p>

<p>This is a slightly annoying UI bug in
<a href="http://www.openhouse.vmware-bulgaria.com/">VMware&#8217;s Open House</a> website. I&#8217;ve reported
it and hopefully they will fix it.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Free Software Testing Books]]></title>
    <link href="http://atodorov.org/blog/2015/05/20/free-software-testing-books/"/>
    <updated>2015-05-20T11:35:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/05/20/free-software-testing-books</id>
    <content type="html"><![CDATA[<p>There&#8217;s a huge list of
<a href="https://github.com/ligurio/free-software-testing-books/blob/master/free-software-testing-books.md">free books</a>
on the topic of software testing. This will definitely be my summer reading list.
I hope you find it helpful.</p>

<h2>200 Graduation Theses About Software Testing</h2>

<p>The guys from <a href="http://qahelp.net">QAHelp</a> have compiled a list of 200
graduation theses from various universities which are freely accessible
online. The list can be found
<a href="http://qahelp.net/200-dissertatsij-po-testirovaniyu-v-svobodnoj-dostupe/">here</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Why does sysctl not write under /sys]]></title>
    <link href="http://atodorov.org/blog/2015/05/13/why-does-sysctl-not-write-under-slash-sys/"/>
    <updated>2015-05-13T12:34:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/05/13/why-does-sysctl-not-write-under-slash-sys</id>
    <content type="html"><![CDATA[<p>Recently I&#8217;ve been looking into
<a href="http://atodorov.org/blog/2015/04/30/fixing-tilde-and-function-keys-mapping-for-macbook-air-on-linux/">fixing tilde and Fn keys mapping for MacBook Air</a>
and thought I could use <code>sysctl</code> to permanently set the desired values. Unfortunately this is not
possible. <code>sysctl</code> can only write under <code>/proc/sys</code> and this is
<a href="https://gitlab.com/procps-ng/procps/blob/master/sysctl.c#L54">hard-coded in the source</a>:</p>

<pre><code>static const char PROC_PATH[] = "/proc/sys/";
</code></pre>

<p>IMO this is relatively easy to patch and allow sysctl to read/write values under /sys.
The only open question I see is backward compatibility - maybe adding new parameter (e.g. &#8211;sysfs)
or adding extended sytax e.g. if variable name starts with / then treat it as absolute path.</p>

<p>I&#8217;ve asked sysctl maintainers on the
<a href="http://www.freelists.org/post/procps/Can-we-make-sysctl-readwrite-sys-values-along-with-procsys">procps mailing list</a>
but so far got no answer.</p>

<p>Is anyone else interested in this? How do you set parameter values under /sys then ?</p>

<p><strong>NOTE:</strong> for my particular purposes I could have used config files under
<em>/etc/modprobe.d/</em> or a startup script (I used that) instead.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Using USB to VGA Adapter on MacBook Air with Linux]]></title>
    <link href="http://atodorov.org/blog/2015/05/05/using-usb-to-vga-adapter-on-macbook-air-with-linux/"/>
    <updated>2015-05-05T14:02:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/05/05/using-usb-to-vga-adapter-on-macbook-air-with-linux</id>
    <content type="html"><![CDATA[<p>A quick solution for MacBook Air users running Linux who want to
use external projector is to use a USB to VGA adapter. Mine is
<a href="http://www.amazon.com/gp/product/B004AIJE9G/ref=as_li_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=B004AIJE9G&linkCode=as2&tag=atodorovorg-20&linkId=74W7KWXBGC7SZ5QH">Plugable UGA-165</a><img src="http://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=B004AIJE9G" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
and it works great with Red Hat Enterprise Linux 7.1.</p>

<p>After the device is plugged in the <em>udl</em> kernel module is loaded
and a new framebuffer device is created (/dev/fb1 in my case). Using
<em>mate-display-properties</em> I&#8217;m able to configure the 2nd monitor attached
to the USB video card. I was able to succeffully display an OpenOffice
presentation on the 2nd monitor and play YouTube video.</p>

<p>All USB 2.0 devices from Plugable should be well supported on Linux.
For USB 3.0 David Airlie from Red Hat is doing some reverse engineering
but I have no idea what the status is. For more info see:</p>

<ul>
<li><a href="http://plugable.com/2012/06/21/displaylink-usb-devices-on-linux-kernel-3-4-0">http://plugable.com/2012/06/21/displaylink-usb-devices-on-linux-kernel-3-4-0</a></li>
<li><a href="http://airlied.livejournal.com/80307.html">http://airlied.livejournal.com/80307.html</a></li>
<li><a href="http://airlied.livejournal.com/80516.html">http://airlied.livejournal.com/80516.html</a></li>
<li><a href="http://airlied.livejournal.com/80797.html">http://airlied.livejournal.com/80797.html</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Thunderbolt to Ethernet Adapter on Linux]]></title>
    <link href="http://atodorov.org/blog/2015/05/04/thunderbolt-to-ethernet-adapter-on-linux/"/>
    <updated>2015-05-04T22:27:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/05/04/thunderbolt-to-ethernet-adapter-on-linux</id>
    <content type="html"><![CDATA[<p>As it seems my
<a href="http://www.amazon.com/gp/product/B008ALA6DW/ref=as_li_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=B008ALA6DW&linkCode=as2&tag=atodorovorg-20&linkId=T2J6D7GIDMKNWLYV">Thunderbolt to gigabit Ethernet adapter</a><img src="http://ir-na.amazon-adsystem.com/e/ir?t=atodorovorg-20&l=as2&o=1&a=B008ALA6DW" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
works with
<a href="http://atodorov.org/blog/2015/04/26/installing-red-hat-enterprise-linux-7-on-macbook-air-2015/">RHEL 7 on a MacBook Air</a>
despite some reports it may not.</p>

<p>After plugging the device is automatically recognized and the <em>tg3</em> driver is loaded.
Detailed <em>lspci</em> below:</p>

<pre><code>0a:00.0 Ethernet controller: Broadcom Corporation NetXtreme BCM57762 Gigabit Ethernet PCIe
    Subsystem: Apple Inc. Device 00f6
    Physical Slot: 9
    Flags: bus master, fast devsel, latency 0, IRQ 19
    Memory at cd800000 (64-bit, prefetchable) [size=64K]
    Memory at cd810000 (64-bit, prefetchable) [size=64K]
    [virtual] Expansion ROM at cd820000 [disabled] [size=64K]
    Capabilities: [48] Power Management version 3
    Capabilities: [50] Vital Product Data
    Capabilities: [58] MSI: Enable- Count=1/8 Maskable- 64bit+
    Capabilities: [a0] MSI-X: Enable+ Count=6 Masked-
    Capabilities: [ac] Express Endpoint, MSI 00
    Capabilities: [100] Advanced Error Reporting
    Capabilities: [13c] Device Serial Number 00-00-ac-87-a3-25-20-33
    Capabilities: [150] Power Budgeting &lt;?&gt;
    Capabilities: [160] Virtual Channel
    Capabilities: [1b0] Latency Tolerance Reporting
    Kernel driver in use: tg3
</code></pre>

<p>Unplugging and pluggin back in the network cable works as expected.
I did see my computer freeze 2 out of 10 times when I&#8217;ve unplugged the Thunderbolt
adapter but couldn&#8217;t reproduce it repliably or grab more info.</p>

<p>For the record this is with kernel 3.10.0-229.1.2.el7.x86_64 which is missing
this
<a href="https://git.kernel.org/cgit/linux/kernel/git/gregkh/char-misc.git/commit/?h=char-misc-next&amp;id=16603153666d22df544ae9f9b3764fd18da28eeb">upstream commit</a>.
I&#8217;m not sure why it works though.</p>

<p>If I remember correctly <em>tg3</em> is available during installation so you should
be able to use the Thunderbolt adapter instead of WiFi as well.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Compiling Twinkle SIP Phone on RHEL 7]]></title>
    <link href="http://atodorov.org/blog/2015/05/01/compiling-twinkle-sip-phone-on-rhel-7/"/>
    <updated>2015-05-01T15:04:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/05/01/compiling-twinkle-sip-phone-on-rhel-7</id>
    <content type="html"><![CDATA[<p>One of the best SIP clients for Linux is <a href="http://twinklephone.com/">Twinkle</a>.
However upstream is not active (or even maybe dead) and the package is missing from
latest Fedora releases and fails to build on RHEL 7.</p>

<p>First you need to build and install a few dependencies in the following order:
<a href="http://koji.fedoraproject.org/koji/packageinfo?packageID=8437">ucommon</a>,
<a href="http://koji.fedoraproject.org/koji/packageinfo?packageID=1443">ccrtp</a>,
<a href="http://koji.fedoraproject.org/koji/packageinfo?packageID=6408">libzrtpcpp</a>.
You will also need <a href="https://fedoraproject.org/wiki/EPEL">EPEL 7</a> enabled
to satisfy build dependencies.</p>

<p>Then apply the following patch to the original
<a href="http://koji.fedoraproject.org/koji/buildinfo?buildID=397914">twinkle.spec</a></p>

<pre><code>--- twinkle.spec.orig   2015-05-01 14:07:01.870710147 +0300
+++ twinkle.spec    2015-05-01 15:07:28.734734573 +0300
@@ -47,6 +47,8 @@

 %build
 export LDFLAGS=-lkio 
+export CPPFLAGS="$CPPFLAGS -I/usr/include/libzrtpcpp/" 
+%__autoconf
 %configure
 make %{?_smp_mflags}
</code></pre>

<p>The package now builds, installs and runs successfully on RHEL 7.
The compiled packages and dependencies are available in my
<a href="http://atodorov.org/blog/2015/04/29/rhel-7-repository-for-macbook-air/">Macbook Air RHEL 7 repository</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Fixing Tilde and Function Keys Mapping for MacBook Air on Linux]]></title>
    <link href="http://atodorov.org/blog/2015/04/30/fixing-tilde-and-function-keys-mapping-for-macbook-air-on-linux/"/>
    <updated>2015-04-30T11:33:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/04/30/fixing-tilde-and-function-keys-mapping-for-macbook-air-on-linux</id>
    <content type="html"><![CDATA[<p>Thera are two problems with the MacBook Air keyboard on Linux:</p>

<p>Function keys and media keys are switched and by default you have to
press Fn+F5 in order to refresh a browser page. The
<a href="https://chaidarun.com/fedora-mbp">solution</a> is</p>

<pre><code>echo 2 &gt; /sys/module/hid_apple/parameters/fnmode
</code></pre>

<p>The tilde key is mapped improperly, see
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=1025041#c2">RHBZ #1025041</a>.
To fix it</p>

<pre><code>echo 0 &gt; /sys/module/hid_apple/parameters/iso_layout
</code></pre>

<h2>Permanent fix</h2>

<p>Either you have to add the above commands in a boot script or you can
<code>yum install mba-kbd-fix</code> from my
<a href="http://atodorov.org/blog/2015/04/29/rhel-7-repository-for-macbook-air/">Macbook Air RHEL 7 repository</a>.
The RPM source can be found <a href="https://github.com/atodorov/mba-kbd-fix">here</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[RHEL 7 Repository for MacBook Air]]></title>
    <link href="http://atodorov.org/blog/2015/04/29/rhel-7-repository-for-macbook-air/"/>
    <updated>2015-04-29T13:00:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/04/29/rhel-7-repository-for-macbook-air</id>
    <content type="html"><![CDATA[<p>I&#8217;ve made a repository with binary (x86_64 only) and source RPM packages which
are missing from Red Hat Enterprise Linux 7 and necessary when using a
MacBook Air. To install execute the commands below:</p>

<pre><code>cd /etc/yum.repos.d/
wget https://s3.amazonaws.com/atodorov/rpms/macbook/el7/rhel7-macbook.repo
</code></pre>

<h2>Wireless driver</h2>

<pre><code>yum install kmod-wl
</code></pre>

<h2>Display backlight driver</h2>

<pre><code>yum install kmod-mba6x_bl
</code></pre>

<p>And uncomment <code>/etc/X11/xorg.conf.d/98-mba_bl.conf</code>.</p>

<p><em>Note:</em> the .spec file is available from
<a href="https://github.com/patjak/mba6x_bl/pull/26">RP #26</a>.</p>

<h2>Fixing keyboard mapping</h2>

<pre><code>yum install mba-kbd-fix
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Fixing Display Brightness on MacBook Air with RHEL 7]]></title>
    <link href="http://atodorov.org/blog/2015/04/29/fixing-display-brightness-on-macbook-air-with-rhel-7/"/>
    <updated>2015-04-29T12:14:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/04/29/fixing-display-brightness-on-macbook-air-with-rhel-7</id>
    <content type="html"><![CDATA[<p>One issue with RHEL/CentOS/Fedora on MacBook Air laptops is brightness control
and backlight behavior after suspend/resume. I&#8217;ve found the solution
<a href="http://mattoncloud.org/2014/02/05/fedora-20-on-a-macbook-air/">here</a>
and only tweaked it slightly for my use case.</p>

<h2>mba6x_bl doesn&#8217;t load automatically</h2>

<p>The reason being the driver matches older hardware:</p>

<pre><code>$ modinfo mba6x_bl
filename:       /lib/modules/3.10.0-229.1.2.el7.x86_64/extra/mba6x_bl/mba6x_bl.ko
alias:          dmi:*:pnMacBookAir6*
license:        GPL
description:    MacBook Air 6,1 and 6,2 backlight driver
author:         Patrik Jakobsson &lt;patrik.r.jakobsson@gmail.com&gt;
rhelversion:    7.1
srcversion:     4D069C8EB0E470AF27E7F8D
depends:        video
vermagic:       3.10.0-229.1.2.el7.x86_64 SMP mod_unload modversions 
</code></pre>

<p>My system is <strong>MacBookAir7,2</strong> and doesn&#8217;t match the module alias. So a
<a href="https://github.com/patjak/mba6x_bl/pull/25">quick fix</a> was needed.
For more info about <code>MODULE_ALIAS</code> see
<a href="https://wiki.archlinux.org/index.php/Modalias">ArchWiki</a>.
Alternatively on Red Hat based systems you can place a config file
under <code>/etc/sysconfig/modules</code>, see
<a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Deployment_Guide/sec-Persistent_Module_Loading.html">the docs</a>
for more details.</p>

<h2>intel_backlight driver is in the way</h2>

<p>On older systems mba6x_bl doesn&#8217;t get used automatically. The problem is the offending
intel_backlight driver which gets used instead. To workaround it add this xorg.conf snippet:</p>

<pre><code>$ cat /etc/X11/xorg.conf.d/98-mba_bl.conf
Section "Device"
    Identifier      "Intel Graphics"
    Driver          "intel"
    Option          "Backlight"     "mba6x_backlight"
EndSection
</code></pre>

<p>For more info see <a href="https://bugzilla.redhat.com/show_bug.cgi?id=989555#c19">RHBZ 989555</a>.</p>

<h2>Everything in one go</h2>

<p>If you are using RHEL 7 or CentOS 7 (version 7.1 required) instead of Fedora you can take
a look at my <a href="http://atodorov.org/blog/2015/04/29/rhel-7-repository-for-macbook-air/">Macbook Air RHEL 7 repository</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Enable backspace Key to Navigate Back in Firefox]]></title>
    <link href="http://atodorov.org/blog/2015/04/27/how-to-enable-backspace-key-to-navigate-back-in-firefox/"/>
    <updated>2015-04-27T23:53:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/04/27/how-to-enable-backspace-key-to-navigate-back-in-firefox</id>
    <content type="html"><![CDATA[<p>Open <code>about:config</code> and set <code>browser.backspace_action</code> to 0.
For more information see <a href="http://kb.mozillazine.org/Browser.backspace_action">here</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Disabling MacBook Startup Sound in Linux]]></title>
    <link href="http://atodorov.org/blog/2015/04/27/disabling-macbook-startup-sound-in-linux/"/>
    <updated>2015-04-27T23:23:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/04/27/disabling-macbook-startup-sound-in-linux</id>
    <content type="html"><![CDATA[<p>There is an easy way to disable the MacBook startup sound
(boot chime) even after wiping out OS X and installing Linux.</p>

<p>This sound can be easily disabled if you mute the volume in OS X
and shutdown the computer. The value is stored in NVRAM.</p>

<ol>
<li>Reboot the computer and hold Cmd+Alt(Option)+R. This will start
OS X Internet recovery mode;</li>
<li><p>Open the terminal and issue the following command</p>

<pre><code> nvram SystemAudioVolume=%00
</code></pre></li>
<li><p>Reboot.</p></li>
</ol>


<p>Voila. In Linux try this:</p>

<pre><code># efivar -l | grep SystemAudioVolume
 7c436110-ab2a-4bbb-a880-fe41995c9f82-SystemAudioVolume
 7c436110-ab2a-4bbb-a880-fe41995c9f82-SystemAudioVolumeDB

# efivar -n 7c436110-ab2a-4bbb-a880-fe41995c9f82-SystemAudioVolume -p
GUID: 7c436110-ab2a-4bbb-a880-fe41995c9f82
Name: "SystemAudioVolume"
Attributes:
    Non-Volatile
    Boot Service Access
    Runtime Service Access
Value:
00000000  00                                                |.               |

# efivar -n 7c436110-ab2a-4bbb-a880-fe41995c9f82-SystemAudioVolumeDB -p
GUID: 7c436110-ab2a-4bbb-a880-fe41995c9f82
Name: "SystemAudioVolumeDB"
Attributes:
    Non-Volatile
    Boot Service Access
    Runtime Service Access
Value:
00000000  00 
#
</code></pre>

<p><strong>Note 1</strong>: Before disabling both variables had non zero values. Also <em>SystemAudioVolumeDB</em>
doesn&#8217;t seem to have any effect.</p>

<p><strong>Note 2:</strong> RHEL or CentOS users need to rebuild <em>efivar</em> from the
<a href="https://kojipkgs.fedoraproject.org//packages/efivar/0.14/1.fc22/src/efivar-0.14-1.fc22.src.rpm">Fedora src.rpm</a>.</p>

<p><strong>Note 3:</strong> several Internet sources suggest that writing EFI variables from Linux
may sometimes corrupt your Apple firmware. I didn&#8217;t research this any further. If you
happen to figure out how to successfully write to these variables under Linux please let
everyone know in the comments (in case OS X recovery mode goes missing, you know).</p>

<p>Thanks to my reader Alexander, who
<a href="http://atodorov.org/blog/2015/04/26/installing-red-hat-enterprise-linux-7-on-macbook-air-2015/#disqus_thread">gave me the hint</a>
in a previous blog post.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Compiling Broadcom wl-kmod WiFi Driver for RHEL 7]]></title>
    <link href="http://atodorov.org/blog/2015/04/27/compiling-broadcom-wl-kmod-wifi-driver-for-rhel-7/"/>
    <updated>2015-04-27T12:17:00+03:00</updated>
    <id>http://atodorov.org/blog/2015/04/27/compiling-broadcom-wl-kmod-wifi-driver-for-rhel-7</id>
    <content type="html"><![CDATA[<p>After I got my
<a href="http://atodorov.org/blog/2015/04/26/installing-red-hat-enterprise-linux-7-on-macbook-air-2015/">MacBook Air installed with RHEL 7.1</a>
the first priority was getting wireless working.
First check if your device isn&#8217;t already supported
<a href="http://linuxwireless.org/en/users/Drivers/b43/#Supported_devices">upstream</a>. Mine isn&#8217;t</p>

<pre><code>14e4:43a0: Broadcom Corporation BCM4360 802.11ac Wireless Network Adapter (rev 03)
</code></pre>

<p>Next grab the src.rpm files necessary to build the <em>wl</em> driver from RPM Fusion.
For <code>akmods-0.5.2-1.fc21.src.rpm</code>, <code>broadcom-wl-6.30.223.248-2.fc21.src.rpm</code>,
<code>kmodtool-1-23.fc20.src.rpm</code> just execute <em>rpmbuild &#8211;rebuild</em> against each file
and install <code>kmodtool</code> and <code>akmods</code>.</p>

<p>Then you need two more files <code>buildsys-build-rpmfusion</code> and <code>wl-kmod</code>.
The first one is a helper tool containing list of recent kernels to build against,
the later one is the driver source itself. Both needed minor modifications before
building on RHEL 7.</p>

<p>I&#8217;ve created my own
<a href="https://github.com/atodorov/buildsys-build-rpmfusion-for-rhel7">buildsys-build-rpmfusion</a> package listing the current kernels
for RHEL 7.1. For <a href="https://github.com/atodorov/wl-kmod-for-rhel7">wl-kmod</a> I&#8217;ve introduced a
<a href="https://github.com/atodorov/wl-kmod-for-rhel7/blob/master/wl-kmod-100_redhat.patch">patch</a>
which modifies the other patches in the package so it builds correctly on 7.1.</p>

<p><strong>Note:</strong> I don&#8217;t know if there&#8217;s a define which can be used to detect if we&#8217;re building
on RHEL (maybe I can define my own) but direct kernel version number comparison doesn&#8217;t
work here because Red Hat backports chosen functionality from more recent kernels without
changing the version number. This approach may not be the best one but I&#8217;ve tried to keep it clean
for easier maintenance in the future and it got me started very quickly.</p>

<p>Build the modified buildsys-build-rpmfusion and:</p>

<pre><code>yum install buildsys-build-rpmfusion-7-1.x86_64.rpm buildsys-build-rpmfusion-kerneldevpkgs-current-7-1.x86_64.rpm
</code></pre>

<p>Build the wl-kmod package and:</p>

<pre><code>yum install akmod-wl-6.30.223.248-5.el7.x86_64.rpm broadcom-wl-6.30.223.248-2.el7.noarch.rpm kmod-wl-3.10.0-229.el7.x86_64-6.30.223.248-5.el7.x86_64.rpm kmod-wl-6.30.223.248-5.el7.x86_64.rpm
</code></pre>

<p>If necessary re-create your initramfs image to include <em>wl.ko</em>.</p>
]]></content>
  </entry>
  
</feed>
